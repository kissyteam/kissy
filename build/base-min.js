/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Jul 3 13:48
*/
KISSY.add("base/attribute",function(i,p,f){function k(a,b){return"string"==typeof b?a[b]:b}function n(a,b,c,d,e,g,f,h){f=f||c;return a.fire(b+i.ucfirst(c)+"Change",i.mix({attrName:f,subAttrName:g,prevVal:d,newVal:e},h))}function j(a,b,c){var d=a[b];!c&&!d&&(a[b]=d={});return d||{}}function h(a){return j(a,"__attrs")}function l(a){return j(a,"__attrVals")}function s(a,b){for(var c=0,d=b.length;a!=f&&c<d;c++)a=a[b[c]];return a}function t(a){var b;-1!==a.indexOf(".")&&(b=a.split("."),a=b.shift());return{path:b,
name:a}}function u(a,b,c){var d=c;if(b){var a=d=a===f?{}:i.clone(a),e=b.length-1;if(0<=e){for(var g=0;g<e;g++)a=a[b[g]];a!=f&&(a[b[g]]=c)}}return d}function v(a,b,c,d,e){var g,h,k;g=t(b);var n=b,b=g.name;g=g.path;k=a.get(b);var o=b,l=j(a,"__defaultBeforeFns");l[o]||(l[o]=1,o="before"+i.ucfirst(o)+"Change",a.publish(o,{defaultFn:w}));g&&(h=s(k,g));if(!d.force&&(!g&&k===c||g&&h===c))return f;c=u(k,g,c);c=i.mix({attrName:b,subAttrName:n,prevVal:k,newVal:c,_opts:d,_attrs:e,target:a},d.data);if(d.silent){if(m===
w.call(a,c))return m}else if(m===a.fire("before"+i.ucfirst(b)+"Change",c))return m;return a}function w(a){if(a.target!==this)return f;var b=a.newVal,c=a.prevVal,d=a.attrName,e=a.subAttrName,g=a._attrs,a=a._opts,b=this.setInternal(d,b);if(b===m)return b;a.silent||(b=l(this)[d],n(this,"after",d,c,b,e,null,a.data),g?g.push({prevVal:c,newVal:b,attrName:d,subAttrName:e}):n(this,"","*",[c],[b],[e],[d],a.data));return f}function q(){}function r(a,b){var c=h(a),d=j(c,b,1),e=d.valueFn;if(e&&(e=k(a,e)))e=e.call(a),
e!==f&&(d.value=e),delete d.valueFn,c[b]=d;return d.value}function x(a,b,c,d){var e,g;e=t(b);b=e.name;if(e=e.path)g=a.get(b),c=u(g,e,c);if((e=j(h(a),b).validator)&&(e=k(a,e)))if(a=e.call(a,c,b,d),a!==f&&!0!==a)return a;return f}q.INVALID={};var y=q.INVALID,m=!1;i.augment(q,p.Target,{getAttrs:function(){return h(this)},getAttrVals:function(){var a={},b,c=h(this);for(b in c)a[b]=this.get(b);return a},addAttr:function(a,b,c){var d=h(this),e,b=i.clone(b);(e=d[a])?i.mix(e,b,c):d[a]=b;return this},addAttrs:function(a,
b){var c=this;i.each(a,function(a,b){c.addAttr(b,a)});b&&c.set(b);return c},hasAttr:function(a){return h(this).hasOwnProperty(a)},removeAttr:function(a){this.hasAttr(a)&&(delete h(this)[a],delete l(this)[a]);return this},set:function(a,b,c){if(i.isPlainObject(a)){var c=b||{},b=Object(a),d=[],e,g=[];for(a in b)(e=x(this,a,b[a],b))!==f&&g.push(e);if(g.length)return c.error&&c.error(g),m;for(a in b)v(this,a,b[a],c,d);var h=[],k=[],j=[],l=[];i.each(d,function(a){k.push(a.prevVal);j.push(a.newVal);h.push(a.attrName);
l.push(a.subAttrName)});h.length&&n(this,"","*",k,j,l,h,c.data);return this}c=c||{};e=x(this,a,b);return e!==f?(c.error&&c.error(e),m):v(this,a,b,c)},setInternal:function(a,b){var c=f,d=j(h(this),a).setter;if(d&&(d=k(this,d)))c=d.call(this,b,a);if(c===y)return m;c!==f&&(b=c);l(this)[a]=b;return f},get:function(a){var b,c=l(this),d,e;-1!==a.indexOf(".")&&(b=a.split("."),a=b.shift());d=j(h(this),a,1).getter;e=a in c?c[a]:r(this,a);if(d&&(d=k(this,d)))e=d.call(this,e,a);!(a in c)&&e!==f&&(c[a]=e);b&&
(e=s(e,b));return e},reset:function(a,b){if("string"==typeof a)return this.hasAttr(a)?this.set(a,r(this,a),b):this;var b=a,c=h(this),d={};for(a in c)d[a]=r(this,a);this.set(d,b);return this}});return q},{requires:["event/custom"]});
KISSY.add("base",function(i,p){function f(f){var i=this.constructor;for(this.userConfig=f;i;){var j=i.ATTRS;if(j){var h=void 0;for(h in j)this.addAttr(h,j[h],!1)}i=i.superclass?i.superclass.constructor:null}if(f)for(var l in f)this.setInternal(l,f[l])}i.augment(f,p);f.Attribute=p;return i.Base=f},{requires:["base/attribute","event/custom"]});
