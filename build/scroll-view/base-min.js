/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Jul 3 13:57
*/
KISSY.add("scroll-view/base/render",function(f,i,n,o){var f=f.Features,j=i.all,m,i={syncUI:function(){var d=this.control,e=d.el,a=d.contentEl,c=d.$contentEl,b=a.scrollHeight,k=a.scrollWidth,a=e.clientHeight,g,l=e.clientWidth;d.scrollHeight=b;d.scrollWidth=k;d.clientHeight=a;d.clientWidth=l;var h=c.offset();g=d.allowScroll={};b>a&&(g.top=1);k>l&&(g.left=1);d.minScroll={left:0,top:0};var p,f;d.maxScroll={left:p=k-l,top:f=b-a};e=j(e.ownerDocument);d.scrollStep={top:Math.max(0.7*a*a/e.height(),20),left:Math.max(0.7*
l*l/e.width(),20)};a=d.get("snap");e=d.get("scrollLeft");b=d.get("scrollTop");if(a){var c=d.pages="string"==typeof a?c.all(a):c.children(),a=d.get("pageIndex"),i=d.pagesXY=[];c.each(function(a,b){var c=a.offset(),d=c.left-h.left,c=c.top-h.top;d<=p&&c<=f&&(i[b]={x:d,y:c,index:b})});if(a){d.scrollToPage(a);return}}d.scrollToWithBounds({left:e,top:b})},_onSetScrollLeft:function(d){this.control.get("contentEl")[0].style.left=-d+"px"},_onSetScrollTop:function(d){this.control.get("contentEl")[0].style.top=
-d+"px"}};f.isTransformSupported()&&(m=f.getTransformProperty(),i._onSetScrollLeft=function(d){var e=this.control;e.contentEl.style[m]="translate3d("+-d+"px,"+-e.get("scrollTop")+"px,0)"},i._onSetScrollTop=function(d){var e=this.control;e.contentEl.style[m]="translate3d("+-e.get("scrollLeft")+"px,"+-d+"px,0)"});return n.ATTRS.xrender.value.extend([o],i,{name:"ScrollViewRender"})},{requires:["node","component/container","component/extension/content-render"]});
KISSY.add("scroll-view/base",function(f,i,n,o,j){function m(){var a=this.el,c=a.scrollTop,b=a.scrollLeft;c&&this.set("scrollTop",c+this.get("scrollTop"));b&&this.set("scrollLeft",b+this.get("scrollLeft"));a.scrollTop=a.scrollLeft=0}var d=f.all,f=f.Features.isTouchEventSupported(),e=i.KeyCode;return n.extend({bindUI:function(){this.$el.on("mousewheel",this.handleMouseWheel,this).on("scroll",m,this)},handleKeyDownInternal:function(a){var c=d(a.target),b=c.nodeName();if("input"==b||"textarea"==b||"select"==
b||c.hasAttr("contenteditable"))return j;var a=a.keyCode,b=this.scrollStep,c=j,k=this.isAxisEnabled("x");if(this.isAxisEnabled("y")){var g=b.top,l=this.clientHeight,h=this.get("scrollTop");a==e.DOWN?(this.scrollToWithBounds({top:h+g}),c=!0):a==e.UP?(this.scrollToWithBounds({top:h-g}),c=!0):a==e.PAGE_DOWN?(this.scrollToWithBounds({top:h+l}),c=!0):a==e.PAGE_UP&&(this.scrollToWithBounds({top:h-l}),c=!0)}k&&(b=b.left,k=this.get("scrollLeft"),a==e.RIGHT?(this.scrollToWithBounds({left:k+b}),c=!0):a==e.LEFT&&
(this.scrollToWithBounds({left:k-b}),c=!0));return c},handleMouseWheel:function(a){if(!this.get("disabled")){var c,b,d=this.scrollStep,g,e=this.maxScroll,h=this.minScroll;if((g=a.deltaY)&&this.isAxisEnabled("y")){var f=this.get("scrollTop");c=e.top;b=h.top;f<=b&&0<g||f>=c&&0>g||(this.scrollToWithBounds({top:f-a.deltaY*d.top}),a.preventDefault())}if((g=a.deltaX)&&this.isAxisEnabled("x"))f=this.get("scrollLeft"),c=e.left,b=h.left,f<=b&&0<g||f>=c&&0>g||(this.scrollToWithBounds({left:f-a.deltaX*d.left}),
a.preventDefault())}},isAxisEnabled:function(a){return this.allowScroll["x"==a?"left":"top"]},stopAnimation:function(){this.$contentEl.stop();this.scrollToWithBounds({left:this.get("scrollLeft"),top:this.get("scrollTop")})},_uiSetPageIndex:function(a){this.scrollToPage(a)},_getPageIndexFromXY:function(a,c,b){var d=this.pagesXY.concat([]),e=c?"x":"y";d.sort(function(a,b){return a[e]-b[e]});if(0<b)for(c=0;c<d.length;c++){if(b=d[c],b[e]>=a)return b.index}else for(c=d.length-1;0<=c;c--)if(b=d[c],b[e]<=
a)return b.index;return j},scrollToPage:function(a,c){var b;if((b=this.pagesXY)&&b[a])this.setInternal("pageIndex",a),this.scrollTo({left:b[a].x,top:b[a].y},c)},scrollToWithBounds:function(a,c){var b=this.maxScroll,d=this.minScroll;a.left&&(a.left=Math.min(Math.max(a.left,d.left),b.left));a.top&&(a.top=Math.min(Math.max(a.top,d.top),b.top));this.scrollTo(a,c)},scrollTo:function(a,c){var b=this,d=a.left,e=a.top;if(c){var f=b.get("scrollLeft"),h=b.get("scrollTop");b.get("contentEl").animate({xx:{fx:{frame:function(a,
c){d!==j&&b.set("scrollLeft",f+c.pos*(d-f));e!==j&&b.set("scrollTop",h+c.pos*(e-h))}}}},c)}else d!==j&&b.set("scrollLeft",d),e!==j&&b.set("scrollTop",e)}},{ATTRS:{contentEl:{},scrollLeft:{view:1,value:0},scrollTop:{view:1,value:0},focusable:{value:!f},allowTextSelection:{value:!0},handleMouseEvents:{value:!1},snap:{value:!1},snapDuration:{value:0.3},snapEasing:{value:"easeOut"},pageIndex:{value:0},xrender:{value:o}},xclass:"scroll-view"})},{requires:["node","component/container","./base/render"]});
