/*
Copyright 2012, KISSY UI Library v1.30dev
MIT Licensed
build time: May 29 14:44
*/
KISSY.add("editor/plugin/fakeObjects/index",function(c,i){var l=c.Node,m=c.DOM,n=i.Utils.debugUrl("theme/spacer.gif"),k=c.require("htmlparser");c.augment(i,{createFakeElement:function(a,b,d,o,j,f){var e=a.attr("style")||"";a.attr("width")&&(e="width:"+a.attr("width")+"px;"+e);a.attr("height")&&(e="height:"+a.attr("height")+"px;"+e);var g=c.trim(a.attr("class")),a={"class":b+" "+g,src:n,_ke_realelement:encodeURIComponent(j||a._4e_outerHtml(void 0)),_ke_real_node_type:a[0].nodeType,style:e};f&&delete f.width;
f&&delete f.height;f&&c.mix(a,f,!1);d&&(a._ke_real_element_type=d);o&&(a._ke_resizable=o);return new l("<img/>",a,this.get("document")[0])},restoreRealElement:function(a){if(a.attr("_ke_real_node_type")!=m.ELEMENT_NODE)return null;var a=decodeURIComponent(a.attr("_ke_realelement")),b=new l("<div>",null,this.get("document")[0]);b.html(a);return b.first(function(a){return a.nodeType==m.ELEMENT_NODE}).remove()}});var p={tags:{$:function(a){var b=a.getAttribute("_ke_realelement"),d;b&&(d=(new k.Parser(decodeURIComponent(b))).parse());
if(b=d&&d.childNodes[0]){if(d=a.getAttribute("style")){var c=/(?:^|\s)width\s*:\s*(\d+)/i.exec(d),a=c&&c[1];d=(c=/(?:^|\s)height\s*:\s*(\d+)/i.exec(d))&&c[1];a&&b.setAttribute("width",a);d&&b.setAttribute("height",d)}return b}}}};return{init:function(a){var b=(a=a.htmlDataProcessor)&&a.htmlFilter;a.createFakeParserElement||(b&&b.addRules(p),c.mix(a,{createFakeParserElement:function(a,b,j,f,e){var g;g=new k.BasicWriter;a.writeHtml(g);g=g.getHtml();var h=a.getAttribute("style")||"";a.getAttribute("width")&&
(h="width:"+a.getAttribute("width")+"px;"+h);a.getAttribute("height")&&(h="height:"+a.getAttribute("height")+"px;"+h);var i=c.trim(a.getAttribute("class")),a={"class":b+" "+i,src:n,_ke_realelement:encodeURIComponent(g),_ke_real_node_type:a.nodeType+"",style:h,align:a.getAttribute("align")||""};e&&delete e.width;e&&delete e.height;e&&c.mix(a,e,!1);j&&(a._ke_real_element_type=j);f&&(a._ke_resizable="_ke_resizable");return new k.Tag("img",a)}}))}}},{requires:["editor"]});
