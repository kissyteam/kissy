/*
Copyright 2013, KISSY v1.40dev
MIT Licensed
build time: Sep 16 15:10
*/
KISSY.add("editor/plugin/flash-common/base-class",function(h,k,d,n,o,e,l){var m=h.Node;return d.extend({initializer:function(){var a=this,c=a.get("cls"),b=a.get("editor"),i=b.get("prefixCls"),j=[],d=a.get("bubbleId"),e=a.get("contextMenuId"),f=a.get("contextMenuHandlers");h.each(f,function(a,b){j.push({content:b})});b.addContextMenu(e,"."+c,{width:"120px",children:j,listeners:{click:function(a){a=a.target.get("content");f[a]&&f[a].call(this)}}});b.addBubble(d,function(a){return a.hasClass(c,void 0)&&
a},{listeners:{afterRenderUI:function(){var c=this,g=c.get("contentEl");g.html(h.substitute(' <a class="{prefixCls}editor-bubble-url" target="_blank" href="#">{label}</a>   |    <span class="{prefixCls}editor-bubble-link {prefixCls}editor-bubble-change">\u7f16\u8f91</span>   |    <span class="{prefixCls}editor-bubble-link {prefixCls}editor-bubble-remove">\u5220\u9664</span>',{label:a.get("label"),prefixCls:i}));var d=g.one("."+i+"editor-bubble-url"),e=g.one("."+i+"editor-bubble-change"),f=g.one("."+i+"editor-bubble-remove");
k.Utils.preventFocus(g);e.on("click",function(b){a.show(c.get("editorSelectedEl"));b.halt()});f.on("click",function(a){if(h.UA.webkit){var d=b.getSelection().getRanges();if(d=d&&d[0])d.collapse(!0),d.select()}c.get("editorSelectedEl").remove();c.hide();b.notifySelectionChange();a.halt()});c.on("show",function(){var b=c.get("editorSelectedEl");b&&a._updateTip(d,b)})}}});b.docReady(function(){b.get("document").on("dblclick",a._dbClick,a)})},_getFlashUrl:function(a){return l.getUrl(a)},_updateTip:function(a,
c){var b=this.get("editor").restoreRealElement(c);b&&(b=this._getFlashUrl(b),a.attr("href",b))},_dbClick:function(a){var c=new m(a.target);"img"===c.nodeName()&&c.hasClass(this.get("cls"),void 0)&&(this.show(c),a.halt())},show:function(a){var c=this.get("editor");e.useDialog(c,this.get("type"),this.get("pluginConfig"),a)}},{ATTRS:{cls:{},type:{},label:{value:"\u5728\u65b0\u7a97\u53e3\u67e5\u770b"},bubbleId:{},contextMenuId:{},contextMenuHandlers:{}}})},{requires:"editor,base,../contextmenu,../bubble,../dialog-loader,./utils".split(",")});
