/*
Copyright 2010, KISSY UI Library v1.0.5
MIT Licensed
build: 564 Apr 15 09:57
*/
KISSY.add("switchable",function(c,i){function o(a,b){b=b||{};if(!("markupType"in b))if(b.panelCls)b.markupType=1;else if(b.panels)b.markupType=2;b=c.merge(o.Config,b);this.container=c.get(a);this.config=b;this.triggers=this.triggers||[];this.panels=this.panels||[];if(this.activeIndex===i)this.activeIndex=b.activeIndex;this._init()}var g=c.DOM,k=c.Event,r=document,m=o.prototype;o.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",panelCls:"ks-switchable-panel",
triggers:[],panels:[],hasTriggers:true,triggerType:"mouse",delay:0.1,activeIndex:0,activeTriggerCls:"active",steps:1,viewSize:[]};o.Plugins=[];c.mix(m,{_init:function(){var a=this,b=a.config;a.panels.length===0&&a._parseMarkup();b.hasTriggers&&a._bindTriggers();c.each(o.Plugins,function(e){e.init&&e.init(a)})},_parseMarkup:function(){var a=this.container,b=this.config,e=b.hasTriggers,d,f=[],l=[];switch(b.markupType){case 0:if(d=c.get("."+b.navCls,a))f=g.children(d);d=c.get("."+b.contentCls,a);l=g.children(d);
break;case 1:f=c.query("."+b.triggerCls,a);l=c.query("."+b.panelCls,a);break;case 2:f=b.triggers;l=b.panels;break}a=l.length;this.length=a/b.steps;if(e&&a>0&&f.length===0)f=this._generateTriggersMarkup(this.length);this.triggers=c.makeArray(f);this.panels=c.makeArray(l);this.content=d||l[0].parentNode},_generateTriggersMarkup:function(a){var b=this.config,e=r.createElement("UL"),d,f;e.className=b.navCls;for(f=0;f<a;f++){d=r.createElement("LI");if(f===this.activeIndex)d.className=b.activeTriggerCls;
d.innerHTML=f+1;e.appendChild(d)}this.container.appendChild(e);return g.children(e)},_bindTriggers:function(){var a=this,b=a.config,e=a.triggers,d,f,l=e.length;for(f=0;f<l;f++)(function(h){d=e[h];k.on(d,"click focus",function(){a._onFocusTrigger(h)});if(b.triggerType==="mouse"){k.on(d,"mouseenter",function(){a._onMouseEnterTrigger(h)});k.on(d,"mouseleave",function(){a._onMouseLeaveTrigger(h)})}})(f)},_onFocusTrigger:function(a){if(this.activeIndex!==a){this.switchTimer&&this.switchTimer.cancel();
this.switchTo(a)}},_onMouseEnterTrigger:function(a){var b=this;if(b.activeIndex!==a)b.switchTimer=c.later(function(){b.switchTo(a)},b.config.delay*1E3)},_onMouseLeaveTrigger:function(){this.switchTimer&&this.switchTimer.cancel()},switchTo:function(a,b){var e=this.config,d=this.triggers,f=this.panels,l=this.activeIndex,h=e.steps,n=l*h,p=a*h;if(a===l)return this;if(this.fire("beforeSwitch",{toIndex:a})===false)return this;if(e.hasTriggers)this._switchTrigger(l>-1?d[l]:null,d[a]);if(b===i)b=a>l?"forward":
"forward";this._switchView(f.slice(n,n+h),f.slice(p,p+h),a,b);this.activeIndex=a;return this},_switchTrigger:function(a,b){var e=this.config.activeTriggerCls;a&&g.removeClass(a,e);g.addClass(b,e)},_switchView:function(a,b){g.css(a,"display","none");g.css(b,"display","block");this.fire("switch")},prev:function(){var a=this.activeIndex;this.switchTo(a>0?a-1:this.length-1,"backward")},next:function(){var a=this.activeIndex;this.switchTo(a<this.length-1?a+1:0,"forward")}});c.mix(m,c.EventTarget);c.Switchable=
o});
KISSY.add("switchable-autoplay",function(c){var i=c.Event,o=c.Switchable;c.mix(o.Config,{autoplay:false,interval:5,pauseOnHover:true});o.Plugins.push({name:"autoplay",init:function(g){var k=g.config;if(k.autoplay){if(k.pauseOnHover){i.on(g.container,"mouseenter",function(){g.paused=true});i.on(g.container,"mouseleave",function(){setTimeout(function(){g.paused=false},k.interval*1E3)})}g.autoplayTimer=c.later(function(){g.paused||g.switchTo(g.activeIndex<g.length-1?g.activeIndex+1:0)},k.interval*1E3,
true)}}})});
KISSY.add("switchable-effect",function(c){var i=YAHOO.util,o=c.DOM,g=i.Dom,k=c.Switchable,r;c.mix(k.Config,{effect:"none",duration:0.5,easing:i.Easing.easeNone});k.Effects={none:function(m,a,b){o.css(m,"display","none");o.css(a,"display","block");b()},fade:function(m,a,b){m.length!==1&&c.error("fade effect only supports steps == 1.");var e=this,d=e.config,f=m[0],l=a[0];e.anim&&e.anim.stop();g.setStyle(l,"opacity",1);e.anim=new i.Anim(f,{opacity:{to:0}},d.duration,d.easing);e.anim.onComplete.subscribe(function(){e.anim=null;
g.setStyle(l,"z-index",9);g.setStyle(f,"z-index",1);b()});e.anim.animate()},scroll:function(m,a,b,e){var d=this;m=d.config;a=m.effect==="scrollx";var f={};f[a?"left":"top"]={to:-(d.viewSize[a?0:1]*e)};d.anim&&d.anim.stop();d.anim=new i.Anim(d.content,f,m.duration,m.easing);d.anim.onComplete.subscribe(function(){d.anim=null;b()});d.anim.animate()}};r=k.Effects;r.scrollx=r.scrolly=r.scroll;k.Plugins.push({name:"effect",init:function(m){var a=m.config,b=a.effect,e=m.panels,d=a.steps,f=m.activeIndex*
d,l=f+d-1,h=e.length;m.viewSize=[a.viewSize[0]||e[0].offsetWidth*d,a.viewSize[0]||e[0].offsetHeight*d];if(b!=="none"){for(a=0;a<h;a++)e[a].style.display="block";switch(b){case "scrollx":case "scrolly":m.content.style.position="absolute";m.content.parentNode.style.position="relative";if(b==="scrollx"){g.setStyle(e,"float","left");m.content.style.width=m.viewSize[0]*(h/d)+"px"}break;case "fade":for(a=0;a<h;a++){g.setStyle(e[a],"opacity",a>=f&&a<=l?1:0);e[a].style.position="absolute";e[a].style.zIndex=
a>=f&&a<=l?9:1}break}}}});c.mix(k.prototype,{_switchView:function(m,a,b,e){var d=this,f=d.config.effect;(c.isFunction(f)?f:r[f]).call(d,m,a,function(){d.fire("switch")},b,e)}})});
KISSY.add("switchable-circular",function(c){function i(h,n,p,q,t){var j=this;h=j.config;n=j.length;var u=j.activeIndex,s=h.scrollType===f,v=s?r:m,w=j.viewSize[s?0:1];s=-w*q;var y={},z,x=t===d;if(z=x&&u===0&&q===n-1||t===e&&u===n-1&&q===0)s=o.call(j,j.panels,q,x,v,w);y[v]={to:s};j.anim&&j.anim.stop();j.anim=new YAHOO.util.Anim(j.content,y,h.duration,h.easing);j.anim.onComplete.subscribe(function(){z&&g.call(j,j.panels,q,x,v,w);j.anim=null;p()});j.anim.animate()}function o(h,n,p,q,t){var j=this.config.steps;
n=this.length;var u=p?n-1:0,s=(u+1)*j;for(j=u*j;j<s;j++){h[j].style.position=k;h[j].style[q]=(p?"-":b)+t*n+a}return p?t:-t*n}function g(h,n,p,q,t){var j=this.config.steps;n=this.length;var u=p?n-1:0,s=(u+1)*j;for(j=u*j;j<s;j++){h[j].style.position=b;h[j].style[q]=b}this.content.style[q]=p?-t*(n-1)+a:b}var k="relative",r="left",m="top",a="px",b="",e="forward",d="backward",f="scrollx",l=c.Switchable;c.mix(l.Config,{circular:false});l.Plugins.push({name:"circular",init:function(h){h=h.config;if(h.circular&&
(h.effect===f||h.effect==="scrolly")){h.scrollType=h.effect;h.effect=i}}})});
KISSY.add("switchable-lazyload",function(c){var i=c.DOM,o="beforeSwitch",g="img-src",k="textarea-data",r={},m=c.Switchable,a=c.DataLazyload;r[g]="data-lazyload-src-custom";r[k]="ks-datalazyload-custom";c.mix(m.Config,{lazyDataType:"",lazyDataFlag:""});m.Plugins.push({name:"autoplay",init:function(b){function e(n){var p=f.steps;n=n.toIndex*p;a.loadCustomLazyData(b.panels.slice(n,n+p),l,h);d()&&b.detach(o,e)}function d(){var n,p,q;if(l===g){n=c.query("img",b.container);p=0;for(q=n.length;p<q;p++)if(i.attr(n[p],
h))return false}else if(l===k){n=c.query("textarea",b.container);p=0;for(q=n.length;p<q;p++)if(i.hasClass(n[p],h))return false}return true}var f=b.config,l=f.lazyDataType,h=f.lazyDataFlag||r[l];!a||!l||!h||b.on(o,e)}})});KISSY.add("tabs",function(c){function i(o,g){if(!(this instanceof i))return new i(o,g);i.superclass.constructor.call(this,o,g)}c.extend(i,c.Switchable);c.Tabs=i});
KISSY.add("slide",function(c){function i(g,k){if(!(this instanceof i))return new i(g,k);k=c.merge(o,k||{});i.superclass.constructor.call(this,g,k)}var o={autoplay:true,circular:true};c.extend(i,c.Switchable);c.Slide=i});KISSY.add("carousel",function(c){function i(g,k){if(!(this instanceof i))return new i(g,k);k=c.merge(o,k||{});i.superclass.constructor.call(this,g,k)}var o={circular:true};c.extend(i,c.Switchable);c.Carousel=i});
