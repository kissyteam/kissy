/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Aug 14 18:44
*/
KISSY.add("event/dom/base/utils",function(e,g){var a="ksEventTargetId_"+e.now(),b=e.Env.host.document;return{simpleAdd:b&&b.addEventListener?function(a,b,g,e){a.addEventListener&&a.addEventListener(b,g,!!e)}:function(a,b,g){a.attachEvent&&a.attachEvent("on"+b,g)},simpleRemove:b&&b.removeEventListener?function(a,b,g,e){a.removeEventListener&&a.removeEventListener(b,g,!!e)}:function(a,b,g){a.detachEvent&&a.detachEvent("on"+b,g)},data:function(b,e){return g.data(b,a,e)},removeData:function(b){return g.removeData(b,
a)}}},{requires:["dom"]});KISSY.add("event/dom/base/special",function(){return{}});
KISSY.add("event/dom/base/observer",function(e,g,a){function b(a){b.superclass.constructor.apply(this,arguments)}e.extend(b,a.Observer,{keys:"fn,filter,data,context,originalType,groups,last".split(","),notifyInternal:function(a,b){var e,k,p=a.type,m;(m=this.originalType)?a.type=m:m=p;(e=g[m])&&e.handle?(e=e.handle(a,this,b))&&0<e.length&&(k=e[0]):k=this.simpleNotify(a,b);a.type=p;return k}});return b},{requires:["./special","event/base"]});
KISSY.add("event/dom/base/object",function(e,g,a){function b(){return k}function q(){return p}function l(c){var j=c.type;l.superclass.constructor.call(this);this.originalEvent=c;this.isDefaultPrevented=c.defaultPrevented||c.returnValue===p||c.getPreventDefault&&c.getPreventDefault()?b:q;var f=[],d,h,i=m.concat();e.each(n,function(c){j.match(c.reg)&&(i=i.concat(c.props),c.fix&&f.push(c.fix));return a});for(h=i.length;h;)d=i[--h],this[d]=c[d];this.target||(this.target=c.srcElement||s);3===this.target.nodeType&&
(this.target=this.target.parentNode);for(h=f.length;h;)d=f[--h],d(this,c)}var s=e.Env.host.document,k=!0,p=!1,m="altKey,bubbles,cancelable,ctrlKey,currentTarget,eventPhase,metaKey,shiftKey,target,timeStamp,view,type".split(","),n=[{reg:/^key/,props:["char","charCode","key","keyCode","which"],fix:function(c,j){null==c.which&&(c.which=null!=j.charCode?j.charCode:j.keyCode);c.metaKey===a&&(c.metaKey=c.ctrlKey)}},{reg:/^touch/,props:["touches","changedTouches","targetTouches"]},{reg:/^gesturechange$/i,
props:["rotation","scale"]},{reg:/^(mousewheel|DOMMouseScroll)$/,props:[],fix:function(c,j){var f,d,m,i=j.wheelDelta,b=j.axis,n=j.wheelDeltaY,e=j.wheelDeltaX,o=j.detail;i&&(m=i/120);o&&(m=-(0==o%3?o/3:o));b!==a&&(b===c.HORIZONTAL_AXIS?(d=0,f=-1*m):b===c.VERTICAL_AXIS&&(f=0,d=m));n!==a&&(d=n/120);e!==a&&(f=-1*e/120);!f&&!d&&(d=m);f!==a&&(c.deltaX=f);d!==a&&(c.deltaY=d);m!==a&&(c.delta=m)}},{reg:/^mouse|contextmenu|click|mspointer|(^DOMMouseScroll$)/i,props:"buttons,clientX,clientY,button,offsetX,relatedTarget,which,fromElement,toElement,offsetY,pageX,pageY,screenX,screenY".split(","),
fix:function(c,m){var f,d,b=c.target,i=m.button;null==c.pageX&&null!=m.clientX&&(f=b.ownerDocument||s,d=f.documentElement,f=f.body,c.pageX=m.clientX+(d&&d.scrollLeft||f&&f.scrollLeft||0)-(d&&d.clientLeft||f&&f.clientLeft||0),c.pageY=m.clientY+(d&&d.scrollTop||f&&f.scrollTop||0)-(d&&d.clientTop||f&&f.clientTop||0));!c.which&&i!==a&&(c.which=i&1?1:i&2?3:i&4?2:0);!c.relatedTarget&&c.fromElement&&(c.relatedTarget=c.fromElement===b?c.toElement:c.fromElement);return c}}];e.extend(l,g.Object,{constructor:l,
preventDefault:function(){var a=this.originalEvent;a.preventDefault?a.preventDefault():a.returnValue=p;l.superclass.preventDefault.call(this)},stopPropagation:function(){var a=this.originalEvent;a.stopPropagation?a.stopPropagation():a.cancelBubble=k;l.superclass.stopPropagation.call(this)}});return l},{requires:["event/base"]});
KISSY.add("event/dom/base/observable",function(e,g,a,b,q,l,s){function k(a){e.mix(this,a);this.reset()}var p=s.Utils;e.extend(k,s.Observable,{setup:function(){var m=this.type,n=a[m]||{},c=this.currentTarget,j=b.data(c).handle;(!n.setup||!1===n.setup.call(c,m))&&b.simpleAdd(c,m,j)},constructor:k,reset:function(){k.superclass.reset.call(this);this.lastCount=this.delegateCount=0},notify:function(a){var b=a.target,c=a.type,j=this.currentTarget,f=this.observers,d=[],h,i,e=this.delegateCount||0,r,t;if(e&&
b.nodeType)for(;b!=j;){if(!0!==b.disabled||"click"!==c){var o={},l,k,q;r=[];for(i=0;i<e;i++)t=f[i],q=t.filter,k=q+"",l=o[k],void 0===l&&(l=o[k]=g.test(b,q)),l&&r.push(t);r.length&&d.push({currentTarget:b,currentTargetObservers:r})}b=b.parentNode||j}e<f.length&&d.push({currentTarget:j,currentTargetObservers:f.slice(e)});i=0;for(b=d.length;!a.isPropagationStopped()&&i<b;++i){c=d[i];r=c.currentTargetObservers;c=c.currentTarget;a.currentTarget=c;for(c=0;!a.isImmediatePropagationStopped()&&c<r.length;c++)j=
r[c],j=j.notify(a,this),!1!==h&&(h=j)}return h},fire:function(b,n){var b=b||{},c=""+this.type,j,f,d=a[c]||{};j=!1!==d.bubbles;var h=this.currentTarget;if(!(d.fire&&!1===d.fire.call(h,n))&&(b instanceof l||(f=b,b=new l({currentTarget:h,type:c,target:h}),e.mix(b,f)),!(d.preFire&&!1===d.preFire.call(h,b,n)))){f=h;var i=g.getWindow(f),u=i.document,d=[],r="on"+c,t=0;do d.push(f),f=f.parentNode||f.ownerDocument||f===u&&i;while(!n&&f&&j);f=d[t];do b.currentTarget=f,(j=k.getDomEventObservable(f,c))&&j.notify(b),
f[r]&&!1===f[r].call(f)&&b.preventDefault(),f=d[++t];while(!n&&f&&!b.isPropagationStopped());if(!n&&!b.isDefaultPrevented()){try{h[c]&&!e.isWindow(h)&&(k.triggeredEvent=c,h[c]())}catch(o){}k.triggeredEvent=""}}},on:function(b){var e=this.observers,c=a[this.type]||{},b=b instanceof q?b:new q(b);-1==this.findObserver(b)&&(b.filter?(e.splice(this.delegateCount,0,b),this.delegateCount++):b.last?(e.push(b),this.lastCount++):e.splice(e.length-this.lastCount,0,b),c.add&&c.add.call(this.currentTarget,b))},
detach:function(b){var e,c=a[this.type]||{},j="filter"in b,f=b.filter,d=b.context,h=b.fn,i=this.currentTarget,g=this.observers,b=b.groups;if(g.length){b&&(e=p.getGroupsRe(b));var r,t,o,l,k=g.length;if(h||j||e){d=d||i;r=b=0;for(t=[];b<k;++b)o=g[b],l=o.context||i,d!=l||h&&h!=o.fn||j&&(f&&f!=o.filter||!f&&!o.filter)||e&&!o.groups.match(e)?t[r++]=o:(o.filter&&this.delegateCount&&this.delegateCount--,o.last&&this.lastCount&&this.lastCount--,c.remove&&c.remove.call(i,o));this.observers=t}else this.reset();
this.checkMemory()}},checkMemory:function(){var g=this.type,l,c,j=a[g]||{},f=this.currentTarget,d=b.data(f);if(d&&(l=d.observables,this.hasObserver()||(c=d.handle,(!j.tearDown||!1===j.tearDown.call(f,g))&&b.simpleRemove(f,g,c),delete l[g]),e.isEmptyObject(l)))d.handle=null,b.removeData(f)}});k.triggeredEvent="";k.getDomEventObservable=function(a,e){var c=b.data(a),j;c&&(j=c.observables);return j?j[e]:null};k.getDomEventObservablesHolder=function(a,e){var c=b.data(a);!c&&e&&b.data(a,c={});return c};
return k},{requires:"dom,./special,./utils,./observer,./object,event/base".split(",")});
KISSY.add("event/dom/base/dom-event",function(e,g,a,b,q,l,s){function k(a,b){var c=q[b]||{},e;if(!a.originalType&&(e=c.typeFix))a.originalType=b,b=e;return b}function p(a,b,c){var h,i,g,c=e.merge(c),b=k(c,b);h=l.getDomEventObservablesHolder(a,1);if(!(g=h.handle))g=h.handle=function(a){var b=a.type,c=g.currentTarget;if(!(l.triggeredEvent==b||"undefined"==typeof KISSY))if(b=l.getDomEventObservable(c,b))return a.currentTarget=c,a=new s(a),b.notify(a)},g.currentTarget=a;if(!(i=h.observables))i=h.observables=
{};h=i[b];h||(h=i[b]=new l({type:b,currentTarget:a}),h.setup());h.on(c);a=null}function m(a,b,c){var c=e.merge(c),b=k(c,b),a=l.getDomEventObservablesHolder(a),h=(a||{}).observables;if(a&&h)if(b)(b=h[b])&&b.detach(c);else for(b in h)h[b].detach(c)}var n=g.Utils,c={};e.mix(c,{on:function(a,c,d,e){a=b.query(a);n.batchForType(function(a,b,c,f){for(var c=n.normalizeParam(b,c,f),d,b=c.type,f=a.length-1;0<=f;f--)d=a[f],p(d,b,c)},1,a,c,d,e);return a},detach:function(a,c,d,e){a=b.query(a);n.batchForType(function(a,
b,c,f){for(var c=n.normalizeParam(b,c,f),d,e,b=c.type,f=a.length-1;0<=f;f--)if(d=a[f],m(d,b,c),c.deep&&d.getElementsByTagName){e=d.getElementsByTagName("*");for(d=e.length-1;0<=d;d--)m(e[d],b,c)}},1,a,c,d,e);return a},delegate:function(a,b,d,e,i){return c.on(a,b,{fn:e,context:i,filter:d})},undelegate:function(a,b,d,e,i){return c.detach(a,b,{fn:e,context:i,filter:d})},fire:function(a,c,d,e){var i=void 0,d=d||{};d.synthetic=1;n.splitAndRun(c,function(c){var f,g,k;n.fillGroupsForEvent(c,d);c=d.type;
if((g=q[c])&&g.typeFix)c=g.typeFix;a=b.query(a);for(g=a.length-1;0<=g;g--)f=a[g],k=l.getDomEventObservable(f,c),!e&&!k&&(k=new l({type:c,currentTarget:f})),k&&(f=k.fire(d,e),!1!==i&&(i=f))});return i},fireHandler:function(a,b,d){return c.fire(a,b,d,1)},clone:function(b,c){var d;if(d=l.getDomEventObservablesHolder(b)){var g=a.data(b);g&&g===a.data(c)&&a.removeData(c);e.each(d.observables,function(a,b){e.each(a.observers,function(a){p(c,b,a)})})}}});return c},{requires:"event/base,./utils,dom,./special,./observable,./object".split(",")});
KISSY.add("event/dom/base/key-codes",function(e){var g=e.UA,a={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,
Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,
WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(b){if(b.altKey&&!b.ctrlKey||b.metaKey||b.keyCode>=a.F1&&b.keyCode<=a.F12)return!1;switch(b.keyCode){case a.ALT:case a.CAPS_LOCK:case a.CONTEXT_MENU:case a.CTRL:case a.DOWN:case a.END:case a.ESC:case a.HOME:case a.INSERT:case a.LEFT:case a.MAC_FF_META:case a.META:case a.NUMLOCK:case a.NUM_CENTER:case a.PAGE_DOWN:case a.PAGE_UP:case a.PAUSE:case a.PRINT_SCREEN:case a.RIGHT:case a.SHIFT:case a.UP:case a.WIN_KEY:case a.WIN_KEY_RIGHT:return!1;
default:return!0}},isCharacterKey:function(b){if(b>=a.ZERO&&b<=a.NINE||b>=a.NUM_ZERO&&b<=a.NUM_MULTIPLY||b>=a.A&&b<=a.Z||g.webkit&&0==b)return!0;switch(b){case a.SPACE:case a.QUESTION_MARK:case a.NUM_PLUS:case a.NUM_MINUS:case a.NUM_PERIOD:case a.NUM_DIVISION:case a.SEMICOLON:case a.DASH:case a.EQUALS:case a.COMMA:case a.PERIOD:case a.SLASH:case a.APOSTROPHE:case a.SINGLE_QUOTE:case a.OPEN_SQUARE_BRACKET:case a.BACKSLASH:case a.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}};return a});
KISSY.add("event/dom/base/gesture",function(){return{start:"mousedown",move:"mousemove",end:"mouseup",tap:"click",doubleTap:"dblclick"}});
KISSY.add("event/dom/base/special-events",function(e,g,a){var b=b;return e.mix(a,{mousewheel:{typeFix:e.UA.gecko?"DOMMouseScroll":"mousewheel"},load:{bubbles:!1},click:{fire:function(a){return!a&&"checkbox"===""+this.type&&this.click&&"input"==this.nodeName.toLowerCase()?(this.click(),!1):b}},focus:{bubbles:!1,preFire:function(a,b){b||g.fire(this,"focusin")},fire:function(a){return!a&&this.ownerDocument&&this!==this.ownerDocument.activeElement&&this.focus?(this.focus(),!1):b}},blur:{bubbles:!1,preFire:function(a,
b){b||g.fire(this,"focusout")},fire:function(a){return!a&&this.ownerDocument&&this===this.ownerDocument.activeElement&&this.blur?(this.blur(),!1):b}}})},{requires:["./dom-event","./special"]});
KISSY.add("event/dom/base/mouseenter",function(e,g,a){e.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(b){a[b.name]={typeFix:b.fix,handle:function(a,b,e){var k=a.currentTarget,p=a.relatedTarget;if(!p||p!==k&&!g.contains(k,p))return[b.simpleNotify(a,e)]}}})},{requires:["dom","./special"]});
KISSY.add("event/dom/base/valuechange",function(e,g,a,b){function q(b){if(a.hasData(b,d)){var c=a.data(b,d);clearTimeout(c);a.removeData(b,d)}}function l(a){q(a.target)}function s(b){var d=b.value,e=a.data(b,f);d!==e&&(g.fireHandler(b,c,{prevVal:e,newVal:d}),a.data(b,f,d))}function k(b){a.hasData(b,d)||a.data(b,d,setTimeout(function(){s(b);a.data(b,d,setTimeout(arguments.callee,h))},h))}function p(b){var c=b.target;"focus"==b.type&&a.data(c,f,c.value);k(c)}function m(a){s(a.target)}function n(b){a.removeData(b,
f);q(b);g.detach(b,"blur",l);g.detach(b,"webkitspeechchange",m);g.detach(b,"mousedown keyup keydown focus",p)}var c="valuechange",j=a.nodeName,f="event/valuechange/history",d="event/valuechange/poll",h=50;b[c]={setup:function(){var a=j(this);if("input"==a||"textarea"==a)n(this),g.on(this,"blur",l),g.on(this,"webkitspeechchange",m),g.on(this,"mousedown keyup keydown focus",p)},tearDown:function(){n(this)}};return g},{requires:["./dom-event","dom","./special"]});
KISSY.add("event/dom/base",function(e,g,a,b,q,l){return e.merge({add:g.on,remove:g.detach,KeyCode:b,Gesture:q,Special:l,Object:a},g)},{requires:"./base/dom-event,./base/object,./base/key-codes,./base/gesture,./base/special-events,./base/mouseenter,./base/valuechange".split(",")});
