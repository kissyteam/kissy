/*
Copyright 2012, KISSY UI Library v1.40dev
MIT Licensed
build time: Nov 1 21:34
*/
KISSY.add("event/dom/base/api",function(h,d,b,c,o,i,g){function k(a,b){var f=c[b]||{};a.originalType||(a.selector?f.delegateFix&&(a.originalType=b,b=f.delegateFix):f.onFix&&(a.originalType=b,b=f.onFix));return b}function n(a,b,f){var c,m,d,b=k(f,b);c=i.getCustomEvents(a,1);if(!(d=c.handle))d=c.handle=function(a){var b=a.type,f=d.currentTarget;if(!(i.triggeredEvent==b||"undefined"==typeof KISSY))if(b=i.getCustomEvent(f,b))return a.currentTarget=f,a=new g(a),b.notify(a)},d.currentTarget=a;if(!(m=c.events))m=
c.events={};c=m[b];c||(c=m[b]=new i({type:b,fn:d,currentTarget:a}),c.setup());c.on(f);a=null}var a=d._Utils;h.mix(d,{add:function(j,e,f,c){e=h.trim(e);j=b.query(j);a.batchForType(function(b,f,e,j){e=a.normalizeParam(f,e,j);f=e.type;for(j=b.length-1;0<=j;j--)n(b[j],f,e)},1,j,e,f,c);return j},remove:function(j,e,f,c){e=h.trim(e);j=b.query(j);a.batchForType(function(b,f,e,j){e=a.normalizeParam(f,e,j);f=e.type;for(j=b.length-1;0<=j;j--){var c=b[j],d=f,g=e,g=g||{},p=void 0,d=k(g,d),c=i.getCustomEvents(c),
p=(c||{}).events;if(c&&p)if(d)(p=p[d])&&p.detach(g);else for(d in p)p[d].detach(g)}},1,j,e,f,c);return j},delegate:function(a,b,f,c,g){return d.add(a,b,{fn:c,context:g,selector:f})},undelegate:function(a,b,f,c,g){return d.remove(a,b,{fn:c,context:g,selector:f})},fire:function(j,e,f,c){var d=void 0,f=f||{};f._ks_fired=1;a.splitAndRun(e,function(e){f.type=e;var g,l,k,e=a.getTypedGroups(e);(l=e[1])&&(l=a.getGroupsRe(l));e=e[0];h.mix(f,{type:e,_ks_groups:l});j=b.query(j);for(l=j.length-1;0<=l;l--)g=j[l],
k=i.getCustomEvent(g,e),!c&&!k&&(k=new i({type:e,currentTarget:g})),k&&(g=k.fire(f,c),!1!==d&&(d=g))});return d},fireHandler:function(a,b,f){return d.fire(a,b,f,1)},_clone:function(a,b){var f;(f=i.getCustomEvents(a))&&h.each(f.events,function(a,f){h.each(a.observers,function(a){n(b,f,a)})})},_ObservableDOMEvent:i});d.on=d.add;d.detach=d.remove;return d},{requires:"event/base,dom,./special,./utils,./observable,./object".split(",")});
KISSY.add("event/dom/base",function(h,d,b,c,o,i){h.mix(d,{KeyCodes:b,_DOMUtils:c,Gesture:o,_Special:i});return d},{requires:"event/base,./base/key-codes,./base/utils,./base/gesture,./base/special,./base/api,./base/change,./base/submit,./base/focusin,./base/hashchange,./base/mouseenter,./base/mousewheel,./base/valuechange".split(",")});
KISSY.add("event/dom/base/change",function(h,d,b,c,o){var i=h.Env.host.document,i=i&&i.documentMode;if(d.ie&&(9>d.ie||i&&9>i)){var g=/^(?:textarea|input|select)$/i,k=function(a){a=a.type;return"checkbox"==a||"radio"==a};o.change={setup:function(){if(g.test(this.nodeName))if(k(this))b.on(this,"propertychange",n),b.on(this,"click",a);else return!1;else b.on(this,"beforeactivate",j)},tearDown:function(){if(g.test(this.nodeName))if(k(this))b.remove(this,"propertychange",n),b.remove(this,"click",a);else return!1;
else b.remove(this,"beforeactivate",j),h.each(c.query("textarea,input,select",this),function(a){a.__changeHandler&&(a.__changeHandler=0,b.remove(a,"change",{fn:e,last:1}))})}};var n=function(a){"checked"==a.originalEvent.propertyName&&(this.__changed=1)},a=function(a){this.__changed&&(this.__changed=0,b.fire(this,"change",a))},j=function(a){a=a.target;g.test(a.nodeName)&&!a.__changeHandler&&(a.__changeHandler=1,b.on(a,"change",{fn:e,last:1}))},e=function(a){if(!a.isPropagationStopped()&&!k(this)){var e;
(e=this.parentNode)&&b.fire(e,"change",a)}}}},{requires:["ua","./api","dom","./special"]});
KISSY.add("event/dom/base/focusin",function(h,d,b,c){d.ie||h.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(d){function i(c){return b.fire(c.target,d.name)}var g=h.guid("attaches_"+h.now()+"_");c[d.name]={setup:function(){var b=this.ownerDocument||this;g in b||(b[g]=0);b[g]+=1;1===b[g]&&b.addEventListener(d.fix,i,!0)},tearDown:function(){var b=this.ownerDocument||this;b[g]-=1;0===b[g]&&b.removeEventListener(d.fix,i,!0)}}});c.focus={delegateFix:"focusin"};c.blur={delegateFix:"focusout"};
return b},{requires:["ua","./api","./special"]});KISSY.add("event/dom/base/gesture",function(){return{start:"mousedown",move:"mousemove",end:"mouseup",tap:"click"}});
KISSY.add("event/dom/base/hashchange",function(h,d,b,c,o){var i=h.Env.host,g=i.document,k=g&&g.documentMode,n="__replace_history_"+h.now(),c=k||c.ie;d.REPLACE_HISTORY=n;if(!("onhashchange"in i)||c&&8>c){var a="<html><head><title>"+(g&&g.title||"")+" - {hash}</title>{head}</head><body>{hash}</body></html>",j=function(){return"#"+(new h.Uri(location.href)).getFragment()},e,f,p=function(){var a=j(),b;if(b=h.endsWith(a,n))a=a.slice(0,-n.length),location.hash=a;a!==f&&(f=a,m(a,b));e=setTimeout(p,50)},
m=c&&8>c?function(e,c){var j=h.substitute(a,{hash:h.escapeHTML(e),head:b.isCustomDomain()?"<script>document.domain = '"+g.domain+"';<\/script>":""}),f=l.contentWindow.document;try{c?f.open("text/html","replace"):f.open(),f.write(j),f.close()}catch(d){}}:function(){d.fire(i,"hashchange")},s=function(){e||p()},r=function(){e&&clearTimeout(e);e=0},l;8>c&&(s=function(){if(!l){var a=b.getEmptyIframeSrc();l=b.create("<iframe "+(a?'src="'+a+'"':"")+' style="display: none" height="0" width="0" tabindex="-1" title="empty"/>');
b.prepend(l,g.documentElement);d.add(l,"load",function(){d.remove(l,"load");m(j());d.add(l,"load",e);p()});g.onpropertychange=function(){try{"title"===event.propertyName&&(l.contentWindow.document.title=g.title+" - "+j())}catch(a){}};var e=function(){var a=h.trim(l.contentWindow.document.body.innerText),b=j();a!=b&&(f=location.hash=a);d.fire(i,"hashchange")}}},r=function(){e&&clearTimeout(e);e=0;d.detach(l);b.remove(l);l=0});o.hashchange={setup:function(){if(this===i){f=j();s()}},tearDown:function(){this===
i&&r()}}}},{requires:["./api","dom","ua","./special"]});
KISSY.add("event/dom/base/key-codes",function(h,d){var b={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,
Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,
WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(c){if(c.altKey&&!c.ctrlKey||c.metaKey||c.keyCode>=b.F1&&c.keyCode<=b.F12)return!1;switch(c.keyCode){case b.ALT:case b.CAPS_LOCK:case b.CONTEXT_MENU:case b.CTRL:case b.DOWN:case b.END:case b.ESC:case b.HOME:case b.INSERT:case b.LEFT:case b.MAC_FF_META:case b.META:case b.NUMLOCK:case b.NUM_CENTER:case b.PAGE_DOWN:case b.PAGE_UP:case b.PAUSE:case b.PRINT_SCREEN:case b.RIGHT:case b.SHIFT:case b.UP:case b.WIN_KEY:case b.WIN_KEY_RIGHT:return!1;
default:return!0}},isCharacterKey:function(c){if(c>=b.ZERO&&c<=b.NINE||c>=b.NUM_ZERO&&c<=b.NUM_MULTIPLY||c>=b.A&&c<=b.Z||d.webkit&&0==c)return!0;switch(c){case b.SPACE:case b.QUESTION_MARK:case b.NUM_PLUS:case b.NUM_MINUS:case b.NUM_PERIOD:case b.NUM_DIVISION:case b.SEMICOLON:case b.DASH:case b.EQUALS:case b.COMMA:case b.PERIOD:case b.SLASH:case b.APOSTROPHE:case b.SINGLE_QUOTE:case b.OPEN_SQUARE_BRACKET:case b.BACKSLASH:case b.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}};return b},{requires:["ua"]});
KISSY.add("event/dom/base/mouseenter",function(h,d,b,c,o){h.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(c){o[c.name]={onFix:c.fix,delegateFix:c.fix,handle:function(c,d,i){var a=c.currentTarget,j=c.relatedTarget;if(!j||j!==a&&!b.contains(a,j))return[d.simpleNotify(c,i)]}}});return d},{requires:["./api","dom","ua","./special"]});
KISSY.add("event/dom/base/mousewheel",function(h,d,b){h=b.gecko?"DOMMouseScroll":"mousewheel";d.mousewheel={onFix:h,delegateFix:h}},{requires:["./special","ua"]});
KISSY.add("event/dom/base/object",function(h,d){function b(a){this.originalEvent=a;this.isDefaultPrevented=a.defaultPrevented||a.returnValue===k||a.getPreventDefault&&a.getPreventDefault()?function(){return g}:function(){return k};c(this);o(this)}function c(a){for(var b=a.originalEvent,e=n.length,c,d=b.currentTarget,d=9===d.nodeType?d:d.ownerDocument||i;e;)c=n[--e],a[c]=b[c];a.target||(a.target=a.srcElement||d);3===a.target.nodeType&&(a.target=a.target.parentNode);!a.relatedTarget&&a.fromElement&&
(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement);void 0===a.pageX&&void 0!==a.clientX&&(b=d.documentElement,e=d.body,a.pageX=a.clientX+(b&&b.scrollLeft||e&&e.scrollLeft||0)-(b&&b.clientLeft||e&&e.clientLeft||0),a.pageY=a.clientY+(b&&b.scrollTop||e&&e.scrollTop||0)-(b&&b.clientTop||e&&e.clientTop||0));void 0===a.which&&(a.which=void 0===a.charCode?a.keyCode:a.charCode);void 0===a.metaKey&&(a.metaKey=a.ctrlKey);!a.which&&void 0!==a.button&&(a.which=a.button&1?1:a.button&2?3:a.button&
4?2:0)}function o(a){var b,e,c,d=a.detail;a.wheelDelta&&(c=a.wheelDelta/120);a.detail&&(c=-(0==d%3?d/3:d));void 0!==a.axis&&(a.axis===a.HORIZONTAL_AXIS?(e=0,b=-1*c):a.axis===a.VERTICAL_AXIS&&(b=0,e=c));void 0!==a.wheelDeltaY&&(e=a.wheelDeltaY/120);void 0!==a.wheelDeltaX&&(b=-1*a.wheelDeltaX/120);!b&&!e&&(e=c);h.mix(a,{deltaY:e,delta:c,deltaX:b})}var i=h.Env.host.document,g=!0,k=!1,n="type,altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,data,detail,eventPhase,fromElement,handler,keyCode,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which,axis,changedTouches,touches,targetTouches,rotation,scale".split(",");
h.extend(b,d._Object,{constructor:b,preventDefault:function(){var a=this.originalEvent;a.preventDefault?a.preventDefault():a.returnValue=k;b.superclass.preventDefault.call(this)},stopPropagation:function(){var a=this.originalEvent;a.stopPropagation?a.stopPropagation():a.cancelBubble=g;b.superclass.stopPropagation.call(this)}});return b},{requires:["event/base"]});
KISSY.add("event/dom/base/observable",function(h,d,b,c,o,i,g){function k(a){h.mix(this,a);this.reset()}var n=g._Utils;h.extend(k,g._ObservableEvent,{setup:function(){var a=this.type,d=b[a]||{},e=this.currentTarget,f=c.data(e).handle;(!d.setup||!1===d.setup.call(e,a))&&c.simpleAdd(e,a,f)},constructor:k,reset:function(){k.superclass.reset.call(this);this.lastCount=this.delegateCount=0},notify:function(a){var b=a.target,c=this.currentTarget,f=this.observers,g=[],i,h,r=this.delegateCount||0,l,k;if(r&&
!b.disabled)for(;b!=c;){l=[];for(h=0;h<r;h++)k=f[h],d.test(b,k.selector)&&l.push(k);l.length&&g.push({currentTarget:b,currentTargetObservers:l});b=b.parentNode||c}g.push({currentTarget:c,currentTargetObservers:f.slice(r)});h=0;for(b=g.length;!a.isPropagationStopped()&&h<b;++h){c=g[h];l=c.currentTargetObservers;c=c.currentTarget;a.currentTarget=c;for(c=0;!a.isImmediatePropagationStopped()&&c<l.length;c++)f=l[c],f=f.notify(a,this),!1!==i&&(i=f)}return i},fire:function(a,c){var a=a||{},e=this.type,f=
b[e];f&&f.onFix&&(e=f.onFix);var g,m,f=this.currentTarget,o=!0;a.type=e;a instanceof i||(m=a,a=new i({currentTarget:f,target:f}),h.mix(a,m));m=f;var r=d._getWin(m.ownerDocument||m),l="on"+e;do{a.currentTarget=m;if(g=k.getCustomEvent(m,e))g=g.notify(a),!1!==o&&(o=g);m[l]&&!1===m[l].call(m)&&a.preventDefault();m=m.parentNode||m.ownerDocument||m===f.ownerDocument&&r}while(!c&&m&&!a.isPropagationStopped());if(!c&&!a.isDefaultPrevented()){var n;try{if(l&&f[e]&&("focus"!==e&&"blur"!==e||0!==f.offsetWidth)&&
!h.isWindow(f))(n=f[l])&&(f[l]=null),k.triggeredEvent=e,f[e]()}catch(t){}n&&(f[l]=n);k.triggeredEvent=""}return o},on:function(a){var c=this.observers,e=b[this.type]||{},a=a instanceof o?a:new o(a);-1==this.findObserver(a)&&(a.selector?(c.splice(this.delegateCount,0,a),this.delegateCount++):a.last?(c.push(a),this.lastCount++):c.splice(c.length-this.lastCount,0,a),e.add&&e.add.call(this.currentTarget,a))},detach:function(a){var c,e=b[this.type]||{},d="selector"in a,g=a.selector,i=a.context,h=a.fn,
k=this.currentTarget,l=this.observers,a=a.groups;if(l.length){a&&(c=n.getGroupsRe(a));var o,t,q,u,v=l.length;if(h||d||c){i=i||k;o=a=0;for(t=[];a<v;++a)q=l[a],u=q.context||k,i!=u||h&&h!=q.fn||d&&(g&&g!=q.selector||!g&&!q.selector)||c&&!q.groups.match(c)?t[o++]=q:(q.selector&&this.delegateCount&&this.delegateCount--,q.last&&this.lastCount&&this.lastCount--,e.remove&&e.remove.call(k,q));this.observers=t}else this.reset();this.checkMemory()}},checkMemory:function(){var a=this.type,d,e,f=b[a]||{},g=this.currentTarget,
i=c.data(g);if(i&&(d=i.events,this.hasObserver()||(e=i.handle,(!f.tearDown||!1===f.tearDown.call(g,a))&&c.simpleRemove(g,a,e),delete d[a]),h.isEmptyObject(d)))i.handle=null,c.removeData(g)}});k.triggeredEvent="";k.getCustomEvent=function(a,b){var d=c.data(a),f;d&&(f=d.events);if(f)return f[b]};k.getCustomEvents=function(a,b){var d=c.data(a);!d&&b&&c.data(a,d={});return d};return k},{requires:"dom,./special,./utils,./observer,./object,event/base".split(",")});
KISSY.add("event/dom/base/observer",function(h,d,b){function c(b){c.superclass.constructor.apply(this,arguments)}h.extend(c,b._Observer,{keys:"fn,selector,data,context,originalType,groups,last".split(","),notifyInternal:function(b,c){var g,h,n=b.type;this.originalType&&(b.type=this.originalType);(g=d[b.type])&&g.handle?(g=g.handle(b,this,c))&&0<g.length&&(h=g[0]):h=this.simpleNotify(b,c);b.type=n;return h}});return c},{requires:["./special","event/base"]});KISSY.add("event/dom/base/special",function(){return{}});
KISSY.add("event/dom/base/submit",function(h,d,b,c,o){var i=h.Env.host.document,i=i&&i.documentMode;if(d.ie&&(9>d.ie||i&&9>i)){var g=c.nodeName;o.submit={setup:function(){if("form"==g(this))return!1;b.on(this,"click keypress",k)},tearDown:function(){if("form"==g(this))return!1;b.remove(this,"click keypress",k);h.each(c.query("form",this),function(a){a.__submit__fix&&(a.__submit__fix=0,b.remove(a,"submit",{fn:n,last:1}))})}};var k=function(a){var a=a.target,c=g(a);if((a="input"==c||"button"==c?a.form:
null)&&!a.__submit__fix)a.__submit__fix=1,b.on(a,"submit",{fn:n,last:1})},n=function(a){this.parentNode&&!a.isPropagationStopped()&&!a._ks_fired&&b.fire(this.parentNode,"submit",a)}}},{requires:["ua","./api","dom","./special"]});
KISSY.add("event/dom/base/utils",function(h,d){var b=h.Env.host.document;return{simpleAdd:b&&b.addEventListener?function(b,d,h,g){b.addEventListener&&b.addEventListener(d,h,!!g)}:function(b,d,h){b.attachEvent&&b.attachEvent("on"+d,h)},simpleRemove:b&&b.removeEventListener?function(b,d,h,g){b.removeEventListener&&b.removeEventListener(d,h,!!g)}:function(b,d,h){b.detachEvent&&b.detachEvent("on"+d,h)},data:function(b,h){return d.data(b,"ksEventTargetId_1.30",h)},removeData:function(b){return d.removeData(b,
"ksEventTargetId_1.30")}}},{requires:["dom"]});
KISSY.add("event/dom/base/valuechange",function(h,d,b,c){function o(a){if(b.hasData(a,m)){var c=b.data(a,m);clearTimeout(c);b.removeData(a,m)}}function i(a){o(a.target)}function g(a){var c=a.value,f=b.data(a,p);c!==f&&(d.fireHandler(a,e,{prevVal:f,newVal:c}),b.data(a,p,c))}function k(a){b.hasData(a,m)||b.data(a,m,setTimeout(function(){g(a);b.data(a,m,setTimeout(arguments.callee,s))},s))}function n(a){var c=a.target;"focus"==a.type&&b.data(c,p,c.value);k(c)}function a(a){g(a.target)}function j(c){b.removeData(c,
p);o(c);d.remove(c,"blur",i);d.remove(c,"webkitspeechchange",a);d.remove(c,"mousedown keyup keydown focus",n)}var e="valuechange",f=b.nodeName,p="event/valuechange/history",m="event/valuechange/poll",s=50;c[e]={setup:function(){var b=f(this);if("input"==b||"textarea"==b)j(this),d.on(this,"blur",i),d.on(this,"webkitspeechchange",a),d.on(this,"mousedown keyup keydown focus",n)},tearDown:function(){j(this)}};return d},{requires:["./api","dom","./special"]});
