/*
Copyright 2012, KISSY UI Library v1.40dev
MIT Licensed
build time: Nov 28 02:50
*/
KISSY.add("event/dom/touch/single-touch",function(e){function b(){}b.prototype={requiredTouchCount:1,onTouchStart:function(b){if(b.touches.length!=this.requiredTouchCount)return!1;this.lastTouches=b.touches},onTouchMove:e.noop,onTouchEnd:e.noop};return b});
KISSY.add("event/dom/touch/double-tap",function(e,b,f,c){function a(){}e.extend(a,c,{onTouchStart:function(g){if(!1===a.superclass.onTouchStart.apply(this,arguments))return!1;this.startTime=g.timeStamp;this.singleTapTimer&&(clearTimeout(this.singleTapTimer),this.singleTapTimer=0)},onTouchMove:function(){return!1},onTouchEnd:function(a){var b=this.lastEndTime,c=a.timeStamp,d=a.target,j=a.changedTouches[0],h=c-this.startTime;this.lastEndTime=c;if(b&&(h=c-b,300>h)){this.lastEndTime=0;f.fire(d,"doubleTap",
{touch:j,duration:h});return}h=c-this.startTime;300<h?f.fire(d,"singleTap",{touch:j,duration:h}):this.singleTapTimer=setTimeout(function(){f.fire(d,"singleTap",{touch:j,duration:h})},300)}});b.singleTap=b.doubleTap=new a;return a},{requires:["./handle-map","event/dom/base","./single-touch"]});KISSY.add("event/dom/touch/gesture",function(e,b){var f=b.Gesture,c,a,g;e.Features.isTouchSupported()&&(c="touchstart",a="touchmove",g="touchend");c&&(f.start=c,f.move=a,f.end=g,f.tap="tap");return f},{requires:["event/dom/base"]});
KISSY.add("event/dom/touch/handle-map",function(){return{}});
KISSY.add("event/dom/touch/handle",function(e,b,f,c,a){function g(a){this.doc=a;this.eventHandle={};this.init()}var i=e.guid("touch-handle"),m=e.Features,d={};d[a.start]="onTouchStart";d[a.move]="onTouchMove";d[a.end]="onTouchEnd";"mousedown"!==a.start&&(d.touchcancel="onTouchEnd");g.prototype={init:function(){var a=this.doc,g,b;this.onTouchMove=e.throttle(this.onTouchMove,30);for(g in d){b=d[g];c.on(a,g,this[b],this)}},normalize:function(a){var g=a.type,b;if(!m.isTouchSupported()){if(g.indexOf("mouse")!=
-1&&a.which!=1)return;b=[a];g=!g.match(/up$/i);a.touches=g?b:[];a.targetTouches=g?b:[];a.changedTouches=b}return a},onTouchStart:function(a){var g,b,c=this.eventHandle;for(g in c){b=c[g];b.isActive=1}this.callEventHandle("onTouchStart",a)},onTouchMove:function(a){this.callEventHandle("onTouchMove",a)},onTouchEnd:function(a){this.callEventHandle("onTouchEnd",a)},callEventHandle:function(a,g){var b=this.eventHandle,c,d;if(g=this.normalize(g)){for(c in b){d=b[c];if(!d.processed){d.processed=1;if(d.isActive&&
d[a](g)===false)d.isActive=0}}for(c in b){d=b[c];d.processed=0}}},addEventHandle:function(a){var g=f[a];this.eventHandle[a]||(this.eventHandle[a]=g)},removeEventHandle:function(a){delete this.eventHandle[a]},destroy:function(){var a=this.doc,g,b;for(g in d){b=d[g];c.detach(a,g,this[b],this)}}};return{addDocumentHandle:function(a,c){var d=b._getWin(a.ownerDocument||a).document,f=b.data(d,i);f||b.data(d,i,f=new g(d));f.addEventHandle(c)},removeDocumentHandle:function(a,g){var c=b._getWin(a.ownerDocument||
a).document,d=b.data(c,i);if(d){d.removeEventHandle(g);if(e.isEmptyObject(d.eventHandle)){d.destroy();b.removeData(c,i)}}}}},{requires:"dom,./handle-map,event/dom/base,./gesture,./tap,./swipe,./double-tap,./pinch,./tap-hold,./rotate".split(",")});
KISSY.add("event/dom/touch/multi-touch",function(e,b){function f(){}f.prototype={requiredTouchCount:2,onTouchStart:function(b){var a=this.requiredTouchCount,g=b.touches.length;g===a?this.start():g>a&&this.end(b)},onTouchEnd:function(b){this.end(b)},start:function(){this.isTracking||(this.isTracking=!0,this.isStarted=!1)},fireEnd:e.noop,getCommonTarget:function(c){var a=c.touches,c=a[0].target,a=a[1].target;if(c==a||b.contains(c,a))return c;for(;;){if(b.contains(a,c))return a;a=a.parentNode}},end:function(b){this.isTracking&&
(this.isTracking=!1,this.isStarted&&(this.isStarted=!1,this.fireEnd(b)))}};return f},{requires:["dom"]});
KISSY.add("event/dom/touch/pinch",function(e,b,f,c){function a(){}e.extend(a,c,{onTouchMove:function(a){if(this.isTracking){var b=a.touches,c,d=b[0],e=b[1];c=d.pageX-e.pageX;d=d.pageY-e.pageY;c=Math.sqrt(c*c+d*d);this.isStarted?f.fire(this.target,"pinch",{touches:b,distance:c,scale:c/this.startDistance}):(this.isStarted=!0,this.startDistance=c,a=this.target=this.getCommonTarget(a),f.fire(a,"pinchStart",{touches:b,distance:c,scale:1}));this.lastTouches=b}},fireEnd:function(){f.fire(this.target,"pinchEnd",
{touches:this.lastTouches})}});b.pinch=b.pinchEnd=b.pinchEnd=new a;return a},{requires:["./handle-map","event/dom/base","./multi-touch"]});
KISSY.add("event/dom/touch/rotate",function(e,b,f,c){function a(){}var g=180/Math.PI;e.extend(a,f,{onTouchMove:function(a){if(this.isTracking){var b=a.touches,d=b[0],f=b[1],e=this.lastAngle,d=Math.atan2(f.pageY-d.pageY,f.pageX-d.pageX)*g;if(e){var f=Math.abs(d-e),k=d+360,l=d-360;Math.abs(k-e)<f?d=k:Math.abs(l-e)<f&&(d=l)}this.lastAngle=d;this.isStarted?c.fire(this.target,"rotate",{touches:b,originalEvent:a.originalEvent,angle:d,rotation:d-this.startAngle}):(this.isStarted=!0,this.startAngle=d,this.target=
this.getCommonTarget(a),c.fire(this.target,"rotateStart",{originalEvent:a.originalEvent,touches:a.touches,angle:d,rotation:0}))}},fireEnd:function(a){c.fire(this.target,"rotateEnd",{touches:this.lastTouches,originalEvent:a.originalEvent})}});b.rotate=b.rotateEnd=b.rotateStart=new a;return a},{requires:["./handle-map","./multi-touch","event/dom/base"]});
KISSY.add("event/dom/touch/swipe",function(e,b,f,c){function a(){}e.extend(a,c,{onTouchStart:function(b){if(!1===a.superclass.onTouchStart.apply(this,arguments))return!1;var c=b.touches[0];this.startTime=b.timeStamp;this.isVertical=this.isHorizontal=1;this.startX=c.pageX;this.startY=c.pageY;-1!=b.type.indexOf("mouse")&&b.preventDefault()},onTouchMove:function(a){var b=a.changedTouches[0],c=b.pageY,b=Math.abs(b.pageX-this.startX),c=Math.abs(c-this.startY);if(1E3<a.timeStamp-this.startTime)return!1;
this.isVertical&&35<b&&(this.isVertical=0);this.isHorizontal&&35<c&&(this.isHorizontal=0);if(!this.isHorizontal&&!this.isVertical)return!1},onTouchEnd:function(a){if(!1===this.onTouchMove(a))return!1;var b=a.changedTouches[0],c=b.pageX-this.startX,d=b.pageY-this.startY,e=Math.abs(c),h=Math.abs(d);this.isVertical&&50>h&&(this.isVertical=0);this.isHorizontal&&50>e&&(this.isHorizontal=0);if(this.isHorizontal)c=0>c?"left":"right";else if(this.isVertical)c=0>d?"up":"down",e=h;else return!1;f.fire(a.target,
"swipe",{touch:b,direction:c,distance:e,duration:a.timeStamp-this.startTime})}});b.swipe=new a;return a},{requires:["./handle-map","event/dom/base","./single-touch"]});
KISSY.add("event/dom/touch/tap-hold",function(e,b,f,c){function a(){}e.extend(a,f,{onTouchStart:function(b){if(!1===a.superclass.onTouchStart.call(this,b))return!1;this.timer=setTimeout(function(){c.fire(b.target,"tapHold",{touch:b.touches[0],duration:e.now()-b.timeStamp})},1E3)},onTouchMove:function(){clearTimeout(this.timer);return!1},onTouchEnd:function(){clearTimeout(this.timer)}});b.tapHold=new a;return a},{requires:["./handle-map","./single-touch","event/dom/base"]});
KISSY.add("event/dom/touch/tap",function(e,b,f,c){function a(){}e.extend(a,c,{onTouchMove:function(){return!1},onTouchEnd:function(a){f.fire(a.target,"tap",{touch:a.changedTouches[0]})}});b.tap=new a;return a},{requires:["./handle-map","event/dom/base","./single-touch"]});
KISSY.add("event/dom/touch",function(e,b,f,c){var e=b._Special,b={setup:function(a){c.addDocumentHandle(this,a)},tearDown:function(a){c.removeDocumentHandle(this,a)}},a;for(a in f)e[a]=b},{requires:["event/dom/base","./touch/handle-map","./touch/handle"]});
