/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: Nov 18 17:23
*/
KISSY.add("event/base",function(a,b,f,q){function l(h,j,n){if((n=a.trim(n))&&n.indexOf(s)>0){var r=e(arguments);k(n.split(/\s+/),function(u){var p=[].concat(r);p.splice(0,3,j,u);v[h].apply(v,p)});return true}return 0}function c(h){return h&&h.nodeType!==3&&h.nodeType!==8}function m(h,j,n,r,u){var p=B[j]||{};if(!r.length&&(!p.setup||p.setup.call(h)===false))g(h,j,n);p.add&&p.add.call(h,u)}var i=document,d=b._nodeName,e=a.makeArray,g=i.addEventListener?function(h,j,n,r){h.addEventListener&&h.addEventListener(j,
n,!!r)}:function(h,j,n){h.attachEvent&&h.attachEvent("on"+j,n)},o=i.removeEventListener?function(h,j,n,r){h.removeEventListener&&h.removeEventListener(j,n,!!r)}:function(h,j,n){h.detachEvent&&h.detachEvent("on"+j,n)},s=" ",k=a.each,t="",x="trigger-none-"+a.now(),B={},D="ksEventTargetId"+a.now(),v={_clone:function(h,j){if(!(j.nodeType!==b.ELEMENT_NODE||!v._hasData(h))){var n=v._data(h).events;k(n,function(r,u){k(r,function(p){v.on(j,u,p.fn,p.scope,p.data)})})}},_hasData:function(h){return b.hasData(h,
D)},_data:function(){var h=e(arguments);h.splice(1,0,D);return b.data.apply(b,h)},_removeData:function(){var h=e(arguments);h.splice(1,0,D);return b.removeData.apply(b,h)},special:B,__add:function(h,j,n,r,u,p){var w;if(!(!j||!a.isFunction(r)||h&&!c(j))){(w=v._data(j))||v._data(j,w={});var y=w.events=w.events||{};y=y[n]=y[n]||[];r={fn:r,scope:u,data:p};var A=w.handler;if(!A){A=w.handler=function(z,E){if(!(z&&z.type==t)){var F=A.target;if(!z||!z.fixed)z=new f(F,z);var C=z.type;a.isPlainObject(E)&&a.mix(z,
E);if(C)z.type=C;return v._handle(F,z)}};A.target=j}if(h){m(j,n,A,y,r);j=null}y.push(r)}},add:function(h,j,n,r,u){if(l("add",h,j,n,r,u))return h;b.query(h).each(function(p){v.__add(true,p,j,n,r,u)});return h},__getListeners:function(h,j){return(v.__getEvents(h)||{})[j]||[]},__getEvents:function(h){return(h=v._data(h))&&h.events},__remove:function(h,j,n,r,u,p){if(!(!j||h&&!c(j))){var w=v._data(j),y=w&&w.events,A,z,E,F,C,I=h&&B[n]||{};if(y)if(n===q)for(n in y)v.remove.call(v,j,n);else{u=u||j;if(A=y[n]){z=
A.length;if(r&&z){F=E=0;for(C=[];E<z;++E){var J=false,G=A[E],K=G.scope||j;if(r!==G.fn||u!==K){C[F++]=G;J=true}else if(p!==H){var H=G.data;if(!p&&H||H&&!p){C[F++]=G;J=true}else if(p&&H)if(p.equals&&H.equals)if(!H.equals(p)){C[F++]=G;J=true}}!J&&I.remove&&I.remove.call(j,G)}y[n]=C;z=C.length}if(r===q||z===0){if(h&&(!I.tearDown||I.tearDown.call(j)===false))o(j,n,w.handler);delete y[n]}}if(a.isEmptyObject(y)){w.handler.target=null;delete w.handler;delete w.events;v._removeData(j)}}}},remove:function(h,
j,n,r,u){if(l("remove",h,j,n,r))return h;b.query(h).each(function(p){v.__remove(true,p,j,n,r,u)});return h},_handle:function(h,j){for(var n=v.__getListeners(h,j.type).slice(0),r,u,p=0,w=n.length;p<w;++p){r=n[p];r=r.fn.call(r.scope||h,j,r.data);if(r!==q){if(u!==false)u=r;r===false&&j.halt()}if(j.isImmediatePropagationStopped)break}return u},fire:function(h,j,n,r){if(!l("fire",h,j,n,r)){n=n||{};n.type=j;b.query(h).each(function(u){var p=n;if(c(u)){var w=new f(u,q,j);a.mix(w,p);w.type=j;r&&w.halt();
p=u;var y="on"+j;do{w.currentTarget=p;v._handle(p,w);p[y]&&p[y].call(p)===false&&w.preventDefault();p=p.parentNode||p.ownerDocument||p===u.ownerDocument&&window}while(p&&!w.isPropagationStopped);if(!w.isDefaultPrevented)if(!(j==="click"&&d(u,"a"))){var A;try{if(y&&u[j]){if(A=u[y])u[y]=null;t=j;u[j]()}}catch(z){}if(A)u[y]=A;t=x}}})}},__batchForType:l,__simpleAdd:g,__simpleRemove:o};v.on=v.add;v.detach=v.remove;return v},{requires:["dom","event/object"]});
KISSY.add("event/change",function(a,b,f,q){a=document.documentMode;if(b.ie&&(b.ie<9||a&&a<9)){var l=/^(?:textarea|input|select)$/i,c=function(g){g=g.type;return g=="checkbox"||g=="radio"};f.special.change={setup:function(){if(l.test(this.nodeName))if(c(this)){f.on(this,"propertychange",m);f.on(this,"click",i)}else return false;else f.on(this,"beforeactivate",d)},tearDown:function(){if(l.test(this.nodeName))if(c(this)){f.remove(this,"propertychange",m);f.remove(this,"click",i)}else return false;else{f.remove(this,
"beforeactivate",d);q.query("textarea,input,select",this).each(function(g){if(g.__changeHandler){g.__changeHandler=0;f.remove(g,"change",e)}})}}};var m=function(g){if(g.originalEvent.propertyName=="checked")this.__changed=1},i=function(g){if(this.__changed){this.__changed=0;f.fire(this,"change",g)}},d=function(g){g=g.target;if(l.test(g.nodeName)&&!g.__changeHandler){g.__changeHandler=1;f.on(g,"change",e)}},e=function(g){if(!c(this)){var o;if(o=this.parentNode)f.fire(o,"change",g)}}}},{requires:["ua",
"./base","dom"]});
KISSY.add("event/delegate",function(a,b,f){function q(d){return d.fn===undefined&&d.selector===undefined?true:d.fn===undefined?this.selector==d.selector:this.fn==d.fn&&this.selector==d.selector&&this.scope==d.scope}function l(d,e){var g=b.closest(d.target,[e.selector],this);if(g){for(var o=d.currentTarget,s=0;s<g.length;s++){d.currentTarget=g[s];e.fn.call(e.scope||this,d)===false&&d.halt();if(d.isPropagationStopped)break}d.currentTarget=o}}function c(d,e){var g,o=d.target,s=d.relatedTarget;d.type=
e.preType;if(o=b.closest(o,e.selector,this))if(o!==s&&(!s||!b.contains(o,s))){s=d.currentTarget;d.currentTarget=o;g=e.fn.call(e.scope||this,d);d.currentTarget=s}return g}var m=f.__batchForType,i={focus:{type:"focusin"},blur:{type:"focusout"},mouseenter:{type:"mouseover",handler:c},mouseleave:{type:"mouseout",handler:c}};a.mix(f,{delegate:function(d,e,g,o,s){if(m("delegate",d,e,g,o,s))return d;b.query(d).each(function(k){var t=e,x=l;if(i[e]){e=i[t].type;x=i[t].handler||x}f.on(k,e,x,k,{fn:o,selector:g,
preType:t,scope:s,equals:q})});return d},undelegate:function(d,e,g,o,s){if(m("undelegate",d,e,g,o,s))return d;b.query(d).each(function(k){var t=e,x=l;if(i[e]){e=i[t].type;x=i[t].handler||x}f.remove(k,e,x,k,{fn:o,selector:g,preType:t,scope:s,equals:q})});return d}});return f},{requires:["dom","./base"]});
KISSY.add("event/focusin",function(a,b,f){b.ie||a.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(q){function l(m){return f.fire(m.target,q.name)}var c=0;f.special[q.name]={setup:function(){c++===0&&document.addEventListener(q.fix,l,true)},tearDown:function(){--c===0&&document.removeEventListener(q.fix,l,true)}}});return f},{requires:["ua","./base"]});
KISSY.add("event/hashchange",function(a,b,f,q){var l=document;q=l.documentMode||q.ie;if(!("onhashchange"in window)||q&&q<8){var c=window,m="<html><head><title>"+(l.title||"")+" - {hash}</title>{head}</head><body>{hash}</body></html>",i=function(){return"#"+location.href.replace(/^[^#]*#?(.*)$/,"$1")},d,e,g=function(){var x=i();if(x!==e){e=x;o(x)}d=setTimeout(g,50)},o=q&&q<8?function(x){x=a.substitute(m,{hash:x,head:f._isCustomDomain()?"<script>document.domain = '"+l.domain+"';<\/script>":""});var B=
t.contentWindow.document;try{B.open();B.write(x);B.close()}catch(D){}}:function(){b.fire(c,"hashchange")},s=function(){d||g()},k=function(){d&&clearTimeout(d);d=0},t;if(q<8){s=function(){if(!t){var x=f._genEmptyIframeSrc();t=f.create("<iframe "+(x?'src="'+x+'"':"")+' style="display: none" height="0" width="0" tabindex="-1" title="empty"/>');f.prepend(t,l.documentElement);b.add(t,"load",function(){b.remove(t,"load");o(i());b.add(t,"load",B);g()});l.onpropertychange=function(){try{if(event.propertyName===
"title")t.contentWindow.document.title=l.title+" - "+i()}catch(D){}};var B=function(){var D=a.trim(t.contentWindow.document.body.innerText),v=i();if(D!=v)e=location.hash=D;b.fire(c,"hashchange")}}};k=function(){d&&clearTimeout(d);d=0;b.detach(t);f.remove(t);t=0}}b.special.hashchange={setup:function(){if(this===c){e=i();s()}},tearDown:function(){this===c&&k()}}}},{requires:["./base","dom","ua"]});
KISSY.add("event/keycodes",function(){var a={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,
WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,
MAC_FF_META:224,WIN_IME:229};a.isTextModifyingKeyEvent=function(b){if(b.altKey&&!b.ctrlKey||b.metaKey||b.keyCode>=a.F1&&b.keyCode<=a.F12)return false;switch(b.keyCode){case a.ALT:case a.CAPS_LOCK:case a.CONTEXT_MENU:case a.CTRL:case a.DOWN:case a.END:case a.ESC:case a.HOME:case a.INSERT:case a.LEFT:case a.MAC_FF_META:case a.META:case a.NUMLOCK:case a.NUM_CENTER:case a.PAGE_DOWN:case a.PAGE_UP:case a.PAUSE:case a.PHANTOM:case a.PRINT_SCREEN:case a.RIGHT:case a.SHIFT:case a.UP:case a.WIN_KEY:case a.WIN_KEY_RIGHT:return false;
default:return true}};a.isCharacterKey=function(b){if(b>=a.ZERO&&b<=a.NINE)return true;if(b>=a.NUM_ZERO&&b<=a.NUM_MULTIPLY)return true;if(b>=a.A&&b<=a.Z)return true;if(goog.userAgent.WEBKIT&&b==0)return true;switch(b){case a.SPACE:case a.QUESTION_MARK:case a.NUM_PLUS:case a.NUM_MINUS:case a.NUM_PERIOD:case a.NUM_DIVISION:case a.SEMICOLON:case a.DASH:case a.EQUALS:case a.COMMA:case a.PERIOD:case a.SLASH:case a.APOSTROPHE:case a.SINGLE_QUOTE:case a.OPEN_SQUARE_BRACKET:case a.BACKSLASH:case a.CLOSE_SQUARE_BRACKET:return true;
default:return false}};return a});KISSY.add("event/mouseenter",function(a,b,f,q){q.ie||a.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(l){function c(m){var i=m.relatedTarget;m.type=l.name;try{if(!(i&&i!==document&&!i.parentNode))if(i!==this&&(!i||!f.contains(this,i)))b._handle(this,m)}catch(d){}}b.special[l.name]={setup:function(){b.add(this,l.fix,c)},tearDown:function(){b.remove(this,l.fix,c)}}});return b},{requires:["./base","dom","ua"]});
KISSY.add("event/mousewheel",function(a,b,f){function q(c){var m=b._data(this).handler,i,d,e,g=c.detail;if(c.wheelDelta)e=c.wheelDelta/120;if(c.detail)e=-(g%3==0?g/3:g);if(c.axis!==undefined)if(c.axis===c.HORIZONTAL_AXIS){d=0;i=-1*e}else if(c.axis===c.VERTICAL_AXIS){i=0;d=e}if(c.wheelDeltaY!==undefined)d=c.wheelDeltaY/120;if(c.wheelDeltaX!==undefined)i=-1*c.wheelDeltaX/120;if(!i&&!d)d=e;return m(c,{deltaY:d,delta:e,deltaX:i,type:"mousewheel"})}var l=f.gecko?"DOMMouseScroll":"mousewheel";b.special.mousewheel=
{setup:function(){var c;c=b._data(this)[c]=a.bind(q,this);b.__simpleAdd(this,l,c)},tearDown:function(){var c,m=b._data(this);c=m[c];b.__simpleRemove(this,l,c);delete m[c]}}},{requires:["./base","ua","./object"]});
KISSY.add("event/object",function(a,b){function f(c,m,i){this.currentTarget=c;this.originalEvent=m||{};if(m){this.type=m.type;this._fix()}else{this.type=i;this.target=c}this.currentTarget=c;this.fixed=true}var q=document,l="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which axis".split(" ");a.augment(f,
{_fix:function(){var c=this.originalEvent,m=l.length,i,d=this.currentTarget;for(d=d.nodeType===9?d:d.ownerDocument||q;m;){i=l[--m];this[i]=c[i]}if(!this.target)this.target=this.srcElement||q;if(this.target.nodeType===3)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(this.pageX===b&&this.clientX!==b){c=d.documentElement;m=d.body;this.pageX=this.clientX+(c&&c.scrollLeft||m&&m.scrollLeft||
0)-(c&&c.clientLeft||m&&m.clientLeft||0);this.pageY=this.clientY+(c&&c.scrollTop||m&&m.scrollTop||0)-(c&&c.clientTop||m&&m.clientTop||0)}if(this.which===b)this.which=this.charCode===b?this.keyCode:this.charCode;if(this.metaKey===b)this.metaKey=this.ctrlKey;if(!this.which&&this.button!==b)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0},preventDefault:function(){var c=this.originalEvent;if(c.preventDefault)c.preventDefault();else c.returnValue=false;this.isDefaultPrevented=true},stopPropagation:function(){var c=
this.originalEvent;if(c.stopPropagation)c.stopPropagation();else c.cancelBubble=true;this.isPropagationStopped=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=true;this.stopPropagation()},halt:function(c){c?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()}});return f});
KISSY.add("event/submit",function(a,b,f,q){a=document.documentMode;if(b.ie&&(b.ie<9||a&&a<9)){var l=q._nodeName;f.special.submit={setup:function(){if(l(this,"form"))return false;f.on(this,"click keypress",c)},tearDown:function(){if(l(this,"form"))return false;f.remove(this,"click keypress",c);q.query("form",this).each(function(i){if(i.__submit__fix){i.__submit__fix=0;f.remove(i,"submit",m)}})}};var c=function(i){i=i.target;if((i=l(i,"input")||l(i,"button")?i.form:null)&&!i.__submit__fix){i.__submit__fix=
1;f.on(i,"submit",m)}},m=function(i){this.parentNode&&f.fire(this.parentNode,"submit",i)}}},{requires:["ua","./base","dom"]});
KISSY.add("event/target",function(a,b,f){function q(e){e[m]=e[m]||{};return e[m]}function l(e){e[i]=e[i]||{};return e[i]}function c(e){return function(g,o,s){var k=this;a.each(a.trim(g).split(/\s+/),function(t){b["__"+e](false,k,t,o,s)});return k}}var m="__~ks_publish",i="__~ks_bubble_targets",d={fire:function(e,g){var o,s;if(g instanceof f){g.currentTarget=this;s=g}else{o=new f(this,undefined,e);a.isPlainObject(g)&&a.mix(o,g);o.type=e;s=o}o=b._handle(this,s);var k;if(k=!s.isPropagationStopped){k=
q(this);k=k[e]&&k[e].bubbles||k["*"]&&k["*"].bubbles}if(k){s=this.bubble(e,s);if(s===false)o=s}return o},publish:function(e,g){q(this)[e]=g},bubble:function(e,g){var o,s=l(this);a.each(s,function(k){k=k.fire(e,g);if(o!==false)o=k});return o},addTarget:function(e){l(this)[a.stamp(e)]=e},removeTarget:function(e){delete l(this)[a.stamp(e)]},on:c("add")};d.detach=c("remove");return d},{requires:["./base","./object"]});
KISSY.add("event/valuechange",function(a,b,f){function q(k){f.removeData(k,g);if(f.hasData(k,o)){var t=f.data(k,o);clearTimeout(t);f.removeData(k,o)}}function l(k){q(k.target)}function c(k){f.hasData(k,o)||f.data(k,o,setTimeout(function(){var t=k.value,x=f.data(k,g);if(t!==x){b.fire(k,d,{prevVal:x,newVal:t},true);f.data(k,g,t)}f.data(k,o,setTimeout(arguments.callee,s))},s))}function m(k){var t=k.target;k.type=="focus"&&f.data(t,g,t.value);c(t)}function i(k){q(k);b.remove(k,"blur",l);b.remove(k,"mousedown keyup keydown focus",
m)}var d="valuechange",e=f._nodeName,g="event/valuechange/history",o="event/valuechange/poll",s=50;b.special[d]={setup:function(){if(e(this,"input")||e(this,"textarea")){i(this);b.on(this,"blur",l);b.on(this,"mousedown keyup keydown focus",m)}},tearDown:function(){i(this)}};return b},{requires:["./base","dom"]});
KISSY.add("event",function(a,b,f,q,l){f.KeyCodes=b;f.Target=q;f.Object=l;return f},{requires:["event/keycodes","event/base","event/target","event/object","event/focusin","event/hashchange","event/valuechange","event/delegate","event/mouseenter","event/submit","event/change","event/mousewheel"]});
