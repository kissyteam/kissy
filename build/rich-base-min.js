/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Jul 3 13:57
*/
KISSY.add("rich-base",function(e,n){function p(b,a){return a.toUpperCase()}function l(){var b,a;n.apply(this,arguments);a=this.get("listeners");for(b in a)this.on(b,a[b]);this.callMethodByHierarchy("initializer","constructor");this.constructPlugins();this.callPluginsMethod("initializer");this.bindInternal();this.syncInternal()}function q(b){var a;b.target==this&&(a=this[m+b.type.slice(5).slice(0,-6)],a.call(this,b.newVal,b))}var i=e.ucfirst,m="_onSet",o=e.noop,r=/(?:^|-)([a-z])/ig;e.extend(l,n,{collectConstructorChains:function(){for(var b=
[],a=this.constructor;a;)b.push(a),a=a.superclass&&a.superclass.constructor;return b},callMethodByHierarchy:function(b,a,c){for(var d=this.constructor,f=[],e,g,h,j,k,c=c||[];d;){k=[];if(j=d.__ks_exts)for(h=0;h<j.length;h++)if(e=j[h])"constructor"!=a&&(e=e.prototype.hasOwnProperty(a)?e.prototype[a]:null),e&&k.push(e);d.prototype.hasOwnProperty(b)&&(g=d.prototype[b])&&k.push(g);k.length&&f.push.apply(f,k.reverse());d=d.superclass&&d.superclass.constructor}for(h=f.length-1;0<=h;h--)f[h]&&f[h].apply(this,
c)},callPluginsMethod:function(b,a){var c=this,a=a||[],b="plugin"+i(b);e.each(c.get("plugins"),function(d){var f=[c].concat(a);d[b]&&d[b].apply(d,f)})},constructPlugins:function(){var b=this.get("plugins");e.each(b,function(a,c){e.isFunction(a)&&(b[c]=new a)})},bindInternal:function(){var b=this.getAttrs(),a,c;for(a in b)if(c=m+i(a),this[c])this.on("after"+i(a)+"Change",q)},syncInternal:function(){var b,a,c,d,f,e={},g=this.collectConstructorChains(),h;for(c=g.length-1;0<=c;c--)if(d=g[c],h=d.ATTRS)for(f in h)e[f]||
(e[f]=1,d=m+i(f),(a=this[d])&&0!==h[f].sync&&void 0!==(b=this.get(f))&&a.call(this,b))},initializer:o,destructor:o,destroy:function(){if(!this.get("destroyed")){this.callPluginsMethod("destructor");for(var b=this.constructor,a,c,d;b;){b.prototype.hasOwnProperty("destructor")&&b.prototype.destructor.apply(this);if(a=b.__ks_exts)for(d=a.length-1;0<=d;d--)(c=a[d]&&a[d].prototype.__destructor)&&c.apply(this);b=b.superclass&&b.superclass.constructor}this.detach();this.set("destroyed",!0);this.fire("destroy")}},
plug:function(b){e.isFunction(b)&&(b=new b);b.pluginInitializer&&b.pluginInitializer(this);this.get("plugins").push(b);return this},unplug:function(b){var a=[],c=this,d="string"==typeof b;e.each(c.get("plugins"),function(f){var e=0,g;b&&(d?(g=f.get&&f.get("pluginId")||f.pluginId,g!=b&&(a.push(f),e=1)):f!=b&&(a.push(f),e=1));e||f.pluginDestructor(c)});c.setInternal("plugins",a);return c},getPlugin:function(b){var a=null;e.each(this.get("plugins"),function(c){if((c.get&&c.get("pluginId")||c.pluginId)==
b)return a=c,!1});return a}},{ATTRS:{plugins:{value:[]},destroyed:{value:!1},listeners:{value:[]}}});e.mix(l,{extend:function a(c,d,f){var i,g;e.isArray(c)||(f=d,d=c,c=[]);f=f||{};i=f.name||"RichBaseDerived";d=d||{};d.hasOwnProperty("constructor")?g=d.constructor:e.Config.debug?eval("C = function "+i.replace(r,p)+"(){ C.superclass.constructor.apply(this, arguments);}"):g=function(){g.superclass.constructor.apply(this,arguments)};e.extend(g,this,d,f);if(c){g.__ks_exts=c;var h={},j={};e.each(c.concat(g),
function(a){if(a){e.each(a.ATTRS,function(a,c){var d=h[c]=h[c]||{};e.mix(d,a)});var a=a.prototype,c;for(c in a)a.hasOwnProperty(c)&&(j[c]=a[c])}});g.ATTRS=h;e.augment(g,j);g.prototype.constructor=g}g.extend=g.extend||a;return g}});return l},{requires:["base"]});
