/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Aug 6 11:30
*/
KISSY.add("rich-base",function(f,n){function p(b,a){return a.toUpperCase()}function l(){var b,a;n.apply(this,arguments);a=this.get("listeners");for(b in a)this.on(b,a[b]);this.callMethodByHierarchy("initializer","constructor");this.constructPlugins();this.callPluginsMethod("initializer");this.bindInternal();this.syncInternal()}function q(b){var a;b.target==this&&(a=this[m+b.type.slice(5).slice(0,-6)],a.call(this,b.newVal,b))}var j=f.ucfirst,m="_onSet",o=f.noop,r=/(?:^|-)([a-z])/ig;f.extend(l,n,{collectConstructorChains:function(){for(var b=
[],a=this.constructor;a;)b.push(a),a=a.superclass&&a.superclass.constructor;return b},callMethodByHierarchy:function(b,a,c){for(var d=this.constructor,e=[],i,g,h,f,k,c=c||[];d;){k=[];if(f=d.__ks_exts)for(h=0;h<f.length;h++)if(i=f[h])"constructor"!=a&&(i=i.prototype.hasOwnProperty(a)?i.prototype[a]:null),i&&k.push(i);d.prototype.hasOwnProperty(b)&&(g=d.prototype[b])&&k.push(g);k.length&&e.push.apply(e,k.reverse());d=d.superclass&&d.superclass.constructor}for(h=e.length-1;0<=h;h--)e[h]&&e[h].apply(this,
c)},callPluginsMethod:function(b,a){var c=this,a=a||[],b="plugin"+j(b);f.each(c.get("plugins"),function(d){var e=[c].concat(a);d[b]&&d[b].apply(d,e)})},constructPlugins:function(){var b=this.get("plugins");f.each(b,function(a,c){"function"===typeof a&&(b[c]=new a)})},bindInternal:function(){var b=this.getAttrs(),a,c;for(a in b)if(c=m+j(a),this[c])this.on("after"+j(a)+"Change",q)},syncInternal:function(){var b,a,c,d,e,f={},g=this.collectConstructorChains(),h;for(c=g.length-1;0<=c;c--)if(d=g[c],h=d.ATTRS)for(e in h)f[e]||
(f[e]=1,d=m+j(e),(a=this[d])&&0!==h[e].sync&&void 0!==(b=this.get(e))&&a.call(this,b))},initializer:o,destructor:o,destroy:function(){if(!this.get("destroyed")){this.callPluginsMethod("destructor");for(var b=this.constructor,a,c,d;b;){b.prototype.hasOwnProperty("destructor")&&b.prototype.destructor.apply(this);if(a=b.__ks_exts)for(d=a.length-1;0<=d;d--)(c=a[d]&&a[d].prototype.__destructor)&&c.apply(this);b=b.superclass&&b.superclass.constructor}this.detach();this.set("destroyed",!0);this.fire("destroy")}},
plug:function(b){"function"===typeof b&&(b=new b);b.pluginInitializer&&b.pluginInitializer(this);this.get("plugins").push(b);return this},unplug:function(b){var a=[],c=this,d="string"==typeof b;f.each(c.get("plugins"),function(e){var f=0,g;b&&(d?(g=e.get&&e.get("pluginId")||e.pluginId,g!=b&&(a.push(e),f=1)):e!=b&&(a.push(e),f=1));f||e.pluginDestructor(c)});c.setInternal("plugins",a);return c},getPlugin:function(b){var a=null;f.each(this.get("plugins"),function(c){if((c.get&&c.get("pluginId")||c.pluginId)==
b)return a=c,!1});return a},parent:function(){var b=this.constructor,a=arguments.callee.caller.__name__;if(!a)throw Error("parent call error");for(;b&&!b.prototype.hasOwnProperty(a);)b=b.superclass.constructor;b=b.superclass;if(!b)throw Error("base class not found in parent call");a=b[a];if(!a||!a.apply)throw Error("method not found in parent call");return a.apply(this,arguments)}},{ATTRS:{plugins:{value:[]},destroyed:{value:!1},listeners:{value:[]}}});f.mix(l,{extend:function a(c,d,e){var i,g;f.isArray(c)||
(e=d,d=c,c=[]);e=e||{};i=e.name||"RichBaseDerived";d=d||{};d.hasOwnProperty("constructor")?g=d.constructor:f.Config.debug?eval("C = function "+i.replace(r,p)+"(){ C.superclass.constructor.apply(this, arguments);}"):g=function(){g.superclass.constructor.apply(this,arguments)};f.extend(g,this,d,e);if(c){g.__ks_exts=c;var h={},j={};f.each(c.concat(g),function(a){if(a){f.each(a.ATTRS,function(a,c){var d=h[c]=h[c]||{};f.mix(d,a)});var a=a.prototype,c,d;for(c in a)if(a.hasOwnProperty(c)){d=j[c]=a[c];if(typeof d===
"function"){if(d.__name__&&d.__name__!=c)throw Error("name "+c+" overwrite");d.__name__=c}}}});g.ATTRS=h;f.augment(g,j);g.prototype.constructor=g}g.extend=g.extend||a;return g}});return l},{requires:["base"]});
