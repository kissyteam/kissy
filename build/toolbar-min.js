/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Apr 17 00:23
*/
KISSY.add("toolbar",function(h,j,k,n,i){function g(a,b,c){var c=c.get("children"),d=0,e=c.length;if(a==i&&(a=1==b?0:e-1,!c[a].get("disabled")))return c[a];do d++,a=(a+e+b)%e;while(d<e&&c[a].get("disabled"));return d!=e?c[a]:null}function l(a){a.newVal?this.set("expandedItem",null):this.set("expandedItem",a.target)}function m(a){var b=a.target;if(this!==b&&(b.isMenuItem||b.isButton))a.newVal?(a=this.get("children"),this.get("expandedItem")&&h.inArray(b,a)&&this.set("expandedItem",b.isMenuButton?b:
null),this.set("highlightedItem",b)):a.byPassSetToolbarHighlightedItem||this.set("highlightedItem",null)}var f=k.KeyCodes;return j.Container.extend({createDom:function(){this.get("el").attr("role","toolbar")},_onSetHighlightedItem:function(a,b){var c,d;c=b&&b.prevVal;d=this.get("children");var e=this.get("el");c&&h.inArray(c,d)&&c.set("highlighted",!1,{data:{byPassSetToolbarHighlightedItem:1}});a?(e[0].ownerDocument.activeElement!=e[0]&&this.focus(),d=a.get("el"),(c=d.attr("id"))||d.attr("id",c=h.guid("ks-toolbar-item")),
e.attr("aria-activedescendant",c)):e.attr("aria-activedescendant","")},_onSetExpandedItem:function(a,b){b&&b.prevVal&&b.prevVal.set("collapsed",!0);a&&a.set("collapsed",!1)},bindUI:function(){this.on("afterCollapsedChange",l,this);this.on("afterHighlightedChange",m,this)},handleBlur:function(){var a;this.set("expandedItem",null);(a=this.get("highlightedItem"))&&a.set("highlighted",!1)},getNextItemByKeyEventInternal:function(a,b){this.get("orientation");var c=this.get("children"),c=b&&h.indexOf(b,
c);if(b&&b.handleKeyEventInternal(a))return!0;if(a.shiftKey||a.ctrlKey||a.metaKey||a.altKey)return!1;switch(a.keyCode){case f.ESC:return this.getKeyEventTarget().fire("blur"),!0;case f.HOME:b=g(i,1,this);break;case f.END:b=g(i,-1,this);break;case f.UP:b=g(c,-1,this);break;case f.LEFT:b=g(c,-1,this);break;case f.DOWN:b=g(c,1,this);break;case f.RIGHT:b=g(c,1,this);break;default:return!1}return b},handleKeyEventInternal:function(a){var b;a:{b=this.get("children");var c,d;for(c=0;c<b.length;c++)if(d=
b[c],d.get("highlighted")||d.isMenuButton&&!d.get("collapsed")){b=d;break a}b=null}a=this.getNextItemByKeyEventInternal(a,b);if("boolean"==typeof a)return a;a&&a.set("highlighted",!0);return!0}},{ATTRS:{highlightedItem:{},expandedItem:{},defaultChildCfg:{value:{xclass:"button",handleMouseEvents:!1,focusable:!1}}}},{xclass:"toolbar",priority:10})},{requires:["component/base","node"]});
