/*
Copyright 2010, KISSY UI Library v1.1.0
MIT Licensed
build time: Aug 9 16:50
*/
KISSY.add("json",function(g){function w(e){return e<10?"0"+e:e}function q(e){m.lastIndex=0;return m.test(e)?'"'+e.replace(m,function(k){var o=n[k];return typeof o==="string"?o:"\\u"+("0000"+k.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function u(e,k){var o,v,y=j,s,a=k[e];if(a&&typeof a==="object"&&typeof a.toJSON==="function")a=a.toJSON(e);if(typeof l==="function")a=l.call(k,e,a);switch(typeof a){case "string":return q(a);case "number":return isFinite(a)?String(a):"null";case "boolean":case "null":return String(a);
case "object":if(!a)return"null";j+=d;s=[];if(Object.prototype.toString.apply(a)==="[object Array]"){v=a.length;for(e=0;e<v;e+=1)s[e]=u(e,a)||"null";k=s.length===0?"[]":j?"[\n"+j+s.join(",\n"+j)+"\n"+y+"]":"["+s.join(",")+"]";j=y;return k}if(l&&typeof l==="object"){v=l.length;for(e=0;e<v;e+=1){o=l[e];if(typeof o==="string")if(k=u(o,a))s.push(q(o)+(j?": ":":")+k)}}else for(o in a)if(Object.hasOwnProperty.call(a,o))if(k=u(o,a))s.push(q(o)+(j?": ":":")+k);k=s.length===0?"{}":j?"{\n"+j+s.join(",\n"+j)+
"\n"+y+"}":"{"+s.join(",")+"}";j=y;return k}}g=g.JSON=window.JSON||{};if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+w(this.getUTCMonth()+1)+"-"+w(this.getUTCDate())+"T"+w(this.getUTCHours())+":"+w(this.getUTCMinutes())+":"+w(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var t=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
m=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j,d,n={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;if(typeof g.stringify!=="function")g.stringify=function(e,k,o){var v;d=j="";if(typeof o==="number")for(v=0;v<o;v+=1)d+=" ";else if(typeof o==="string")d=o;if((l=k)&&typeof k!=="function"&&(typeof k!=="object"||typeof k.length!=="number"))throw new Error("JSON.stringify");return u("",
{"":e})};if(typeof g.parse!=="function")g.parse=function(e,k){function o(v,y){var s,a,c=v[y];if(c&&typeof c==="object")for(s in c)if(Object.hasOwnProperty.call(c,s)){a=o(c,s);if(a!==undefined)c[s]=a;else delete c[s]}return k.call(v,y,c)}e=String(e);t.lastIndex=0;if(t.test(e))e=e.replace(t,function(v){return"\\u"+("0000"+v.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){e=eval("("+e+")");return typeof k==="function"?o({"":e},""):e}throw new SyntaxError("JSON.parse");}});
(function(){function g(a,c,h,b,f,i){f=0;for(var r=b.length;f<r;f++){var p=b[f];if(p){p=p[a];for(var x=false;p;){if(p.sizcache===h){x=b[p.sizset];break}if(p.nodeType===1&&!i){p.sizcache=h;p.sizset=f}if(p.nodeName.toLowerCase()===c){x=p;break}p=p[a]}b[f]=x}}}function w(a,c,h,b,f,i){f=0;for(var r=b.length;f<r;f++){var p=b[f];if(p){p=p[a];for(var x=false;p;){if(p.sizcache===h){x=b[p.sizset];break}if(p.nodeType===1){if(!i){p.sizcache=h;p.sizset=f}if(typeof c!=="string"){if(p===c){x=true;break}}else if(d.filter(c,
[p]).length>0){x=p;break}}p=p[a]}b[f]=x}}}var q=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,u=0,t=Object.prototype.toString,m=false,j=true;[0,0].sort(function(){j=false;return 0});var d=function(a,c,h,b){h=h||[];var f=c=c||document;if(c.nodeType!==1&&c.nodeType!==9)return[];if(!a||typeof a!=="string")return h;var i=[],r,p,x,C,z=true,A=d.isXML(c),B=a,D;do{q.exec("");if(r=q.exec(B)){B=r[3];i.push(r[1]);if(r[2]){C=
r[3];break}}}while(r);if(i.length>1&&l.exec(a))if(i.length===2&&n.relative[i[0]])p=s(i[0]+i[1],c);else for(p=n.relative[i[0]]?[c]:d(i.shift(),c);i.length;){a=i.shift();if(n.relative[a])a+=i.shift();p=s(a,p)}else{if(!b&&i.length>1&&c.nodeType===9&&!A&&n.match.ID.test(i[0])&&!n.match.ID.test(i[i.length-1])){r=d.find(i.shift(),c,A);c=r.expr?d.filter(r.expr,r.set)[0]:r.set[0]}if(c){r=b?{expr:i.pop(),set:o(b)}:d.find(i.pop(),i.length===1&&(i[0]==="~"||i[0]==="+")&&c.parentNode?c.parentNode:c,A);p=r.expr?
d.filter(r.expr,r.set):r.set;if(i.length>0)x=o(p);else z=false;for(;i.length;){r=D=i.pop();if(n.relative[D])r=i.pop();else D="";if(r==null)r=c;n.relative[D](x,r,A)}}else x=[]}x||(x=p);x||d.error(D||a);if(t.call(x)==="[object Array]")if(z)if(c&&c.nodeType===1)for(a=0;x[a]!=null;a++){if(x[a]&&(x[a]===true||x[a].nodeType===1&&d.contains(c,x[a])))h.push(p[a])}else for(a=0;x[a]!=null;a++)x[a]&&x[a].nodeType===1&&h.push(p[a]);else h.push.apply(h,x);else o(x,h);if(C){d(C,f,h,b);d.uniqueSort(h)}return h};
d.uniqueSort=function(a){if(y){m=j;a.sort(y);if(m)for(var c=1;c<a.length;c++)a[c]===a[c-1]&&a.splice(c--,1)}return a};d.matches=function(a,c){return d(a,null,null,c)};d.find=function(a,c,h){var b;if(!a)return[];for(var f=0,i=n.order.length;f<i;f++){var r=n.order[f],p;if(p=n.leftMatch[r].exec(a)){var x=p[1];p.splice(1,1);if(x.substr(x.length-1)!=="\\"){p[1]=(p[1]||"").replace(/\\/g,"");b=n.find[r](p,c,h);if(b!=null){a=a.replace(n.match[r],"");break}}}}b||(b=c.getElementsByTagName("*"));return{set:b,
expr:a}};d.filter=function(a,c,h,b){for(var f=a,i=[],r=c,p,x,C=c&&c[0]&&d.isXML(c[0]);a&&c.length;){for(var z in n.filter)if((p=n.leftMatch[z].exec(a))!=null&&p[2]){var A=n.filter[z],B,D;D=p[1];x=false;p.splice(1,1);if(D.substr(D.length-1)!=="\\"){if(r===i)i=[];if(n.preFilter[z])if(p=n.preFilter[z](p,r,h,i,b,C)){if(p===true)continue}else x=B=true;if(p)for(var E=0;(D=r[E])!=null;E++)if(D){B=A(D,p,E,r);var F=b^!!B;if(h&&B!=null)if(F)x=true;else r[E]=false;else if(F){i.push(D);x=true}}if(B!==undefined){h||
(r=i);a=a.replace(n.match[z],"");if(!x)return[];break}}}if(a===f)if(x==null)d.error(a);else break;f=a}return r};d.error=function(a){throw"Syntax error, unrecognized expression: "+a;};var n=d.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+\-]*)\))?/,
POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")}},relative:{"+":function(a,c){var h=typeof c==="string",b=h&&!/\W/.test(c);h=h&&!b;if(b)c=c.toLowerCase();b=0;for(var f=a.length,i;b<f;b++)if(i=a[b]){for(;(i=i.previousSibling)&&i.nodeType!==1;);a[b]=h||i&&i.nodeName.toLowerCase()===
c?i||false:i===c}h&&d.filter(c,a,true)},">":function(a,c){var h=typeof c==="string",b,f=0,i=a.length;if(h&&!/\W/.test(c))for(c=c.toLowerCase();f<i;f++){if(b=a[f]){h=b.parentNode;a[f]=h.nodeName.toLowerCase()===c?h:false}}else{for(;f<i;f++)if(b=a[f])a[f]=h?b.parentNode:b.parentNode===c;h&&d.filter(c,a,true)}},"":function(a,c,h){var b=u++,f=w,i;if(typeof c==="string"&&!/\W/.test(c)){i=c=c.toLowerCase();f=g}f("parentNode",c,b,a,i,h)},"~":function(a,c,h){var b=u++,f=w,i;if(typeof c==="string"&&!/\W/.test(c)){i=
c=c.toLowerCase();f=g}f("previousSibling",c,b,a,i,h)}},find:{ID:function(a,c,h){if(typeof c.getElementById!=="undefined"&&!h)return(a=c.getElementById(a[1]))?[a]:[]},NAME:function(a,c){if(typeof c.getElementsByName!=="undefined"){var h=[];c=c.getElementsByName(a[1]);for(var b=0,f=c.length;b<f;b++)c[b].getAttribute("name")===a[1]&&h.push(c[b]);return h.length===0?null:h}},TAG:function(a,c){return c.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,c,h,b,f,i){a=" "+a[1].replace(/\\/g,"")+" ";
if(i)return a;i=0;for(var r;(r=c[i])!=null;i++)if(r)if(f^(r.className&&(" "+r.className+" ").replace(/[\t\n]/g," ").indexOf(a)>=0))h||b.push(r);else if(h)c[i]=false;return false},ID:function(a){return a[1].replace(/\\/g,"")},TAG:function(a){return a[1].toLowerCase()},CHILD:function(a){if(a[1]==="nth"){var c=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=c[1]+(c[2]||1)-0;a[3]=c[3]-0}a[0]=u++;return a},ATTR:function(a,c,h,b,f,i){c=
a[1].replace(/\\/g,"");if(!i&&n.attrMap[c])a[1]=n.attrMap[c];if(a[2]==="~=")a[4]=" "+a[4]+" ";return a},PSEUDO:function(a,c,h,b,f){if(a[1]==="not")if((q.exec(a[3])||"").length>1||/^\w/.test(a[3]))a[3]=d(a[3],null,null,c);else{a=d.filter(a[3],c,h,true^f);h||b.push.apply(b,a);return false}else if(n.match.POS.test(a[0])||n.match.CHILD.test(a[0]))return true;return a},POS:function(a){a.unshift(true);return a}},filters:{enabled:function(a){return a.disabled===false&&a.type!=="hidden"},disabled:function(a){return a.disabled===
true},checked:function(a){return a.checked===true},selected:function(a){return a.selected===true},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,c,h){return!!d(h[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){return"text"===a.type},radio:function(a){return"radio"===a.type},checkbox:function(a){return"checkbox"===a.type},file:function(a){return"file"===a.type},password:function(a){return"password"===a.type},submit:function(a){return"submit"===
a.type},image:function(a){return"image"===a.type},reset:function(a){return"reset"===a.type},button:function(a){return"button"===a.type||a.nodeName.toLowerCase()==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)}},setFilters:{first:function(a,c){return c===0},last:function(a,c,h,b){return c===b.length-1},even:function(a,c){return c%2===0},odd:function(a,c){return c%2===1},lt:function(a,c,h){return c<h[3]-0},gt:function(a,c,h){return c>h[3]-0},nth:function(a,c,h){return h[3]-
0===c},eq:function(a,c,h){return h[3]-0===c}},filter:{PSEUDO:function(a,c,h,b){var f=c[1],i=n.filters[f];if(i)return i(a,h,c,b);else if(f==="contains")return(a.textContent||a.innerText||d.getText([a])||"").indexOf(c[3])>=0;else if(f==="not"){c=c[3];h=0;for(b=c.length;h<b;h++)if(c[h]===a)return false;return true}else d.error("Syntax error, unrecognized expression: "+f)},CHILD:function(a,c){var h=c[1],b=a;switch(h){case "only":case "first":for(;b=b.previousSibling;)if(b.nodeType===1)return false;if(h===
"first")return true;b=a;case "last":for(;b=b.nextSibling;)if(b.nodeType===1)return false;return true;case "nth":h=c[2];var f=c[3];if(h===1&&f===0)return true;c=c[0];var i=a.parentNode;if(i&&(i.sizcache!==c||!a.nodeIndex)){var r=0;for(b=i.firstChild;b;b=b.nextSibling)if(b.nodeType===1)b.nodeIndex=++r;i.sizcache=c}a=a.nodeIndex-f;return h===0?a===0:a%h===0&&a/h>=0}},ID:function(a,c){return a.nodeType===1&&a.getAttribute("id")===c},TAG:function(a,c){return c==="*"&&a.nodeType===1||a.nodeName.toLowerCase()===
c},CLASS:function(a,c){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(c)>-1},ATTR:function(a,c){var h=c[1];a=n.attrHandle[h]?n.attrHandle[h](a):a[h]!=null?a[h]:a.getAttribute(h);h=a+"";var b=c[2];c=c[4];return a==null?b==="!=":b==="="?h===c:b==="*="?h.indexOf(c)>=0:b==="~="?(" "+h+" ").indexOf(c)>=0:!c?h&&a!==false:b==="!="?h!==c:b==="^="?h.indexOf(c)===0:b==="$="?h.substr(h.length-c.length)===c:b==="|="?h===c||h.substr(0,c.length+1)===c+"-":false},POS:function(a,c,h,b){var f=n.setFilters[c[2]];
if(f)return f(a,h,c,b)}}},l=n.match.POS,e=function(a,c){return"\\"+(c-0+1)};for(var k in n.match){n.match[k]=new RegExp(n.match[k].source+/(?![^\[]*\])(?![^\(]*\))/.source);n.leftMatch[k]=new RegExp(/(^(?:.|\r|\n)*?)/.source+n.match[k].source.replace(/\\(\d+)/g,e))}var o=function(a,c){a=Array.prototype.slice.call(a,0);if(c){c.push.apply(c,a);return c}return a};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(v){o=function(a,c){c=c||[];var h=0;if(t.call(a)==="[object Array]")Array.prototype.push.apply(c,
a);else if(typeof a.length==="number")for(var b=a.length;h<b;h++)c.push(a[h]);else for(;a[h];h++)c.push(a[h]);return c}}var y;if(document.documentElement.compareDocumentPosition)y=function(a,c){if(!a.compareDocumentPosition||!c.compareDocumentPosition){if(a==c)m=true;return a.compareDocumentPosition?-1:1}a=a.compareDocumentPosition(c)&4?-1:a===c?0:1;if(a===0)m=true;return a};else if("sourceIndex"in document.documentElement)y=function(a,c){if(!a.sourceIndex||!c.sourceIndex){if(a==c)m=true;return a.sourceIndex?
-1:1}a=a.sourceIndex-c.sourceIndex;if(a===0)m=true;return a};else if(document.createRange)y=function(a,c){if(!a.ownerDocument||!c.ownerDocument){if(a==c)m=true;return a.ownerDocument?-1:1}var h=a.ownerDocument.createRange(),b=c.ownerDocument.createRange();h.setStart(a,0);h.setEnd(a,0);b.setStart(c,0);b.setEnd(c,0);a=h.compareBoundaryPoints(Range.START_TO_END,b);if(a===0)m=true;return a};d.getText=function(a){for(var c="",h,b=0;a[b];b++){h=a[b];if(h.nodeType===3||h.nodeType===4)c+=h.nodeValue;else if(h.nodeType!==
8)c+=d.getText(h.childNodes)}return c};(function(){var a=document.createElement("div"),c="script"+(new Date).getTime();a.innerHTML="<a name='"+c+"'/>";var h=document.documentElement;h.insertBefore(a,h.firstChild);if(document.getElementById(c)){n.find.ID=function(b,f,i){if(typeof f.getElementById!=="undefined"&&!i)return(f=f.getElementById(b[1]))?f.id===b[1]||typeof f.getAttributeNode!=="undefined"&&f.getAttributeNode("id").nodeValue===b[1]?[f]:undefined:[]};n.filter.ID=function(b,f){var i=typeof b.getAttributeNode!==
"undefined"&&b.getAttributeNode("id");return b.nodeType===1&&i&&i.nodeValue===f}}h.removeChild(a);h=a=null})();(function(){var a=document.createElement("div");a.appendChild(document.createComment(""));if(a.getElementsByTagName("*").length>0)n.find.TAG=function(c,h){h=h.getElementsByTagName(c[1]);if(c[1]==="*"){c=[];for(var b=0;h[b];b++)h[b].nodeType===1&&c.push(h[b]);h=c}return h};a.innerHTML="<a href='#'></a>";if(a.firstChild&&typeof a.firstChild.getAttribute!=="undefined"&&a.firstChild.getAttribute("href")!==
"#")n.attrHandle.href=function(c){return c.getAttribute("href",2)};a=null})();document.querySelectorAll&&function(){var a=d,c=document.createElement("div");c.innerHTML="<p class='TEST'></p>";if(!(c.querySelectorAll&&c.querySelectorAll(".TEST").length===0)){d=function(b,f,i,r){f=f||document;if(!r&&f.nodeType===9&&!d.isXML(f))try{return o(f.querySelectorAll(b),i)}catch(p){}return a(b,f,i,r)};for(var h in a)d[h]=a[h];c=null}}();(function(){var a=document.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";
if(!(!a.getElementsByClassName||a.getElementsByClassName("e").length===0)){a.lastChild.className="e";if(a.getElementsByClassName("e").length!==1){n.order.splice(1,0,"CLASS");n.find.CLASS=function(c,h,b){if(typeof h.getElementsByClassName!=="undefined"&&!b)return h.getElementsByClassName(c[1])};a=null}}})();d.contains=document.compareDocumentPosition?function(a,c){return!!(a.compareDocumentPosition(c)&16)}:function(a,c){return a!==c&&(a.contains?a.contains(c):true)};d.isXML=function(a){return(a=(a?
a.ownerDocument||a:0).documentElement)?a.nodeName!=="HTML":false};var s=function(a,c){var h=[],b="",f;for(c=c.nodeType?[c]:c;f=n.match.PSEUDO.exec(a);){b+=f[0];a=a.replace(n.match.PSEUDO,"")}a=n.relative[a]?a+"*":a;f=0;for(var i=c.length;f<i;f++)d(a,c[f],h);return d.filter(b,h)};KISSY.ExternalSelector=d;KISSY.ExternalSelector._filter=function(a,c){return d.matches(c,KISSY.query(a))}})();
KISSY.add("anim-easing",function(g){var w=Math,q=w.PI,u=w.pow,t=w.sin,m=1.70158,j={easeNone:function(d){return d},easeIn:function(d){return d*d},easeOut:function(d){return(2-d)*d},easeBoth:function(d){return(d*=2)<1?0.5*d*d:0.5*(1- --d*(d-2))},easeInStrong:function(d){return d*d*d*d},easeOutStrong:function(d){return 1- --d*d*d*d},easeBothStrong:function(d){return(d*=2)<1?0.5*d*d*d*d:0.5*(2-(d-=2)*d*d*d)},elasticIn:function(d){if(d===0||d===1)return d;return-(u(2,10*(d-=1))*t((d-0.075)*2*q/0.3))},
elasticOut:function(d){if(d===0||d===1)return d;return u(2,-10*d)*t((d-0.075)*2*q/0.3)+1},elasticBoth:function(d){if(d===0||(d*=2)===2)return d;if(d<1)return-0.5*u(2,10*(d-=1))*t((d-0.1125)*2*q/0.45);return u(2,-10*(d-=1))*t((d-0.1125)*2*q/0.45)*0.5+1},backIn:function(d){if(d===1)d-=0.0010;return d*d*((m+1)*d-m)},backOut:function(d){return(d-=1)*d*((m+1)*d+m)+1},backBoth:function(d){if((d*=2)<1)return 0.5*d*d*(((m*=1.525)+1)*d-m);return 0.5*((d-=2)*d*(((m*=1.525)+1)*d+m)+2)},bounceIn:function(d){return 1-
j.bounceOut(1-d)},bounceOut:function(d){return d<1/2.75?7.5625*d*d:d<2/2.75?7.5625*(d-=1.5/2.75)*d+0.75:d<2.5/2.75?7.5625*(d-=2.25/2.75)*d+0.9375:7.5625*(d-=2.625/2.75)*d+0.984375},bounceBoth:function(d){if(d<0.5)return j.bounceIn(d*2)*0.5;return j.bounceOut(d*2-1)*0.5+0.5}};g.Easing=j});
KISSY.add("anim",function(g,w){function q(s,a,c,h,b){if(s=g.get(s)){if(!(this instanceof q))return new q(s,a,c,h,b);var f=g.isPlainObject(c);a=a;this.domEl=s;if(g.isPlainObject(a))a=g.param(a,";").replace(/=/g,":");this.props=u(a);this.targetStyle=a;if(f)s=g.merge(y,c);else{s=g.clone(y);c&&(s.duration=e(c,10)||1);g.isString(h)&&(h=l[h]);g.isFunction(h)&&(s.easing=h);g.isFunction(b)&&(s.complete=b)}this.config=s;g.isFunction(b)&&this.on(v,b)}}function u(s){var a={},c=o.length,h;k.innerHTML='<div style="'+
s+'"></div>';for(s=k.firstChild.style;c--;)if(h=s[o[c]])a[o[c]]=t(h);return a}function t(s){var a=e(s);s=(s+"").replace(/^[-\d\.]+/,"");return isNaN(a)?{v:s,u:"",f:j}:{v:a,u:s,f:m}}function m(s,a,c){return(s+(a-s)*c).toFixed(3)}function j(s,a,c){for(var h=2,b,f,i=[],r=[];b=3,f=arguments[h-1],h--;)if(d(f,0,4)==="rgb(")for(f=f.match(/\d+/g);b--;)i.push(~~f[b]);else if(d(f,0)==="#"){if(f.length===4)f="#"+d(f,1)+d(f,1)+d(f,2)+d(f,2)+d(f,3)+d(f,3);for(;b--;)i.push(parseInt(d(f,1+b*2,2),16))}else return a;
for(;b--;){h=~~(i[b+3]+(i[b]-i[b+3])*c);r.push(h<0?0:h>255?255:h)}return"rgb("+r.join(",")+")"}function d(s,a,c){return s.substr(a,c||1)}var n=g.DOM,l=g.Easing,e=parseFloat,k=n.create("<div>"),o="backgroundColor borderBottomColor borderBottomWidth borderBottomStyle borderLeftColor borderLeftWidth borderLeftStyle borderRightColor borderRightWidth borderRightStyle borderSpacing borderTopColor borderTopWidth borderTopStyle bottom color font fontFamily fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex".split(" "),
v="complete",y={duration:1,easing:l.easeNone};g.augment(q,g.EventTarget,{run:function(){var s=this,a=s.config,c=s.domEl,h=a.duration*1E3,b=a.easing,f=g.now(),i=f+h,r=s.props,p={},x;for(x in r)p[x]=t(n.css(c,x));if(s.fire("start")!==false){s.stop();s.timer=g.later(a=function(){var C=g.now(),z=C>i?1:(C-f)/h,A,B,D;for(x in r){A=p[x];B=r[x];if(B.v==0)B.u=A.u;if(A.u!==B.u)A.v=0;n.css(c,x,B.f(A.v,B.v,b(z))+B.u)}if(s.fire("step")===false||(D=C>i)){s.stop();D&&s.fire(v)}},13,true);a();return s}},stop:function(s){var a=
this.domEl,c=this.targetStyle;if(this.timer){this.timer.cancel();this.timer=w}if(s){g.UA.ie&&c.indexOf("opacity")>-1&&n.css(a,"opacity",this.props.opacity.v);a.style.cssText+=";"+c;this.fire(v)}return this}});g.Anim=q});KISSY.add("anim-node-plugin",function(g,w){var q=g.Anim;g.each([g.Node.prototype,g.NodeList.prototype],function(u){u.animate=function(){var t=g.makeArray(arguments);g.each(this,function(m){q.apply(w,[m].concat(t)).run()});return this}})});
KISSY.add("datalazyload",function(g,w){function q(e,k){if(!(this instanceof q))return new q(e,k);if(k===w){k=e;e=[j]}g.isArray(e)||(e=[g.get(e)||j]);this.containers=e;this.config=g.merge(l,k);this._init()}var u=g.DOM,t=g.Event,m=window,j=document,d="scroll",n="resize",l={mod:"manual",diff:"default",placeholder:"none"};g.augment(q,{_init:function(){this.threshold=this._getThreshold();this._filterItems();this._getItemsLength()&&this._initLoadEvent()},_filterItems:function(){var e=this.containers,k,
o,v,y=[],s=[];k=0;for(o=e.length;k<o;++k){v=g.query("img",e[k]);y=y.concat(g.filter(v,this._filterImg,this));v=g.query("textarea",e[k]);s=s.concat(g.filter(v,this._filterArea,this))}this.images=y;this.areas=s},_filterImg:function(e){var k=e.getAttribute("data-ks-lazyload"),o=this.threshold,v=this.config.placeholder;if(this.config.mod==="manual"){if(k){if(v!=="none")e.src=v;return true}}else if(u.offset(e).top>o&&!k){u.attr(e,"data-ks-lazyload",e.src);if(v!=="none")e.src=v;else e.removeAttribute("src");
return true}},_filterArea:function(e){return u.hasClass(e,"ks-datalazyload")},_initLoadEvent:function(){function e(){o||(o=g.later(function(){k();o=null},100))}function k(){v._loadItems();if(v._getItemsLength()===0){t.remove(m,d,e);t.remove(m,n,e)}}var o,v=this;t.on(m,d,e);t.on(m,n,function(){v.threshold=v._getThreshold();e()});v._getItemsLength()&&g.ready(function(){k()})},_loadItems:function(){this._loadImgs();this._loadAreas()},_loadImgs:function(){this.images=g.filter(this.images,this._loadImg,
this)},_loadImg:function(e){var k=this.threshold+u.scrollTop();if(u.offset(e).top<=k)this._loadImgSrc(e);else return true},_loadImgSrc:function(e,k){k=k||"data-ks-lazyload";var o=e.getAttribute(k);if(o&&e.src!=o){e.src=o;e.removeAttribute(k)}},_loadAreas:function(){this.areas=g.filter(this.areas,this._loadArea,this)},_loadArea:function(e){var k=u.css(e,"display")==="none";if(u.offset(k?e.parentNode:e).top<=this.threshold+u.scrollTop())this._loadAreaData(e.parentNode,e);else return true},_loadAreaData:function(e,
k){k.style.display="none";k.className="";var o=u.create("<div>");e.insertBefore(o,k);u.html(o,k.value,true)},_getThreshold:function(){var e=this.config.diff,k=u.viewportHeight();return e==="default"?2*k:k+e},_getItemsLength:function(){return this.images.length+this.areas.length},loadCustomLazyData:function(e,k){var o=this,v,y;g.isArray(e)||(e=[g.get(e)]);g.each(e,function(s){switch(k){case "img-src":y=s.nodeName==="IMG"?[s]:g.query("img",s);g.each(y,function(a){o._loadImgSrc(a,"data-ks-lazyload-custom")});
break;default:(v=g.get("textarea",s))&&u.hasClass(v,"ks-datalazyload-custom")&&o._loadAreaData(s,v)}})}});g.mix(q,q.prototype,true,["loadCustomLazyData","_loadImgSrc","_loadAreaData"]);g.DataLazyload=q});
KISSY.add("flash-ua",function(g){function w(){var l;if(navigator.plugins&&navigator.mimeTypes.length)l=(navigator.plugins["Shockwave Flash"]||0).description;else if(window.ActiveXObject)try{l=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(e){}if(l)return q(l)}function q(l){return l.match(/(\d)+/g)}function u(l){var e=g.isString(l)?q(l):l;l=l;if(g.isArray(e))l=parseFloat(e[0]+"."+t(e[1],3)+t(e[2],5));return l||0}function t(l,e){for(var k=(l+"").length;k++<e;)l="0"+
l;return l}var m=g.UA,j,d,n=true;m.fpv=function(l){if(l||n){n=false;j=w();d=u(j)}return j};m.fpvGEQ=function(l,e){n&&m.fpv(e);return!!d&&d>=u(l)}});KISSY.add("flash",function(g){g.Flash={swfs:{},length:0}});
KISSY.add("flash-embed",function(g){function w(l,e,k){var o=u.create("<param>");u.attr(o,{name:e,value:k});l.appendChild(o)}var q=g.UA,u=g.DOM,t=g.Flash,m=/object|embed/i,j=encodeURIComponent,d={wmode:"",allowscriptaccess:"",allownetworking:"",allowfullscreen:"",play:"false",loop:"",menu:"",quality:"",scale:"",salign:"",bgcolor:"",devicefont:"",base:"",swliveconnect:"",seamlesstabbing:""},n={params:{},attrs:{width:215,height:138},version:9};g.mix(t,{fpv:q.fpv,fpvGEQ:q.fpvGEQ,add:function(l,e,k){var o,
v;e=t._normalize(e);e=g.merge(n,e);e.attrs=g.merge(n.attrs,e.attrs);if(l=g.get(l)){if(!l.id)l.id=g.guid("ks-flash-");v=e.attrs.id=l.id;if(q.fpv()){if(!q.fpvGEQ(e.version)){this._callback(k,0,v,l);if(!((o=e.xi)&&g.isString(o)))return;e.src=o}if(m.test(l.nodeName))this._register(l,e,k);else e.src?this._embed(l,e,k):this._callback(k,-3,v,l)}else this._callback(k,-1,v,l)}else this._callback(k,-2)},get:function(l){return t.swfs[l]},remove:function(l){if(l=t.get("#"+l)){u.remove(l);delete t.swfs[l.id];
t.length-=1}},contains:function(l){var e=t.swfs,k,o=false;if(g.isString(l))o=l in e;else for(k in e)if(e[k]===l){o=true;break}return o},_register:function(l,e,k){e=e.attrs.id;l=(u.query("object",l)||[])[0]||l;t._addSWF(e,l);t._callback(k,1,e,l)},_embed:function(l,e,k){var o=t._createSWF(e.src,e.attrs,e.params);if(q.ie)l.outerHTML=o.outerHTML;else l.parentNode.replaceChild(o,l);l=g.get("#"+l.id);t._register(l,e,k)},_callback:function(l,e,k,o){e&&g.isFunction(l)&&l({status:e,id:k,swf:o})},_addSWF:function(l,
e){if(l&&e){t.swfs[l]=e;t.length+=1}},_createSWF:function(l,e,k){var o=u.create("<object>"),v;u.attr(o,e);if(q.ie){u.attr(o,"classid","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000");w(o,"movie",l)}else u.attr(o,{type:"application/x-shockwave-flash",data:l,name:e.id});for(v in k)v in d&&w(o,v,k[v]);k.flashvars&&w(o,"flashvars",t.toFlashVars(k.flashvars));return o},_normalize:function(l){var e,k,o,v=l;if(g.isPlainObject(l)){v={};for(o in l){e=o.toLowerCase();k=l[o];if(e!=="flashvars")k=t._normalize(k);
v[e]=k}}return v},toFlashVars:function(l){if(!g.isPlainObject(l))return"";var e,k,o=[];for(e in l){k=l[e];if(g.isString(k))k=j(k);else{k=g.JSON.stringify(k);if(!k)continue;k=k.replace(/:"([^"]+)/g,function(v,y){return':"'+j(y)})}o.push(e+"="+k)}return o.join("&").replace(/"/g,"'")}})});
KISSY.add("switchable",function(g,w){function q(m,j){j=j||{};if(!("markupType"in j))if(j.panelCls)j.markupType=1;else if(j.panels)j.markupType=2;j=g.merge(q.Config,j);this.container=g.get(m);this.config=j;this.activeIndex=j.activeIndex;this._init()}var u=g.DOM,t=g.Event;q.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:true,triggerType:"mouse",delay:0.1,activeIndex:0,
activeTriggerCls:"ks-active",steps:1,viewSize:[]};q.Plugins=[];g.augment(q,g.EventTarget,{_init:function(){var m=this,j=m.config;if(m.fire("beforeInit")!==false){m._parseMarkup();j.hasTriggers&&m._bindTriggers();g.each(q.Plugins,function(d){d.init&&d.init(m)});m.fire("init")}},_parseMarkup:function(){var m=this.container,j=this.config,d,n=[],l=[];switch(j.markupType){case 0:if(d=g.get("."+j.navCls,m))n=u.children(d);d=g.get("."+j.contentCls,m);l=u.children(d);break;case 1:n=g.query("."+j.triggerCls,
m);l=g.query("."+j.panelCls,m);break;case 2:n=j.triggers;l=j.panels;break}m=l.length;this.length=m/j.steps;if(j.hasTriggers&&m>0&&n.length===0)n=this._generateTriggersMarkup(this.length);this.triggers=g.makeArray(n);this.panels=g.makeArray(l);this.content=d||l[0].parentNode},_generateTriggersMarkup:function(m){var j=this.config,d=u.create("<ul>"),n,l;d.className=j.navCls;for(l=0;l<m;l++){n=u.create("<li>");if(l===this.activeIndex)n.className=j.activeTriggerCls;n.innerHTML=l+1;d.appendChild(n)}this.container.appendChild(d);
return u.children(d)},_bindTriggers:function(){var m=this,j=m.config,d=m.triggers,n,l,e=d.length;for(l=0;l<e;l++)(function(k){n=d[k];t.on(n,"click focus",function(){m._onFocusTrigger(k)});if(j.triggerType==="mouse"){t.on(n,"mouseenter",function(){m._onMouseEnterTrigger(k)});t.on(n,"mouseleave",function(){m._onMouseLeaveTrigger(k)})}})(l)},_onFocusTrigger:function(m){if(this._triggerIsValid()){this._cancelSwitchTimer();this.switchTo(m)}},_onMouseEnterTrigger:function(m){var j=this;if(j._triggerIsValid())j.switchTimer=
g.later(function(){j.switchTo(m)},j.config.delay*1E3)},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_triggerIsValid:function(m){return this.activeIndex!==m},_cancelSwitchTimer:function(){if(this.switchTimer){this.switchTimer.cancel();this.switchTimer=w}},switchTo:function(m,j){var d=this.config,n=this.triggers,l=this.panels,e=this.activeIndex,k=d.steps,o=e*k,v=m*k;if(!this._triggerIsValid())return this;if(this.fire("beforeSwitch",{toIndex:m})===false)return this;if(d.hasTriggers)this._switchTrigger(e>
-1?n[e]:null,n[m]);if(j===w)j=m>e?"forward":"backward";this._switchView(l.slice(o,o+k),l.slice(v,v+k),m,j);this.activeIndex=m;return this},_switchTrigger:function(m,j){var d=this.config.activeTriggerCls;m&&u.removeClass(m,d);u.addClass(j,d)},_switchView:function(m,j,d){u.css(m,"display","none");u.css(j,"display","block");this._fireOnSwitch(d)},_fireOnSwitch:function(m){this.fire("switch",{currentIndex:m})},prev:function(){var m=this.activeIndex;this.switchTo(m>0?m-1:this.length-1,"backward")},next:function(){var m=
this.activeIndex;this.switchTo(m<this.length-1?m+1:0,"forward")}});g.Switchable=q});
KISSY.add("switchable-autoplay",function(g,w){var q=g.Event,u=g.Switchable;g.mix(u.Config,{autoplay:false,interval:5,pauseOnHover:true});u.Plugins.push({name:"autoplay",init:function(t){function m(){n=g.later(function(){t.paused||t.switchTo(t.activeIndex<t.length-1?t.activeIndex+1:0,"forward")},d,true)}var j=t.config,d=j.interval*1E3,n;if(j.autoplay){if(j.pauseOnHover){q.on(t.container,"mouseenter",function(){if(n){n.cancel();n=w}t.paused=true});q.on(t.container,"mouseleave",function(){t.paused=false;
m()})}m()}}})});
KISSY.add("switchable-effect",function(g,w){var q=g.DOM,u=g.Anim,t=g.Switchable,m;g.mix(t.Config,{effect:"none",duration:0.5,easing:"easeNone"});t.Effects={none:function(j,d,n){q.css(j,"display","none");q.css(d,"display","block");n()},fade:function(j,d,n){j.length!==1&&g.error("fade effect only supports steps == 1.");var l=this,e=l.config,k=j[0],o=d[0];l.anim&&l.anim.stop(true);q.css(o,"opacity",1);l.anim=(new u(k,{opacity:0},e.duration,e.easing,function(){l.anim=w;q.css(o,"z-index",9);q.css(k,"z-index",
1);n()})).run()},scroll:function(j,d,n,l){var e=this;j=e.config;d=j.effect==="scrollx";var k={};k[d?"left":"top"]=-(e.viewSize[d?0:1]*l)+"px";e.anim&&e.anim.stop();e.anim=(new u(e.content,k,j.duration,j.easing,function(){e.anim=w;n()})).run()}};m=t.Effects;m.scrollx=m.scrolly=m.scroll;t.Plugins.push({name:"effect",init:function(j){var d=j.config,n=d.effect,l=j.panels,e=j.content,k=d.steps,o=j.activeIndex,v=l.length;j.viewSize=[d.viewSize[0]||l[0].offsetWidth*k,d.viewSize[1]||l[0].offsetHeight*k];
if(n!=="none"){g.each(l,function(c){q.css(c,"display","block")});switch(n){case "scrollx":case "scrolly":q.css(e,"position","absolute");q.css(e.parentNode,"position","relative");if(n==="scrollx"){q.css(l,"float","left");q.width(e,j.viewSize[0]*(v/k))}break;case "fade":var y=o*k,s=y+k-1,a;g.each(l,function(c,h){a=h>=y&&h<=s;q.css(c,{opacity:a?1:0,position:"absolute",zIndex:a?9:1})});break}}}});g.augment(t,{_switchView:function(j,d,n,l){var e=this,k=e.config.effect;(g.isFunction(k)?k:m[k]).call(e,j,
d,function(){e._fireOnSwitch(n)},n,l)}})});
KISSY.add("switchable-circular",function(g,w){function q(a,c,h,b,f){var i=this;a=i.config;c=i.length;var r=i.activeIndex,p=a.scrollType===y,x=p?n:l,C=i.viewSize[p?0:1];p=-C*b;var z={},A,B=f===v;if(A=B&&r===0&&b===c-1||f===o&&r===c-1&&b===0)p=u.call(i,i.panels,b,B,x,C);z[x]=p+k;i.anim&&i.anim.stop();i.anim=(new g.Anim(i.content,z,a.duration,a.easing,function(){A&&t.call(i,i.panels,b,B,x,C);i.anim=w;h()})).run()}function u(a,c,h,b,f){var i=this.config.steps;c=this.length;var r=h?c-1:0,p=(r+1)*i;for(i=
r*i;i<p;i++){m.css(a[i],j,d);m.css(a[i],b,(h?-1:1)*f*c)}return h?f:-f*c}function t(a,c,h,b,f){var i=this.config.steps;c=this.length;var r=h?c-1:0,p=(r+1)*i;for(i=r*i;i<p;i++){m.css(a[i],j,e);m.css(a[i],b,e)}m.css(this.content,b,h?-f*(c-1):e)}var m=g.DOM,j="position",d="relative",n="left",l="top",e="",k="px",o="forward",v="backward",y="scrollx",s=g.Switchable;g.mix(s.Config,{circular:false});s.Plugins.push({name:"circular",init:function(a){a=a.config;if(a.circular&&(a.effect===y||a.effect==="scrolly")){a.scrollType=
a.effect;a.effect=q}}})});
KISSY.add("switchable-lazyload",function(g){var w=g.DOM,q="beforeSwitch",u="img-src",t="area-data",m={},j=g.Switchable;m[u]="data-ks-lazyload-custom";m[t]="ks-datalazyload-custom";g.mix(j.Config,{lazyDataType:t});j.Plugins.push({name:"lazyload",init:function(d){function n(y){var s=k.steps;y=y.toIndex*s;e.loadCustomLazyData(d.panels.slice(y,y+s),o);l()&&d.detach(q,n)}function l(){var y,s,a,c=o===u;if(y=c?"img":o===t?"textarea":""){y=g.query(y,d.container);s=0;for(a=y.length;s<a;s++)if(c?w.attr(y[s],
v):w.hasClass(y[s],v))return false}return true}var e=g.DataLazyload,k=d.config,o=k.lazyDataType,v=m[o];!e||!o||!v||d.on(q,n)}})});KISSY.add("switchable-autorender",function(g){g.Switchable.autoRender=function(w,q,u){q="."+(q||"KS_");u=u||"data-ks-switchable";g.each(["Switchable","Tabs","Slide","Carousel","Accordion"],function(t){g.each(g.query(q+t,w),function(m){try{var j=m.getAttribute(u);if(j)j=j.replace(/'/g,'"');new g[t](m,g.JSON.parse(j))}catch(d){g.log("Switchable.autoRender: "+d,"warn")}})})}});
KISSY.add("tabs",function(g){function w(q,u){if(!(this instanceof w))return new w(q,u);w.superclass.constructor.call(this,q,u)}g.extend(w,g.Switchable);g.Tabs=w});KISSY.add("slide",function(g){function w(u,t){if(!(this instanceof w))return new w(u,t);w.superclass.constructor.call(this,u,g.merge(q,t))}var q={autoplay:true,circular:true};g.extend(w,g.Switchable);g.Slide=w});
KISSY.add("carousel",function(g,w){function q(e,k){var o=this;if(!(o instanceof q))return new q(e,k);o.on("init",function(){u(o)});q.superclass.constructor.call(o,e,g.merge(l,k))}function u(e){var k=e.config,o=k.disableBtnCls;g.each(["prev","next"],function(v){var y=e[v+"Btn"]=g.get(j+k[v+"BtnCls"],e.container);m.on(y,"click",function(s){s.preventDefault();t.hasClass(y,o)||e[v]()})});k.circular||e.on("switch",function(v){v=v.currentIndex;v=v===0?e[d]:v===e.length-1?e[n]:w;t.removeClass([e[d],e[n]],
o);v&&t.addClass(v,o)});m.on(e.panels,"click focus",function(){e.fire("itemSelected",{item:this})})}var t=g.DOM,m=g.Event,j=".",d="prevBtn",n="nextBtn",l={circular:true,prevBtnCls:"ks-switchable-prev-btn",nextBtnCls:"ks-switchable-next-btn",disableBtnCls:"ks-switchable-disable-btn"};g.extend(q,g.Switchable);g.Carousel=q});
KISSY.add("accordion",function(g){function w(t,m){if(!(this instanceof w))return new w(t,m);w.superclass.constructor.call(this,t,g.merge(u,m))}var q=g.DOM,u={markupType:1,triggerType:"click",multiple:false};g.extend(w,g.Switchable);g.Accordion=w;g.augment(w,{_triggerIsValid:function(t){return this.activeIndex!==t||this.config.multiple},_switchView:function(t,m,j){var d=this.config,n=m[0];if(d.multiple){q.toggleClass(this.triggers[j],d.activeTriggerCls);q.css(n,"display",n.style.display=="none"?"block":
"none");this._fireOnSwitch(j)}else w.superclass._switchView.call(this,t,m,j)}})});
KISSY.add("suggest",function(g,w){function q(b,f,i){if(!(this instanceof q))return new q(b,f,i);this.textInput=g.get(b);f+=f.indexOf("?")===-1?"?":"&";this.dataSource=f+"code=utf-8&callback="+v;this.config=g.merge(h,i);this.queryParams=this.query=y;this._dataCache={};this._init()}function u(b){b.style.visibility=y}function t(b){b.style.visibility=s}function m(b,f){if(f.nodeType===1){j.html(b,y);b.appendChild(f)}else j.html(b,f)}var j=g.DOM,d=g.Event,n=window,l=document,e,k=g.get("head"),o=g.UA.ie,
v="g_ks_suggest_callback",y="",s="hidden",a=parseInt,c=/^(input|button|a)$/i,h={containerCls:y,resultFormat:"%result%",closeBtnText:"\u5173\u95ed",shim:o===6,submitOnSelect:true};g.augment(q,g.EventTarget,{_init:function(){e=l.body;this._initTextInput();this._initContainer();this.config.shim&&this._initShim();this._initStyle();this._initEvent()},_initTextInput:function(){var b=this,f=b.textInput,i=false,r=0;j.attr(f,"autocomplete","off");b.config.autoFocus&&f.focus();d.on(f,"keydown",function(p){p=
p.keyCode;if(p===27){b.hide();f.value=b.query}else if(p>32&&p<41)if(f.value){if(p===40||p===38)if(r++===0){b._isRunning&&b.stop();i=true;b._selectItem(p===40)}else if(r==3)r=0}else f.blur();else if(p===13){f.blur();if(i)if(f.value==b._getSelectedItemKey())if(b.fire("itemSelect")===false)return;b._submitForm()}else{b._isRunning||b.start();i=false}});d.on(f,"keyup",function(){r=0});d.on(f,"blur",function(){b.stop();g.later(function(){b._focusing||b.hide()},0)})},_initContainer:function(){var b=j.create("<div>",
{"class":"ks-suggest-container "+this.config.containerCls,style:"position:absolute;visibility:hidden"}),f=j.create("<div>",{"class":"ks-suggest-content"}),i=j.create("<div>",{"class":"ks-suggest-footer"});b.appendChild(f);b.appendChild(i);e.insertBefore(b,e.firstChild);this.container=b;this.content=f;this.footer=i;this._initContainerEvent()},_setContainerRegion:function(){var b=this.textInput,f=j.offset(b),i=this.container;j.offset(i,{left:f.left,top:f.top+b.offsetHeight-1});j.width(i,this.config.containerWidth||
b.offsetWidth-2)},_initContainerEvent:function(){var b=this,f=b.textInput,i=b.container,r=b.content,p=b.footer,x,C;d.on(r,"mousemove",function(z){z=z.target;if(z.nodeName!=="LI")z=j.parent(z,"li");if(j.contains(r,z))if(z!==b.selectedItem){b._removeSelectedItem();b._setSelectedItem(z)}});d.on(r,"mousedown",function(z){z=z.target;if(z.nodeName!=="LI")z=j.parent(z,"li");x=z});d.on(i,"mousedown",function(z){if(!c.test(z.target.nodeName)){f.onbeforedeactivate=function(){n.event.returnValue=false;f.onbeforedeactivate=
null};z.preventDefault()}});d.on(r,"mouseup",function(z){var A=z.target;if(!(z.which>2)){if(A.nodeName!=="LI")A=j.parent(A,"li");if(A==x)if(j.contains(r,A)){b._updateInputFromSelectItem(A);if(b.fire("itemSelect")!==false){f.blur();b._submitForm()}}}});d.on(p,"focusin",function(){b._focusing=true;b._removeSelectedItem();C=false});d.on(p,"focusout",function(){b._focusing=false;g.later(function(){if(C)b.hide();else b._focusing||b.textInput.focus()},0)});d.on(b.container,"mouseleave",function(){C=true});
d.on(p,"click",function(z){j.hasClass(z.target,"ks-suggest-closebtn")&&b.hide()})},_submitForm:function(){if(this.config.submitOnSelect){var b=this.textInput.form;if(b)if(this.fire("beforeSubmit",{form:b})!==false){if(l.createEvent){var f=l.createEvent("MouseEvents");f.initEvent("submit",true,false);b.dispatchEvent(f)}else l.createEventObject&&b.fireEvent("onsubmit");b.submit()}}},_initShim:function(){var b=j.create("<iframe>",{src:"about:blank","class":"ks-suggest-shim",style:"position:absolute;visibility:hidden;border:none"});
this.container.shim=b;e.insertBefore(b,e.firstChild)},_setShimRegion:function(){var b=this.container,f=b.style,i=b.shim;i&&j.css(i,{left:a(f.left)-2,top:f.top,width:a(f.width)+2,height:j.height(b)-2})},_initStyle:function(){g.get("#ks-suggest-style")||j.addStyleSheet(".ks-suggest-container{background:white;border:1px solid #999;z-index:99999}.ks-suggest-shim{z-index:99998}.ks-suggest-container li{color:#404040;padding:1px 0 2px;font-size:12px;line-height:18px;float:left;width:100%}.ks-suggest-container .ks-selected{background-color:#39F;cursor:default}.ks-suggest-key{float:left;text-align:left;padding-left:5px}.ks-suggest-result{float:right;text-align:right;padding-right:5px;color:green}.ks-suggest-container .ks-selected span{color:#FFF;cursor:default}.ks-suggest-footer{padding:0 5px 5px}.ks-suggest-closebtn{float:right}.ks-suggest-container li,.ks-suggest-footer{overflow:hidden;zoom:1;clear:both}.ks-suggest-container{*margin-left:2px;_margin-left:-2px;_margin-top:-3px}",
"ks-suggest-style")},_initEvent:function(){var b=this;d.on(n,"resize",function(){b._setContainerRegion();b._setShimRegion()})},start:function(){var b=this;if(b.fire("beforeStart")!==false){q.focusInstance=b;b._timer=g.later(function(){b._updateContent();b._timer=g.later(arguments.callee,200)},200);b._isRunning=true}},stop:function(){q.focusInstance=w;this._timer&&this._timer.cancel();this._isRunning=false},show:function(){if(!this.isVisible()){var b=this.container,f=b.shim;this._setContainerRegion();
u(b);if(f){this._setShimRegion();u(f)}}},hide:function(){if(this.isVisible()){var b=this.container,f=b.shim;f&&t(f);t(b)}},isVisible:function(){return this.container.style.visibility!=s},_updateContent:function(){var b=this.textInput;if(b.value!=this.query){b=this.query=b.value;if(g.trim(b))if(this._dataCache[b]!==w){this._fillContainer(this._dataCache[b]);this._displayContainer()}else this._requestData();else{this._fillContainer();this.hide()}}},_requestData:function(){var b=this,f;if(!o)b.dataScript=
w;if(!b.dataScript){f=l.createElement("script");f.charset="utf-8";f.async=true;k.insertBefore(f,k.firstChild);b.dataScript=f;if(!o){var i=g.now();b._latestScriptTime=i;j.attr(f,"data-time",i);d.on(f,"load",function(){b._scriptDataIsOut=j.attr(f,"data-time")!=b._latestScriptTime})}}b.queryParams="q="+encodeURIComponent(b.query);if(b.fire("beforeDataRequest")!==false)b.dataScript.src=b.dataSource+"&"+b.queryParams},_handleResponse:function(b){var f=y,i,r,p,x;if(!this._scriptDataIsOut){this.returnedData=
b;if(this.fire("dataReturn",{data:b})!==false){b=this._formatData(this.returnedData);if((i=b.length)>0){r=j.create("<ol>");for(f=0;f<i;++f){p=b[f];p=this._formatItem(x=p.key,p.result);j.attr(p,"key",x);j.addClass(p,f%2?"ks-even":"ks-odd");r.appendChild(p)}f=r}this._fillContainer(f);if(this.fire("beforeShow")!==false){this._dataCache[this.query]=j.html(this.content);this._displayContainer()}}}},_formatData:function(b){var f=[],i,r,p,x=0;if(!b)return f;if(g.isArray(b.result))b=b.result;if(!(i=b.length))return f;
for(p=0;p<i;++p){r=b[p];if(g.isString(r))f[x++]={key:r};else if(g.isArray(r)&&r.length>1)f[x++]={key:r[0],result:r[1]}}return f},_formatItem:function(b,f){var i=j.create("<li>"),r=j.create("<span>",{"class":"ks-suggest-key"});j.html(r,b);i.appendChild(r);if(f){b=this.config.resultFormat.replace("%result%",f);if(g.trim(b)){f=j.create("<span>",{"class":"ks-suggest-result"});j.html(f,b);i.appendChild(f)}}return i},_fillContainer:function(b,f){this._fillContent(b||y);this._fillFooter(f||y)},_fillContent:function(b){m(this.content,
b);this.selectedItem=w},_fillFooter:function(b){var f=this.config,i=this.footer;m(i,b);if(f.closeBtn){b=j.create("<a>",{"class":"ks-suggest-closebtn",href:"javascript: void(0)",target:"_self"});j.html(b,f.closeBtnText);i.appendChild(b)}this.fire("updateFooter",{footer:i,query:this.query});j.css(i,"display",j.text(i)?y:"none")},_displayContainer:function(){g.trim(j.text(this.container))?this.show():this.hide()},_selectItem:function(b){var f=g.query("li",this.container);if(f.length!==0)if(this.isVisible()){if(this.selectedItem){b=
j[b?"next":"prev"](this.selectedItem);if(!b)this.textInput.value=this.query}else b=f[b?0:f.length-1];this._removeSelectedItem();if(b){this._setSelectedItem(b);this._updateInputFromSelectItem()}}else this.show()},_removeSelectedItem:function(){j.removeClass(this.selectedItem,"ks-selected");this.selectedItem=w},_setSelectedItem:function(b){j.addClass(b,"ks-selected");this.selectedItem=b;this.textInput.focus()},_getSelectedItemKey:function(){if(!this.selectedItem)return y;return j.attr(this.selectedItem,
"key")},_updateInputFromSelectItem:function(){this.textInput.value=this._getSelectedItemKey(this.selectedItem)||this.query}});n[v]=function(b){q.focusInstance&&g.later(function(){q.focusInstance._handleResponse(b)},0)};q.version=1.1;g.Suggest=q});
