/*
Copyright 2010, KISSY UI Library v1.0.5
MIT Licensed
build: 542 Apr 8 23:12
*/
KISSY.add("cookie",function(e){function m(p){return typeof p==="string"&&p!==""}var n=document,j=encodeURIComponent,q=decodeURIComponent;e.Cookie={get:function(p){var f;if(m(p))if(p=n.cookie.match("(?:^| )"+p+"(?:(?:=([^;]*))|;|$)"))f=p[1]?q(p[1]):"";return f},set:function(p,f,c,h,k,g){f=j(f);var a=c;if(typeof a==="number"){a=new Date;a.setTime(a.getTime()+c*864E5)}if(a instanceof Date)f+="; expires="+a.toUTCString();if(m(h))f+="; domain="+h;if(m(k))f+="; path="+k;if(g)f+="; secure";n.cookie=p+"="+
f},remove:function(p){this.set(p,"",0)}}});
KISSY.add("json",function(e){function m(g){return g<10?"0"+g:g}function n(g){p.lastIndex=0;return p.test(g)?'"'+g.replace(p,function(a){var b=h[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+g+'"'}function j(g,a){var b,d,i=f,l,o=a[g];if(o&&typeof o==="object"&&typeof o.toJSON==="function")o=o.toJSON(g);if(typeof k==="function")o=k.call(a,g,o);switch(typeof o){case "string":return n(o);case "number":return isFinite(o)?String(o):"null";case "boolean":case "null":return String(o);
case "object":if(!o)return"null";f+=c;l=[];if(Object.prototype.toString.apply(o)==="[object Array]"){d=o.length;for(g=0;g<d;g+=1)l[g]=j(g,o)||"null";a=l.length===0?"[]":f?"[\n"+f+l.join(",\n"+f)+"\n"+i+"]":"["+l.join(",")+"]";f=i;return a}if(k&&typeof k==="object"){d=k.length;for(g=0;g<d;g+=1){b=k[g];if(typeof b==="string")if(a=j(b,o))l.push(n(b)+(f?": ":":")+a)}}else for(b in o)if(Object.hasOwnProperty.call(o,b))if(a=j(b,o))l.push(n(b)+(f?": ":":")+a);a=l.length===0?"{}":f?"{\n"+f+l.join(",\n"+f)+
"\n"+i+"}":"{"+l.join(",")+"}";f=i;return a}}e=e.JSON=window.JSON;if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+m(this.getUTCMonth()+1)+"-"+m(this.getUTCDate())+"T"+m(this.getUTCHours())+":"+m(this.getUTCMinutes())+":"+m(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var q=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
p=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,c,h={"":"\\b","\t":"\\t","\n":"\\n","":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;if(typeof e.stringify!=="function")e.stringify=function(g,a,b){var d;c=f="";if(typeof b==="number")for(d=0;d<b;d+=1)c+=" ";else if(typeof b==="string")c=b;if((k=a)&&typeof a!=="function"&&(typeof a!=="object"||typeof a.length!=="number"))throw new Error("JSON.stringify");return j("",{"":g})};
if(typeof e.parse!=="function")e.parse=function(g,a){function b(d,i){var l,o,s=d[i];if(s&&typeof s==="object")for(l in s)if(Object.hasOwnProperty.call(s,l)){o=b(s,l);if(o!==undefined)s[l]=o;else delete s[l]}return a.call(d,i,s)}g=String(g);q.lastIndex=0;if(q.test(g))g=g.replace(q,function(d){return"\\u"+("0000"+d.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(g.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){g=eval("("+g+")");return typeof a==="function"?b({"":g},""):g}throw new SyntaxError("JSON.parse");}});
KISSY.add("ajax",function(e){var m=document,n=e.UA;e.Ajax={request:function(){e.error("not implemented")},getScript:function(j,q,p){var f=m.getElementsByTagName("head")[0]||m.documentElement,c=m.createElement("script");c.src=j;if(p)c.charset=p;c.async=true;if(e.isFunction(q))if(n.ie)c.onreadystatechange=function(){var h=c.readyState;if(h==="loaded"||h==="complete"){c.onreadystatechange=null;q()}};else c.onload=q;f.appendChild(c)}}});
KISSY.add("swf-ua",function(e){function m(f){var c=f[0]+".";switch(f[2].toString().length){case 1:c+="00";break;case 2:c+="0";break}return c+f[2]}e=e.UA;var n=0,j;if(e.ie){try{j=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");j.AllowScriptAccess="always"}catch(q){if(j!==null)n=6}if(n===0)try{n=m((new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").replace(/[A-Za-z\s]+/g,"").split(","))}catch(p){}}else if(j=navigator.mimeTypes["application/x-shockwave-flash"])if(j=j.enabledPlugin)n=
m(j.description.replace(/\s[rd]/g,".").replace(/[a-z\s]+/ig,"").split("."));e.flash=parseFloat(n)});
KISSY.add("swf",function(e){function m(g,a,b){var d="ks-swf-"+j++,i=parseFloat(b.version)||q;i=n.flash>=i;var l=n.flash>=8&&b.useExpressInstall&&!i,o=l?c:a;a="YUISwfId="+d+"&YUIBridgeCallback="+h;var s="<object ";this.id=d;m.instances[d]=this;if((g=e.get(g))&&(i||l)&&o){s+='id="'+d+'" ';s+=n.ie?'classid="'+p+'" ':'type="'+f+'" data="'+o+'" ';s+='width="100%" height="100%">';if(n.ie)s+='<param name="movie" value="'+o+'"/>';for(var r in b.fixedAttributes)if(k.hasOwnProperty(r))s+='<param name="'+r+
'" value="'+b.fixedAttributes[r]+'"/>';for(var u in b.flashVars){r=b.flashVars[u];if(typeof r==="string")a+="&"+u+"="+encodeURIComponent(r)}s+='<param name="flashVars" value="'+a+'"/>';s+="</object>";g.innerHTML=s;this.swf=e.get("#"+d)}}var n=e.UA,j=e.now(),q=10.22,p="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000",f="application/x-shockwave-flash",c="http://fpdownload.macromedia.com/pub/flashplayer/update/current/swf/autoUpdater.swf?"+j,h="KISSY.SWF.eventHandler",k={align:"",allowNetworking:"",allowScriptAccess:"",
base:"",bgcolor:"",menu:"",name:"",quality:"",salign:"",scale:"",tabindex:"",wmode:""};m.instances=(e.SWF||{}).instances||{};m.eventHandler=function(g,a){m.instances[g]._eventHandler(a)};e.augment(m,e.EventTarget);e.augment(m,{_eventHandler:function(g){var a=g.type;if(a==="log")e.log(g.message);else a&&this.fire(a,g)},callSWF:function(g,a){if(this.swf[g])return this.swf[g].apply(this.swf,a||[])}});e.SWF=m});
KISSY.add("swfstore",function(e,m){function n(c,h,k,g){var a="other",b=q.get(p),d=this;k=(k!==m?k:true)+"";g=(g!==m?g:true)+"";if(j.ie)a="ie";else if(j.gecko)a="gecko";else if(j.webkit)a="webkit";else if(j.opera)a="opera";if(!b||b==="null")q.set(p,b=Math.round(Math.random()*Math.PI*1E5));d.embeddedSWF=new e.SWF(c,h||"swfstore.swf",{version:9.115,useExpressInstall:false,fixedAttributes:{allowScriptAccess:"always",allowNetworking:"all",scale:"noScale"},flashVars:{allowedDomain:f.location.hostname,shareData:k,
browser:b,useCompression:g}});d.embeddedSWF._eventHandler=function(i){e.SWF.prototype._eventHandler.call(d,i)}}var j=e.UA,q=e.Cookie,p="swfstore",f=document;e.augment(n,e.EventTarget);e.augment(n,{setItem:function(c,h){h=typeof h==="string"?h.replace(/\\/g,"\\\\"):e.JSON.stringify(h)+"";if(c=e.trim(c+""))try{return this.embeddedSWF.callSWF("setItem",[c,h])}catch(k){this.fire("error",{message:k})}}});e.each(["getValueAt","getNameAt","getTypeAt","getValueOf","getTypeOf","getItems","getLength","removeItem",
"removeItemAt","clear","getShareData","setShareData","getUseCompression","setUseCompression","calculateCurrentSize","hasAdequateDimensions","setSize","getModificationDate","displaySettings"],function(c){n.prototype[c]=function(){try{return this.embeddedSWF.callSWF(c,e.makeArray(arguments))}catch(h){this.fire("error",{message:h})}}});e.SWFStore=n});
KISSY.add("datalazyload",function(e,m){function n(a,b){if(!(this instanceof n))return new n(a,b);if(b===m){b=a;a=[c]}e.isArray(a)||(a=[e.get(a)||c]);this.containers=a;this.config=e.merge(k,b||{});this.callbacks={els:[],fns:[]};this._init()}var j=e.DOM,q=e.Event,p=YAHOO.util.Dom,f=window,c=document,h={AUTO:"auto",MANUAL:"manual"},k={mod:h.MANUAL,diff:"default",placeholder:"http://a.tbcdn.cn/kissy/1.0.4/build/datalazyload/dot.gif"},g=n.prototype;e.mix(g,{_init:function(){this.threshold=this._getThreshold();
this._filterItems();this._getItemsLength()&&this._initLoadEvent()},_initLoadEvent:function(){function a(){d||(d=setTimeout(function(){b();d=null},100))}function b(){i._loadItems();if(i._getItemsLength()===0){q.remove(f,"scroll",a);q.remove(f,"resize",a)}}var d,i=this;q.on(f,"scroll",a);q.on(f,"resize",function(){i.threshold=i._getThreshold();a()});i._getItemsLength()&&e.ready(function(){b()})},_filterItems:function(){var a=this.containers,b=this.threshold,d=this.config.placeholder,i=this.config.mod===
h.MANUAL,l,o,s,r,u,t,v,w=[],x=[];l=0;for(o=a.length;l<o;++l){s=e.query("img",a[l]);r=0;for(u=s.length;r<u;++r){t=s[r];v=t.getAttribute("data-lazyload-src");if(i){if(v){t.src=d;w.push(t)}}else if(p.getY(t)>b&&!v){t.setAttribute("data-lazyload-src",t.src);t.src=d;w.push(t)}}s=e.query("textarea",a[l]);r=0;for(u=s.length;r<u;++r){t=s[r];j.hasClass(t,"ks-datalazyload")&&x.push(t)}}this.images=w;this.areaes=x},_loadItems:function(){this._loadImgs();this._loadAreaes();this._fireCallbacks()},_loadImgs:function(){var a=
this.images,b=this.threshold+p.getDocumentScrollTop(),d,i,l=[];for(d=0;i=a[d++];)p.getY(i)<=b?this._loadImgSrc(i):l.push(i);this.images=l},_loadImgSrc:function(a,b){b=b||"data-lazyload-src";var d=a.getAttribute(b);if(d&&a.src!=d){a.src=d;a.removeAttribute(b)}},_loadAreaes:function(){var a=this.areaes,b=this.threshold+p.getDocumentScrollTop(),d,i,l,o=[];for(d=0;i=a[d++];){l=i;if(p.getY(l)===m)l=i.parentNode;p.getY(l)<=b?this._loadDataFromArea(i.parentNode,i):o.push(i)}this.areaes=o},_loadDataFromArea:function(a,
b){var d=j.create(b.value);b.style.display="none";b.className="";a.insertBefore(d,b);e.UA.gecko||e.query("script",d).each(function(i){e.globalEval(i.text)})},_fireCallbacks:function(){var a=this.callbacks,b=a.els,d=a.fns,i=this.threshold+p.getDocumentScrollTop(),l,o,s,r=[],u=[];for(l=0;(o=b[l])&&(s=d[l++]);)if(p.getY(o)<=i)s.call(o);else{r.push(o);u.push(s)}a.els=r;a.fns=u},addCallback:function(a,b){if((a=e.get(a))&&typeof b==="function"){this.callbacks.els.push(a);this.callbacks.fns.push(b)}},_getThreshold:function(){var a=
this.config.diff,b=p.getViewportHeight();return a==="default"?2*b:b+a},_getItemsLength:function(){return this.images.length+this.areaes.length+this.callbacks.els.length},loadCustomLazyData:function(a,b,d){var i=this,l,o;e.isArray(a)||(a=[e.get(a)]);e.each(a,function(s){switch(b){case "textarea-data":if((l=e.get("textarea",s))&&j.hasClass(l,d||"ks-datalazyload-custom"))i._loadDataFromArea(s,l);break;default:o=s.nodeName==="IMG"?[s]:e.query("img",s);s=0;for(var r=o.length;s<r;s++)i._loadImgSrc(o[s],
d||"data-lazyload-src-custom")}})}});e.mix(n,g,true,["loadCustomLazyData","_loadImgSrc","_loadDataFromArea"]);e.DataLazyload=n});
KISSY.add("suggest",function(e,m){function n(a,b,d){if(!(this instanceof n))return new n(a,b,d);this.textInput=e.get(a);this.dataSource=b;this.JSONDataSource=e.isPlainObject(b)?b:null;this.returnedData=null;this.config=e.merge(g,d||{});this.container=null;this.queryParams=this.query="";this._timer=null;this._isRunning=false;this.dataScript=null;this._dataCache={};this._latestScriptTime="";this._onKeyboardSelecting=this._scriptDataIsOut=false;this.selectedItem=null;this._init()}var j=YAHOO.util.Dom,
q=e.DOM,p=e.Event,f=window,c=document,h=c.getElementsByTagName("head")[0],k=YAHOO.env.ua.ie,g={containerCls:"",containerWidth:"auto",resultFormat:"约%result%条结果",showCloseBtn:false,closeBtnText:"关闭",useShim:k===6,timerDelay:200,autoFocus:false,submitFormOnClickSelect:true};e.mix(n.prototype,{_init:function(){this._initTextInput();this._initContainer();this.config.useShim&&this._initShim();this._initStyle();this._initResizeEvent()},_initTextInput:function(){var a=this;a.textInput.setAttribute("autocomplete",
"off");p.on(a.textInput,"blur",function(){a.stop();a.hide()});a.config.autoFocus&&a.textInput.focus();var b=0;p.on(a.textInput,"keydown",function(d){d=d.keyCode;switch(d){case 27:a.hide();a.textInput.value=a.query;a.query.length===0&&a.textInput.blur();break;case 13:a.textInput.blur();a._onKeyboardSelecting&&a.textInput.value==a._getSelectedItemKey()&&a.fire("itemSelect");a._submitForm();break;case 40:case 38:if(b++==0){a._isRunning&&a.stop();a._onKeyboardSelecting=true;a.selectItem(d===40)}else if(b==
3)b=0;break}if(d!=40&&d!=38){a._isRunning||a.start();a._onKeyboardSelecting=false}});p.on(a.textInput,"keyup",function(){b=0})},_initContainer:function(){var a=c.createElement("div"),b=this.config.containerCls;a.className="ks-suggest-container";if(b)a.className+=" "+b;a.style.position="absolute";a.style.visibility="hidden";this.container=a;this._setContainerRegion();this._initContainerEvent();c.body.insertBefore(a,c.body.firstChild)},_setContainerRegion:function(){var a=j.getRegion(this.textInput),
b=a.left,d=a.right-b-2;d=d>0?d:0;if(c.documentMode===7&&(k===7||k===8))b-=2;else e.UA.gecko&&b++;this.container.style.left=b+"px";this.container.style.top=a.bottom+"px";this.container.style.width=this.config.containerWidth=="auto"?d+"px":this.config.containerWidth},_initContainerEvent:function(){var a=this;p.on(a.container,"mousemove",function(d){d=d.target;if(d.nodeName!="LI")d=j.getAncestorByTagName(d,"li");if(j.isAncestor(a.container,d))if(d!=a.selectedItem){a._removeSelectedItem();a._setSelectedItem(d)}});
var b=null;a.container.onmousedown=function(d){b=d.target;a.textInput.onbeforedeactivate=function(){f.event.returnValue=false;a.textInput.onbeforedeactivate=null};return false};p.on(a.container,"mouseup",function(d){if(a._isInContainer([d.pageX,d.pageY])){d=d.target;if(d==b)if(d.className=="ks-suggest-close-btn")a.hide();else{if(d.nodeName!="LI")d=j.getAncestorByTagName(d,"li");if(j.isAncestor(a.container,d)){a._updateInputFromSelectItem(d);a.fire("itemSelect");a.textInput.blur();a._submitForm()}}}})},
_submitForm:function(){if(this.config.submitFormOnClickSelect){var a=this.textInput.form;if(a){if(c.createEvent){var b=c.createEvent("MouseEvents");b.initEvent("submit",true,false);a.dispatchEvent(b)}else c.createEventObject&&a.fireEvent("onsubmit");a.submit()}}},_isInContainer:function(a){var b=j.getRegion(this.container);return a[0]>=b.left&&a[0]<=b.right&&a[1]>=b.top&&a[1]<=b.bottom},_initShim:function(){var a=c.createElement("iframe");a.src="about:blank";a.className="ks-suggest-shim";a.style.position=
"absolute";a.style.visibility="hidden";a.style.border="none";this.container.shim=a;this._setShimRegion();c.body.insertBefore(a,c.body.firstChild)},_setShimRegion:function(){var a=this.container,b=a.shim;if(b){b.style.left=parseInt(a.style.left)-2+"px";b.style.top=a.style.top;b.style.width=parseInt(a.style.width)+2+"px"}},_initStyle:function(){var a=e.get("#ks-suggest-style");if(!a){a=c.createElement("style");a.id="ks-suggest-style";h.appendChild(a);if(a.styleSheet)a.styleSheet.cssText=".ks-suggest-container{background:white;border:1px solid #999;z-index:99999}.ks-suggest-shim{z-index:99998}.ks-suggest-container li{color:#404040;padding:1px 0 2px;font-size:12px;line-height:18px;float:left;width:100%}.ks-suggest-container li.selected{background-color:#39F;cursor:default}.ks-suggest-key{float:left;text-align:left;padding-left:5px}.ks-suggest-result{float:right;text-align:right;padding-right:5px;color:green}.ks-suggest-container li.selected span{color:#FFF;cursor:default}.ks-suggest-bottom{padding:0 5px 5px}.ks-suggest-close-btn{float:right}.ks-suggest-container li,.suggest-bottom{overflow:hidden;zoom:1;clear:both}.ks-suggest-container{*margin-left:2px;_margin-left:-2px;_margin-top:-3px}";
else a.appendChild(c.createTextNode(".ks-suggest-container{background:white;border:1px solid #999;z-index:99999}.ks-suggest-shim{z-index:99998}.ks-suggest-container li{color:#404040;padding:1px 0 2px;font-size:12px;line-height:18px;float:left;width:100%}.ks-suggest-container li.selected{background-color:#39F;cursor:default}.ks-suggest-key{float:left;text-align:left;padding-left:5px}.ks-suggest-result{float:right;text-align:right;padding-right:5px;color:green}.ks-suggest-container li.selected span{color:#FFF;cursor:default}.ks-suggest-bottom{padding:0 5px 5px}.ks-suggest-close-btn{float:right}.ks-suggest-container li,.suggest-bottom{overflow:hidden;zoom:1;clear:both}.ks-suggest-container{*margin-left:2px;_margin-left:-2px;_margin-top:-3px}"))}},
_initResizeEvent:function(){var a=this,b;p.on(f,"resize",function(){b&&clearTimeout(b);b=setTimeout(function(){a._setContainerRegion();a._setShimRegion()},50)})},start:function(){var a=this;n.focusInstance=a;a._timer=setTimeout(function(){a.updateContent();a._timer=setTimeout(arguments.callee,a.config.timerDelay)},a.config.timerDelay);a._isRunning=true},stop:function(){n.focusInstance=null;clearTimeout(this._timer);this._isRunning=false},show:function(){if(!this.isVisible()){var a=this.container,
b=a.shim;a.style.visibility="";if(b){if(!b.style.height){a=j.getRegion(a);b.style.height=a.bottom-a.top-2+"px"}b.style.visibility=""}}},hide:function(){if(this.isVisible()){var a=this.container,b=a.shim;if(b)b.style.visibility="hidden";a.style.visibility="hidden"}},isVisible:function(){return this.container.style.visibility!="hidden"},updateContent:function(){if(this._needUpdate()){this._updateQueryValueFromInput();var a=this.query;if(e.trim(a).length)if(this._dataCache[a]!==m){this.returnedData=
"using cache";this._fillContainer(this._dataCache[a]);this._displayContainer()}else this.JSONDataSource?this.handleResponse(this.JSONDataSource[a]):this.requestData();else{this._fillContainer("");this.hide()}}},_needUpdate:function(){return this.textInput.value!=this.query},requestData:function(){var a=this;if(!k)a.dataScript=null;if(!a.dataScript){var b=c.createElement("script");b.charset="utf-8";h.insertBefore(b,h.firstChild);a.dataScript=b;if(!k){var d=(new Date).getTime();a._latestScriptTime=
d;b.setAttribute("time",d);p.on(b,"load",function(){a._scriptDataIsOut=b.getAttribute("time")!=a._latestScriptTime})}}a.queryParams="q="+encodeURIComponent(a.query)+"&code=utf-8&callback=g_ks_suggest_callback";a.fire("dataRequest");a.dataScript.src=a.dataSource+"?"+a.queryParams},handleResponse:function(a){if(!this._scriptDataIsOut){this.returnedData=a;this.fire("dataReturn");this.returnedData=this.formatData(this.returnedData);var b="";a=this.returnedData.length;if(a>0){b=c.createElement("ol");for(var d=
0;d<a;++d){var i=this.returnedData[d],l=this.formatItem(i.key,i.result);l.setAttribute("key",i.key);q.addClass(l,d%2?"even":"odd");b.appendChild(l)}b=b}this._fillContainer(b);a>0&&this.appendBottom();e.trim(this.container.innerHTML)&&this.fire("show");this._dataCache[this.query]=this.container.innerHTML;this._displayContainer()}},formatData:function(a){var b=[];if(!a)return b;if(e.isArray(a.result))a=a.result;var d=a.length;if(!d)return b;for(var i,l=0;l<d;++l){i=a[l];b[l]=typeof i==="string"?{key:i}:
e.isArray(i)&&i.length>=2?{key:i[0],result:i[1]}:i}return b},formatItem:function(a,b){var d=c.createElement("li"),i=c.createElement("span");i.className="ks-suggest-key";i.appendChild(c.createTextNode(a));d.appendChild(i);if(b!==m){a=this.config.resultFormat.replace("%result%",b);if(e.trim(a)){b=c.createElement("span");b.className="ks-suggest-result";b.appendChild(c.createTextNode(a));d.appendChild(b)}}return d},appendBottom:function(){var a=c.createElement("div");a.className="ks-suggest-bottom";if(this.config.showCloseBtn){var b=
c.createElement("a");b.href="javascript: void(0)";b.setAttribute("target","_self");b.className="ks-suggest-close-btn";b.appendChild(c.createTextNode(this.config.closeBtnText));a.appendChild(b)}e.trim(a.innerHTML)&&this.container.appendChild(a)},_fillContainer:function(a){if(a.nodeType==1){this.container.innerHTML="";this.container.appendChild(a)}else this.container.innerHTML=a;this.selectedItem=null},_displayContainer:function(){e.trim(this.container.innerHTML)?this.show():this.hide()},selectItem:function(a){var b=
this.container.getElementsByTagName("li");if(b.length!=0)if(this.isVisible()){if(this.selectedItem){a=j[a?"getNextSibling":"getPreviousSibling"](this.selectedItem);if(!a)this.textInput.value=this.query}else a=b[a?0:b.length-1];this._removeSelectedItem();if(a){this._setSelectedItem(a);this._updateInputFromSelectItem()}}else this.show()},_removeSelectedItem:function(){q.removeClass(this.selectedItem,"selected");this.selectedItem=null},_setSelectedItem:function(a){q.addClass(a,"selected");this.selectedItem=
a},_getSelectedItemKey:function(){if(!this.selectedItem)return"";return this.selectedItem.getAttribute("key")},_updateQueryValueFromInput:function(){this.query=this.textInput.value},_updateInputFromSelectItem:function(){this.textInput.value=this._getSelectedItemKey(this.selectedItem)}});e.mix(n.prototype,e.EventTarget);f.g_ks_suggest_callback=function(a){n.focusInstance&&setTimeout(function(){n.focusInstance.handleResponse(a)},0)};e.Suggest=n});
KISSY.add("switchable",function(e,m){function n(c,h){h=h||{};if(!("markupType"in h))if(h.panelCls)h.markupType=1;else if(h.panels)h.markupType=2;h=e.merge(n.Config,h);this.container=e.get(c);this.config=h;this.triggers=this.triggers||[];this.panels=this.panels||[];if(this.activeIndex===m)this.activeIndex=h.activeIndex;this._init()}var j=e.DOM,q=e.Event,p=document,f=n.prototype;n.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",panelCls:"ks-switchable-panel",
triggers:[],panels:[],hasTriggers:true,triggerType:"mouse",delay:0.1,activeIndex:0,activeTriggerCls:"active",steps:1,viewSize:[]};n.Plugins=[];e.mix(f,{_init:function(){var c=this,h=c.config;c.panels.length===0&&c._parseMarkup();h.hasTriggers&&c._bindTriggers();e.each(n.Plugins,function(k){k.init&&k.init(c)})},_parseMarkup:function(){var c=this.container,h=this.config,k=h.hasTriggers,g,a=[],b=[];switch(h.markupType){case 0:if(g=e.get("."+h.navCls,c))a=j.children(g);g=e.get("."+h.contentCls,c);b=j.children(g);
break;case 1:a=e.query("."+h.triggerCls,c);b=e.query("."+h.panelCls,c);break;case 2:a=h.triggers;b=h.panels;break}c=b.length;this.length=c/h.steps;if(k&&c>0&&a.length===0)a=this._generateTriggersMarkup(this.length);this.triggers=e.makeArray(a);this.panels=e.makeArray(b);this.content=g||b[0].parentNode},_generateTriggersMarkup:function(c){var h=this.config,k=p.createElement("UL"),g,a;k.className=h.navCls;for(a=0;a<c;a++){g=p.createElement("LI");if(a===this.activeIndex)g.className=h.activeTriggerCls;
g.innerHTML=a+1;k.appendChild(g)}this.container.appendChild(k);return j.children(k)},_bindTriggers:function(){var c=this,h=c.config,k=c.triggers,g,a,b=k.length;for(a=0;a<b;a++)(function(d){g=k[d];q.on(g,"click focus",function(){c._onFocusTrigger(d)});if(h.triggerType==="mouse"){q.on(g,"mouseenter",function(){c._onMouseEnterTrigger(d)});q.on(g,"mouseleave",function(){c._onMouseLeaveTrigger(d)})}})(a)},_onFocusTrigger:function(c){if(this.activeIndex!==c){this.switchTimer&&this.switchTimer.cancel();
this.switchTo(c)}},_onMouseEnterTrigger:function(c){var h=this;if(h.activeIndex!==c)h.switchTimer=e.later(function(){h.switchTo(c)},h.config.delay*1E3)},_onMouseLeaveTrigger:function(){this.switchTimer&&this.switchTimer.cancel()},switchTo:function(c,h){var k=this.config,g=this.triggers,a=this.panels,b=this.activeIndex,d=k.steps,i=b*d,l=c*d;if(c===b)return this;if(this.fire("beforeSwitch",{toIndex:c})===false)return this;if(k.hasTriggers)this._switchTrigger(b>-1?g[b]:null,g[c]);if(h===m)h=c>b?"forward":
"forward";this._switchView(a.slice(i,i+d),a.slice(l,l+d),c,h);this.activeIndex=c;return this},_switchTrigger:function(c,h){var k=this.config.activeTriggerCls;c&&j.removeClass(c,k);j.addClass(h,k)},_switchView:function(c,h){j.css(c,"display","none");j.css(h,"display","block");this.fire("switch")},prev:function(){var c=this.activeIndex;this.switchTo(c>0?c-1:this.length-1,"backward")},next:function(){var c=this.activeIndex;this.switchTo(c<this.length-1?c+1:0,"forward")}});e.mix(f,e.EventTarget);e.Switchable=
n});
KISSY.add("switchable-autoplay",function(e){var m=e.Event,n=e.Switchable;e.mix(n.Config,{autoplay:false,interval:5,pauseOnHover:true});n.Plugins.push({name:"autoplay",init:function(j){var q=j.config;if(q.autoplay){if(q.pauseOnHover){m.on(j.container,"mouseenter",function(){j.paused=true});m.on(j.container,"mouseleave",function(){setTimeout(function(){j.paused=false},q.interval*1E3)})}j.autoplayTimer=e.later(function(){j.paused||j.switchTo(j.activeIndex<j.length-1?j.activeIndex+1:0)},q.interval*1E3,
true)}}})});
KISSY.add("switchable-effect",function(e){var m=YAHOO.util,n=e.DOM,j=m.Dom,q=e.Switchable,p;e.mix(q.Config,{effect:"none",duration:0.5,easing:m.Easing.easeNone});q.Effects={none:function(f,c,h){n.css(f,"display","none");n.css(c,"display","block");h()},fade:function(f,c,h){f.length!==1&&e.error("fade effect only supports steps == 1.");var k=this,g=k.config,a=f[0],b=c[0];k.anim&&k.anim.stop();j.setStyle(b,"opacity",1);k.anim=new m.Anim(a,{opacity:{to:0}},g.duration,g.easing);k.anim.onComplete.subscribe(function(){k.anim=null;
j.setStyle(b,"z-index",9);j.setStyle(a,"z-index",1);h()});k.anim.animate()},scroll:function(f,c,h,k){var g=this;f=g.config;c=f.effect==="scrollx";var a={};a[c?"left":"top"]={to:-(g.viewSize[c?0:1]*k)};g.anim&&g.anim.stop();g.anim=new m.Anim(g.content,a,f.duration,f.easing);g.anim.onComplete.subscribe(function(){g.anim=null;h()});g.anim.animate()}};p=q.Effects;p.scrollx=p.scrolly=p.scroll;q.Plugins.push({name:"effect",init:function(f){var c=f.config,h=c.effect,k=f.panels,g=c.steps,a=f.activeIndex*
g,b=a+g-1,d=k.length;f.viewSize=[c.viewSize[0]||k[0].offsetWidth*g,c.viewSize[0]||k[0].offsetHeight*g];if(h!=="none"){for(c=0;c<d;c++)k[c].style.display="block";switch(h){case "scrollx":case "scrolly":f.content.style.position="absolute";f.content.parentNode.style.position="relative";if(h==="scrollx"){j.setStyle(k,"float","left");f.content.style.width=f.viewSize[0]*(d/g)+"px"}break;case "fade":for(c=0;c<d;c++){j.setStyle(k[c],"opacity",c>=a&&c<=b?1:0);k[c].style.position="absolute";k[c].style.zIndex=
c>=a&&c<=b?9:1}break}}}});e.mix(q.prototype,{_switchView:function(f,c,h,k){var g=this,a=g.config.effect;(e.isFunction(a)?a:p[a]).call(g,f,c,function(){g.fire("switch")},h,k)}})});
KISSY.add("switchable-circular",function(e){function m(d,i,l,o,s){var r=this;d=r.config;i=r.length;var u=r.activeIndex,t=d.scrollType===a,v=t?p:f,w=r.viewSize[t?0:1];t=-w*o;var x={},z,y=s===g;if(z=y&&u===0&&o===i-1||s===k&&u===i-1&&o===0)t=n.call(r,r.panels,o,y,v,w);x[v]={to:t};r.anim&&r.anim.stop();r.anim=new YAHOO.util.Anim(r.content,x,d.duration,d.easing);r.anim.onComplete.subscribe(function(){z&&j.call(r,r.panels,o,y,v,w);r.anim=null;l()});r.anim.animate()}function n(d,i,l,o,s){var r=this.config.steps;
i=this.length;var u=l?i-1:0,t=(u+1)*r;for(r=u*r;r<t;r++){d[r].style.position=q;d[r].style[o]=(l?"-":h)+s*i+c}return l?s:-s*i}function j(d,i,l,o,s){var r=this.config.steps;i=this.length;var u=l?i-1:0,t=(u+1)*r;for(r=u*r;r<t;r++){d[r].style.position=h;d[r].style[o]=h}this.content.style[o]=l?-s*(i-1)+c:h}var q="relative",p="left",f="top",c="px",h="",k="forward",g="backward",a="scrollx",b=e.Switchable;e.mix(b.Config,{circular:false});b.Plugins.push({name:"circular",init:function(d){d=d.config;if(d.circular&&
(d.effect===a||d.effect==="scrolly")){d.scrollType=d.effect;d.effect=m}}})});
KISSY.add("switchable-lazyload",function(e){var m=e.DOM,n="beforeSwitch",j="img-src",q="textarea-data",p={},f=e.Switchable,c=e.DataLazyload;p[j]="data-lazyload-src-custom";p[q]="ks-datalazyload-custom";e.mix(f.Config,{lazyDataType:"",lazyDataFlag:""});f.Plugins.push({name:"autoplay",init:function(h){function k(i){var l=a.steps;i=i.toIndex*l;c.loadCustomLazyData(h.panels.slice(i,i+l),b,d);g()&&h.detach(n,k)}function g(){var i,l,o;if(b===j){i=e.query("img",h.container);l=0;for(o=i.length;l<o;l++)if(m.attr(i[l],
d))return false}else if(b===q){i=e.query("textarea",h.container);l=0;for(o=i.length;l<o;l++)if(m.hasClass(i[l],d))return false}return true}var a=h.config,b=a.lazyDataType,d=a.lazyDataFlag||p[b];!c||!b||!d||h.on(n,k)}})});KISSY.add("tabs",function(e){function m(n,j){if(!(this instanceof m))return new m(n,j);m.superclass.constructor.call(this,n,j)}e.extend(m,e.Switchable);e.Tabs=m});
KISSY.add("slide",function(e){function m(j,q){if(!(this instanceof m))return new m(j,q);q=e.merge(n,q||{});m.superclass.constructor.call(this,j,q)}var n={autoplay:true,circular:true};e.extend(m,e.Switchable);e.Slide=m});KISSY.add("carousel",function(e){function m(j,q){if(!(this instanceof m))return new m(j,q);q=e.merge(n,q||{});m.superclass.constructor.call(this,j,q)}var n={circular:true};e.extend(m,e.Switchable);e.Carousel=m});
KISSY.add("coversflow",function(e){function m(f,c){if(!(this instanceof m))return new m(f,c);c=e.merge(p,c||{});m.superclass.constructor.call(this,f,c);this._initFlow()}var n=YAHOO.util.Dom,j=e.DOM,q=e.Event,p={flowLength:4,aspectRatio:1.964,step:150,width:500,height:350,offset:0,animSpeed:50,autoSwitchToMiddle:true,hasTriggers:false,circular:true};e.extend(m,e.Switchable);e.augment(m,{_initFlow:function(){var f=this,c=f.config;f.busy=false;f.curFrame=0;f.targetFrame=0;f.zIndex=f.length;f.region=
n.getRegion(f.container);f.maxFocus=c.flowLength*c.step;f.maxHeight=f.region.height+Math.round(f.region.height/c.aspectRatio);f.middleLine=f.region.width/2;f.triggers=f.panels;f.on("beforeSwitch",function(h){h=h.toIndex;f.perIndex=h;f.targetFrame=-h*f.config.step;return!f.busy});c.autoSwitchToMiddle?f.switchTo(Math.floor(f.length/2)):f._frame(0)},_switchView:function(){var f=this.config;if(this.targetFrame<this.curFrame-1||this.targetFrame>this.curFrame+1){this._frame(this.curFrame+(this.targetFrame-
this.curFrame)/3);this._timer=e.later(this._switchView,f.animSpeed,false,this);this.busy=true}else{this.fire("finished");this.busy=false}},_frame:function(f){var c=this,h=c.config,k=c.panels,g=c.region,a=c.middleLine-h.offset,b,d;c.curFrame=f;var i=0;for(k=k.length;i<k;i++){b=c.panels[i];d=i*-h.step;if(d+c.maxFocus<c.targetFrame||d-c.maxFocus>c.targetFrame)j.css(b,"visibility","hidden");else{d=Math.sqrt(1E4+f*f)+100;var l=f/d*a+a,o=h.width/h.height*90/d*a,s=0;if(o>c.maxHeight)o=c.maxHeight;s=h.width/
h.height*o;j.css(b,"left",l-72/d*a+"px");if(o&&s){j.css(b,"height",o+"px");j.css(b,"width",s+"px");j.css(b,"top",g.height/2-o/2+"px")}j.css(b,"zIndex",c.zIndex*100-Math.ceil(d));j.css(b,"visibility","visible");(function(r){q.remove(b);c.perIndex===r?q.add(b,"click",function(){return c.fire("onCurrent",{panel:b,index:r})}):q.add(b,"click",function(u){u.preventDefault();c.switchTo(r)})})(i)}c.fire("tween",{panel:b,index:i});f+=h.step}}});e.CoversFlow=m});
