/*
Copyright 2012, KISSY UI Library v1.30dev
MIT Licensed
build time: May 10 19:30
*/
KISSY.add("htmlparser/Parser",function(a,c,h,m,b,i,k,l){function g(d,f){this.originalHtml=d=a.trim(d);d=/^(<!doctype|<html|<body)/i.test(d)?"<document>"+d+"</document>":"<body>"+d+"</body>";this.lexer=new i(d);this.opts=f||{}}function j(d){var f=n(d,"body",3);if(f){var d=f.parentNode,e=d.childNodes,g=a.indexOf(f,e);if(g!=e.length-1){e=e.slice(g+1,e.length);for(g=0;g<e.length;g++)d.removeChild(e[g]),"body"==e[g].tagName?a.each(e[g].childNodes,function(d){f.appendChild(d)}):f.appendChild(e[g])}}return f}
function f(f){var e=f.childNodes,g,n,b=c.p,a=0;for(n=0;n<e.length;n++)if(g=e[n],3==g.nodeType||1==g.nodeType&&b[g.nodeName]){a=1;break}if(a){var a=[],i=new h;i.nodeName=i.tagName="p";for(n=0;n<e.length;n++)g=e[n],3==g.nodeType||1==g.nodeType&&b[g.nodeName]?i.appendChild(g):(i.childNodes.length&&(a.push(i),i=i.clone()),a.push(g));i.childNodes.length&&a.push(i);f.empty();for(n=0;n<a.length;n++)f.appendChild(a[n])}}function n(f,e,g){if(0===g)return 0;a.isNumber(g)&&g--;var i=f.childNodes;if(i)for(var b=
0;b<i.length;b++){if(i[b].tagName===e)return i[b];if(f=n(i[b],e,g))return f}return 0}function e(f){for(var e=[].concat(f.childNodes),g=0;g<e.length;g++)if("html"==e[g].nodeName){for(var n=e[g],i=0;i<g;i++)3==e[i].nodeType&&!a.trim(e[i].toHtml())&&f.removeChild(e[i]);for(;n.firstChild&&3==n.firstChild.nodeType&&!a.trim(n.firstChild.toHtml());)n.removeChild(n.firstChild);break}}g.prototype={elements:function(){var d,g,n=this.lexer,i=this.opts;g=d=n.nextNode();"document"!=d.tagName&&(g=new k,g.appendChild(d));
g.nodeType=9;l.getScanner("div").scan(d,n,i);(d=j(g))&&i.autoParagraph&&f(d);e(g);var i=this.originalHtml,b=new m;g=/^(<!doctype|<html|<body)/i.test(i)?g.childNodes:d.childNodes;a.each(g,function(f){b.appendChild(f)});return b},parse:function(){return this.elements()}};return g},{requires:"./dtd,./nodes/Tag,./nodes/Fragment,./lexer/Cursor,./lexer/Lexer,./nodes/Document,./Scanner".split(",")});
KISSY.add("htmlparser/Scanner",function(a,c,h){return{getScanner:function(a){return h[a]||c}}},{requires:["./scanners/TagScanner","./scanners/SpecialScanners","./scanners/QuoteCdataScanner","./scanners/TextareaScanner"]});
KISSY.add("htmlparser/Utils",function(){return{collapseWhitespace:function(a){return a.replace(/[\s\xa0]+/g," ")},isLetter:function(a){return"a"<=a&&"z">=a||"A"<=a&&"Z">=a},isValidAttributeNameStartChar:function(a){return!this.isWhitespace(a)&&'"'!=a&&"'"!=a&&">"!=a&&"<"!=a&&"/"!=a&&"="!=a},isWhitespace:function(a){return/^[\s\xa0]$/.test(a)}}});
KISSY.add("htmlparser/dtd",function(a){var a=a.merge,c={isindex:1,fieldset:1},h={input:1,button:1,select:1,textarea:1,label:1},m=a({a:1},h),b=a({iframe:1},m),i={hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1},k={ins:1,del:1,script:1,style:1},l=a({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1},k),g=a({sub:1,img:1,object:1,sup:1,
basefont:1,map:1,applet:1,font:1,big:1,small:1},l),j=a({p:1},g),h=a({iframe:1},g,h),g={img:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,
address:1,q:1,pre:1,p:1,em:1,dfn:1},f=a({a:1},h),n={tr:1},e={"#":1},d=a({param:1},g),q=a({form:1},c,b,i,j),t={li:1},p={base:1,link:1,meta:1,title:1},o=a(p,{style:1,script:1}),s={head:1,body:1},r={address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1},a={$nonBodyContent:a({html:1},s,p),$block:r,$blockLimit:{body:1,div:1,td:1,th:1,caption:1,form:1},$inline:f,$body:a({script:1,style:1},r),$cdata:{script:1,
style:1},$empty:{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1},$listItem:{dd:1,dt:1,li:1},$list:{ul:1,ol:1,dl:1},$nonEditable:{applet:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,script:1,textarea:1,param:1},$removeEmpty:{abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},$tabIndex:{a:1,area:1,button:1,input:1,object:1,select:1,textarea:1},
$tableContent:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},html:s,head:o,style:e,body:q,base:{},link:{},meta:{},title:e,col:{},tr:{td:1,th:1},img:{},colgroup:{col:1},noscript:q,td:q,br:{},th:q,center:q,kbd:f,button:a(j,i),basefont:{},h5:f,h4:f,samp:f,h6:f,ol:t,h1:f,h3:f,option:e,h2:f,form:a(c,b,i,j),select:{optgroup:1,option:1},font:f,ins:f,menu:t,abbr:f,label:f,table:{thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1},code:f,script:e,tfoot:n,cite:f,li:q,input:{},iframe:q,
strong:f,textarea:e,noframes:q,big:f,small:f,span:f,hr:{},dt:f,sub:f,optgroup:{option:1},param:{},bdo:f,"var":f,div:q,object:d,sup:f,dd:q,strike:f,area:{},dir:t,map:a({area:1,form:1,p:1},c,k,i),applet:d,dl:{dt:1,dd:1},del:f,isindex:{},fieldset:a({legend:1},g),thead:n,ul:t,acronym:f,b:f,a:h,blockquote:q,caption:f,i:f,u:f,tbody:n,s:f,address:a(b,j),tt:f,legend:f,q:f,pre:a(l,m),p:f,em:f,dfn:f},m="article,figure,nav,aside,section,footer".split(","),u;for(u in a)for(var v in a[u])if("div"==v)for(c=0;c<
m.length;c++)a[u][m[c]]=a[u][v];for(c=0;c<m.length;c++)a[m[c]]=a.div;a.$empty["!doctype"]=1;return a});KISSY.add("htmlparser",function(a,c,h,m,b,i,k,l,g,j,f,n,e){return{CData:g,Comment:j,Node:f,Tag:n,Text:e,Lexer:h,Parser:m,BasicWriter:b,BeautifyWriter:i,MinifyWriter:k,Filter:l,DTD:c}},{requires:"htmlparser/dtd,htmlparser/lexer/Lexer,htmlparser/Parser,htmlparser/writer/basic,htmlparser/writer/beautify,htmlparser/writer/minify,htmlparser/writer/filter,htmlparser/nodes/CData,htmlparser/nodes/Comment,htmlparser/nodes/Node,htmlparser/nodes/Tag,htmlparser/nodes/Text".split(",")});
KISSY.add("htmlparser/lexer/Cursor",function(){function a(a){this.position=a||0}a.prototype={advance:function(){this.position++},retreat:function(){this.position=Math.max(--this.position,0)}};return a});
KISSY.add("htmlparser/lexer/Index",function(){function a(){this.lineCursors=[]}function c(a,b){for(var i=0;i<a.length;i++)if(a[i].position===b.position)return i;return-1}function h(a,b){for(var i=0;i<a.length&&!(a[i].position>b.position);i++);return i}a.prototype={add:function(a){-1==c(this.lineCursors,a)&&this.lineCursors.splice(h(this.lineCursors,a),0,a)},remove:function(a){var b=this.lineCursors,a=c(this.lineCursors,a);-1!=a&&b.splice(a,1)},row:function(a){return h(this.lineCursors,a)-1},col:function(a){var b=
h(this.lineCursors,a)-1;return a.position-this.lineCursors[b]}};return a});
KISSY.add("htmlparser/lexer/Lexer",function(a,c,h,m,b,i,k,l,g){function j(f){this.page=new h(f);this.cursor=new c;this.nodeFactory=this}j.prototype={setPosition:function(f){this.cursor.position=f},getPosition:function(){return this.cursor.position},nextNode:function(f){var g,e,d=this.cursor,a=this.page;g=d.position;e=a.getChar(d);switch(e){case -1:f=null;break;case "<":e=a.getChar(d);-1==e?f=this.makeString(g,d.position):"/"==e||i.isLetter(e)?(a.ungetChar(d),f=this.parseTag(g)):"!"==e||"?"==e?(e=
a.getChar(d),-1==e?f=this.makeString(g,d.position):">"==e?f=this.makeComment(g,d.position):(a.ungetChar(d),"-"==e?f=this.parseComment(g,f):(a.ungetChar(d),f=this.parseTag(g)))):(a.ungetChar(d),f=this.parseString(g,f));break;default:a.ungetChar(d),f=this.parseString(g,f)}return f},makeComment:function(f,g){var e;e=g-f;if(0!=e){if(2>e)return this.makeString(f,g);e=this.nodeFactory.createCommentNode(this.page,f,g)}else e=null;return e},makeString:function(f,g){var e=null;0<g-f&&(e=this.nodeFactory.createStringNode(this.page,
f,g));return e},makeCData:function(f,g){var e=null;0<g-f&&(e=this.nodeFactory.createCDataNode(this.page,f,g));return e},makeTag:function(f,g,e){var d;d=g-f;if(0!=d){if(2>d)return this.makeString(f,g);f=this.nodeFactory.createTagNode(this.page,f,g,e)}else f=null;return f},createTagNode:function(f,g,e,d){return new l(f,g,e,d)},createStringNode:function(f,g,e){return new m(f,g,e)},createCDataNode:function(f,g,e){return new b(f,g,e)},createCommentNode:function(f,a,e){return new g(f,a,e)},parseTag:function(f){var g,
e=[],d=[],a,b=this.page,j=0,c=this.cursor;for(e[0]=c.position;!g;)switch(e[j+1]=c.position,a=b.getChar(c),j){case 0:if(-1==a||">"==a||"<"==a)"<"==a&&(b.ungetChar(c),e[j+1]=c.position),g=!0;else if("/"==a||i.isValidAttributeNameStartChar(a))j=1;break;case 1:-1==a||">"==a||"<"==a?("<"==a&&(b.ungetChar(c),e[j+1]=c.getPosition),this.standalone(d,e),g=!0):i.isWhitespace(a)?(e[6]=e[2],j=6):"="==a&&(j=2);break;case 2:-1==a||">"==a?(this.standalone(d,e),g=!0):"'"==a?(j=4,e[4]=e[3]):'"'==a?(j=5,e[5]=e[3]):
i.isWhitespace(a)||(j=3);break;case 3:-1==a||">"==a?(this.naked(d,e),g=!0):i.isWhitespace(a)&&(this.naked(d,e),e[0]=e[4],j=0);break;case 4:-1==a?(this.single_quote(d,e),g=!0):"'"==a&&(this.single_quote(d,e),e[0]=e[5]+1,j=0);break;case 5:-1==a?(this.double_quote(d,e),g=!0):'"'==a&&(this.double_quote(d,e),e[0]=e[6]+1,j=0);break;case 6:-1==a?(this.standalone(d,e),e[0]=e[6],b.ungetChar(c),j=0):i.isWhitespace(a)||("="==a?(e[2]=e[6],e[3]=e[7],j=2):(this.standalone(d,e),e[0]=e[6],b.ungetChar(c),j=0));break;
default:throw Error("how ** did we get in state "+j);}return this.makeTag(f,c.position,d)},parseComment:function(g,a){var e,d,b=this.page,j=this.cursor,c;e=!1;for(c=0;!e;)if(d=b.getChar(j),-1==d)e=!0;else switch(c){case 0:">"==d&&(e=!0);if("-"==d)c=1;else return this.parseString(g,a);break;case 1:if("-"==d)d=b.getChar(j),-1==d?e=!0:">"==d?e=!0:(b.ungetChar(j),c=2);else return this.parseString(g,a);break;case 2:if("-"==d)c=3;else if(-1==d)return this.parseString(g,a);break;case 3:c="-"==d?4:2;break;
case 4:">"==d?e=!0:i.isWhitespace(d)||(c=2);break;default:throw Error("how ** did we get in state "+c);}return this.makeComment(g,j.position)},parseString:function(g,a){for(var e=0,d,b=this.page,j=this.cursor,c=0;!e;)if(d=b.getChar(j),-1==d)e=1;else if(a&&0==c&&("'"==d||'"'==d))c=d;else if(a&&0!=c&&"\\"==d)d=b.getChar(j),-1!=d&&"\\"!=d&&d!=c&&b.ungetChar(j);else if(a&&d==c)c=0;else if(a&&0==c&&"/"==d)if(d=b.getChar(j),-1==d)e=1;else if("/"==d){do d=b.getChar(j);while(-1!=d&&"\n"!=d)}else if("*"==
d){do{do d=b.getChar(j);while(-1!=d&&"*"!=d);d=b.getChar(j);"*"==d&&b.ungetChar(j)}while(-1!=d&&"/"!=d)}else b.ungetChar(j);else if(0==c&&"<"==d)if(d=b.getChar(j),-1==d)e=1;else{if("/"==d||i.isLetter(d)||"!"==d||"?"==d)e=1,b.ungetChar(j);b.ungetChar(j)}return this.makeString(g,j.position)},parseCDATA:function(g,a){var e,d,b,j,c,m,h=this.cursor,k=this.page;e=h.position;d=0;b=!1;j="";for(m=!1;!b;)switch(c=k.getChar(h),d){case 0:switch(c){case -1:b=!0;break;case "'":g&&!m&&(""==j?j="'":"'"==j&&(j=""));
break;case '"':g&&!m&&(""==j?j='"':'"'==j&&(j=""));break;case "\\":g&&""!=j&&(c=k.getChar(h),-1==c?b=!0:"\\"!=c&&c!=j&&k.ungetChar(h));break;case "/":if(g&&""==j)if(c=k.getChar(h),-1==c)b=!0;else if("/"==c)m=!0;else if("*"==c){do{do c=k.getChar(h);while(-1!=c&&"*"!=c);c=k.getChar(h);"*"==c&&k.ungetChar(h)}while(-1!=c&&"/"!=c)}else k.ungetChar(h);break;case "\n":m=!1;break;case "<":g?""==j&&(d=1):d=1}break;case 1:switch(c){case -1:b=!0;break;case "/":d=!a||k.getText(h.position,h.position+a.length)===
a&&!k.getText(h.position+a.length,h.position+a.length+1).match(/\w/)?2:0;break;case "!":c=k.getChar(h);-1==c?b=!0:"-"==c?(c=k.getChar(h),-1==c?b=!0:d="-"==c?3:0):d=0;break;default:d=0}break;case 2:m=!1;-1==c?b=!0:i.isLetter(c)?(b=!0,k.ungetChar(h),k.ungetChar(h),k.ungetChar(h)):d=0;break;case 3:m=!1;-1==c?b=!0:"-"==c&&(c=k.getChar(h),-1==c?b=!0:"-"==c?(c=k.getChar(h),-1==c?b=!0:">"==c?d=0:(k.ungetChar(h),k.ungetChar(h))):k.ungetChar(h));break;default:throw Error("unexpected "+d);}return this.makeCData(e,
h.position)},single_quote:function(g,a){var e=this.page;g.push(new k(e.getText(a[1],a[2]),"=",e.getText(a[4]+1,a[5]),"'"))},double_quote:function(g,a){var e=this.page;g.push(new k(e.getText(a[1],a[2]),"=",e.getText(a[5]+1,a[6]),'"'))},standalone:function(g,a){g.push(new k(this.page.getText(a[1],a[2])))},naked:function(g,a){var e=this.page;g.push(new k(e.getText(a[1],a[2]),"=",e.getText(a[3],a[4])))}};return j},{requires:"./Cursor,./Page,../nodes/Text,../nodes/CData,../Utils,../nodes/Attribute,../nodes/Tag,../nodes/Comment".split(",")});
KISSY.add("htmlparser/lexer/Page",function(a,c){function h(a){this.source=a;this.lineIndex=new c}h.prototype={getChar:function(a){var b=this.source,i=a.position;if(i>=b.length)return-1;var c=b.charAt(i);a.advance();"\r"===c&&(c="\n",i=a.position,"\n"===b.charAt(i)&&a.advance());"\n"===c&&this.lineIndex.add(a);return c},ungetChar:function(a){var b=this.source;a.retreat();var c=a.position,h=b.charAt(c);"\n"===h&&0!=c&&(h=b.charAt(c-1),"\r"===h&&a.retreat())},getText:function(a,b){return this.source.slice(a,
b)},row:function(a){return this.lineIndex.row(a)},col:function(a){return this.lineIndex.col(a)}};return h},{requires:["./Index"]});KISSY.add("htmlparser/nodes/Attribute",function(a){function c(a,c,b,i){this.nodeType=2;this.name=a;this.assignMent=c;this.value=b;this.quote=i}a.augment(c,{clone:function(){var h=new c;a.mix(h,this);return h},equals:function(a){return this.name==a.name&&this.value==a.value&&this.nodeType==a.nodeType}});c.prototype.clone=function(){var h=new c;a.mix(h,this);return h};return c});
KISSY.add("htmlparser/nodes/CData",function(a,c){function h(){h.superclass.constructor.apply(this,arguments);this.nodeType=4;this.nodeName="#cdata"}a.extend(h,c,{writeHtml:function(a,b){var c=this.toHtml();(!b||!1!==b.onCData(this))&&a.cdata(c)}});return h},{requires:["./Text"]});
KISSY.add("htmlparser/nodes/Comment",function(a,c){function h(){h.superclass.constructor.apply(this,arguments);this.nodeType=8;this.nodeName="#comment"}a.extend(h,c,{writeHtml:function(a,b){var c=this.toHtml();(!b||!1!==b.onComment(this))&&a.comment(c)}});return h},{requires:["./Tag"]});
KISSY.add("htmlparser/nodes/Document",function(a,c){function h(){this.childNodes=[];this.nodeType=9;this.nodeName="#document"}a.extend(h,c,{writeHtml:function(a,b){this.__filter=b;this._writeChildrenHtml(a)}});return h},{requires:["./Tag"]});
KISSY.add("htmlparser/nodes/Fragment",function(a,c){function h(){this.childNodes=[];this.nodeType=9;this.nodeName="#fragment"}a.extend(h,c,{writeHtml:function(a,b){this.__filter=b;this.isChildrenFiltered=0;if(b)b.onFragment(this);this._writeChildrenHtml(a)}});return h},{requires:["./Tag"]});
KISSY.add("htmlparser/nodes/Node",function(a){function c(a){var b=0;a.replace(/\n/g,function(){b++});return b}function h(h,b,i){this.parentNode=null;this.page=h;this.startPosition=b;this.endPosition=i;this.nextSibling=this.previousSibling=this.nodeName=null;this.startLine=c(this.page.getText(0,b));this.endLine=c(this.page.getText(0,i));a.Config.debug&&(this.toHtmlContent=this.toHtml())}h.prototype={toHtml:function(){if(this.page&&this.page.getText)return this.page.getText(this.startPosition,this.endPosition)},
toString:function(){var a=[];a.push(this.nodeName+"  [ "+this.startPosition+"|"+this.startLine+" : "+this.endPosition+"|"+this.endLine+" ]\n");a.push(this.toHtml());return a.join("")}};return h});
KISSY.add("htmlparser/nodes/Tag",function(a,c,h,m){function b(g,b,f){g.nodeName=g.tagName=b.toLowerCase();g._updateSelfClosed();a.each(f,function(a,f){g.setAttribute(f,a)})}function i(g,j,f,c){this.childNodes=[];this.lastChild=this.firstChild=null;this.attributes=c||[];this.nodeType=1;if(a.isString(g))i.superclass.constructor.apply(this),b.apply(null,[this].concat(a.makeArray(arguments)));else{i.superclass.constructor.apply(this,arguments);c=this.attributes;c[0]&&(this.nodeName=c[0].name.toLowerCase(),
this.tagName=this.nodeName.replace(/\//,""),this._updateSelfClosed(),c.splice(0,1));var e=c[c.length-1];if(e=!(!e||!/\/$/.test(e.name)))c.length-=1;this.closed=this.isSelfClosed=this.isSelfClosed||e}this.closedEndPosition=this.closedStartPosition=-1}function k(a){var b=a.childNodes;a.firstChild=b[0];a.lastChild=b[b.length-1];1<=b.length&&(b[0].nextSibling=b[0].nextSibling=null,b[0].parentNode=a);if(1<b.length){for(var f=0;f<b.length-1;f++)b[f].nextSibling=b[f+1],b[f+1].previousSibling=b[f],b[f+1].parentNode=
a;b[b.length-1].nextSibling=null}}function l(a,b){for(var f=0;f<a.length;f++)if(a[f].name==b)return a[f];return null}a.extend(i,c,{_updateSelfClosed:function(){this.isSelfClosed=!!m.$empty[this.nodeName];this.isSelfClosed||(this.isSelfClosed=/\/$/.test(this.nodeName));this.closed=this.isSelfClosed},clone:function(){var g=new i,b=[];a.each(this.attributes,function(a){b.push(a.clone())});a.mix(g,{childNodes:[],firstChild:null,lastChild:null,attributes:b,nodeType:this.nodeType,nodeName:this.nodeName,
tagName:this.tagName,isSelfClosed:this.isSelfClosed,closed:this.closed,closedStartPosition:this.closedStartPosition,closedEndPosition:this.closedEndPosition});return g},setTagName:function(a){this.nodeName=this.tagName=a;this._updateSelfClosed()},equals:function(a){if(!a||this.nodeName!=a.nodeName||this.nodeType!=a.nodeType||this.attributes.length!=a.attributes.length)return 0;for(var b=0;b<this.attributes.length;b++)if(!this.attributes[b].equals(a.attributes[b]))return 0;return 1},isEndTag:function(){return/^\//.test(this.nodeName)},
appendChild:function(a){this.childNodes.push(a);k(this)},replace:function(g){var b=g.parentNode.childNodes,f=a.indexOf(g,b);b[f]=this;k(g.parentNode)},prepend:function(a){this.childNodes.unshift(a);k(this)},insertBefore:function(g){var b=g.parentNode.childNodes,f=a.indexOf(g,b);b.splice(f,0,this);k(g.parentNode)},insertAfter:function(g){var b=g.parentNode.childNodes,f=a.indexOf(g,b);f==b.length-1?g.parentNode.appendChild(this):this.insertBefore(g.parentNode.childNodes[[f+1]])},empty:function(){this.childNodes=
[];k(this)},removeChild:function(b){var c=b.parentNode.childNodes,f=a.indexOf(b,c);c.splice(f,1);k(b.parentNode)},getAttribute:function(a){return(a=l(this.attributes,a))&&a.value},setAttribute:function(a,b){var f=l(this.attributes,a);f?f.value=b:this.attributes.push(new h(a,"=",b,'"'))},removeAttribute:function(b){(b=l(this.attributes,b))&&this.attributes.splice(a.indexOf(b,this.attributes),1)},filterChildren:function(){var b=this;if(!b.isChildrenFiltered){var c=new (a.require("htmlparser/writer/basic"));
b._writeChildrenHtml(c);c=(new (a.require("htmlparser/Parser"))(c.getHtml())).parse().childNodes;b.empty();a.each(c,function(a){b.appendChild(a)});b.isChildrenFiltered=1}},writeHtml:function(a,b){var f=this,c;c=f.tagName;if("!doctype"==c)a.append(this.toHtml()+"\n");else{f.__filter=b;f.isChildrenFiltered=0;if(b){if(!(c=b.onTagName(c)))return;f.tagName=c;c=b.onTag(f);if(!1===c)return;c&&(f=c);if(1!==f.nodeType){f.writeHtml(a,b);return}if(!f.tagName){f._writeChildrenHtml(a);return}}a.openTag(f);for(var e=
f.attributes,d=0;d<e.length;d++){var i=e[d];c=i.name;if(b){if(!(c=b.onAttributeName(c,f)))continue;i.name=c;if(!1===b.onAttribute(i,f))continue}a.attribute(i,f)}a.openTagClose(f);f.isSelfClosed||(f._writeChildrenHtml(a),a.closeTag(f))}},_writeChildrenHtml:function(b){var c=this.isChildrenFiltered?0:this.__filter;a.each(this.childNodes,function(a){a.writeHtml(b,c)})}});return i},{requires:["./Node","./Attribute","../dtd"]});
KISSY.add("htmlparser/nodes/Text",function(a,c){function h(c){a.isString(c)?(this.nodeValue=c,h.superclass.constructor.apply(this,[null,-1,-1])):(h.superclass.constructor.apply(this,arguments),this.nodeValue=this.toHtml());this.nodeType=3;this.nodeName="#text"}a.extend(h,c,{writeHtml:function(a,b){var c=this.nodeValue;(!b||!1!==b.onText(this))&&a.text(c)},toHtml:function(){return this.nodeValue?this.nodeValue:h.superclass.toHtml.apply(this,arguments)}});return h},{requires:["./Node"]});
KISSY.add("htmlparser/scanners/CdataScanner",function(){return{scan:function(a,c,h){var h=c.parseCDATA(h.quoteSmart,a.nodeName),m=c.getPosition(),b=c.nextNode();b&&(1!=b.nodeType||!(b.isEndTag()&&b.tagName==a.tagName))&&c.setPosition(m);a.closed=!0;h&&a.appendChild(h)}}});KISSY.add("htmlparser/scanners/QuoteCdataScanner",function(a,c,h,m){var a={scan:function(a,b,h){h=h||{};h.quoteSmart=1;c.scan(a,b,h);h.quoteSmart=0}},b;for(b in h.$cdata)m[b]=a;return a},{requires:["./CdataScanner","../dtd","./SpecialScanners"]});
KISSY.add("htmlparser/scanners/SpecialScanners",function(){return{}});
KISSY.add("htmlparser/scanners/TagScanner",function(a,c,h,m){function b(g,j){function f(){d.childNodes.length&&(d.insertAfter(l),l=d,d=g.clone())}g.closed=1;if(!j.fixByDtd)return 0;var n=1,e=[].concat(g.childNodes);a.each(e,function(a){if(!i(g,a))return n=0,!1});if(n)return 0;for(var d=g.clone(),l=g,m=[],p=0;p<e.length;p++){var o=e[p];if(i(d,o))d.appendChild(o);else if(1==o.nodeType){var s=o.tagName;if(c.$listItem[s]){f();var o=k[o.tagName],r=new h;for(r.nodeName=r.tagName=o;p<e.length;){if(e[p].tagName==
s)r.appendChild(e[p]);else if((3!=e[p].nodeType||a.trim(e[p].toHtml()))&&3==e[p].nodeType)break;p++}r.insertAfter(l);l=r;p--}else f(),o.equals(d)?(o.insertAfter(l),l=o):i(o,d)?(d=g.clone(),a.each(o.childNodes,function(a){d.appendChild(a)}),o.empty(),o.insertAfter(l),l=o,o.appendChild(d),m.push(d),d=g.clone()):(o.insertAfter(l),l=o)}}d.childNodes.length&&d.insertAfter(l);g.parentNode.removeChild(g);a.each(m,function(a){b(a,j)});return 1}function i(a,b){if(9==a.nodeType||8==b.nodeType)return 1;var f=
b.tagName||b.nodeName;3==b.nodeType&&(f="#");return!!c[a.tagName][f]}var k={li:"ul",dt:"dl",dd:"dl"},l={dd:"dl",dt:"dl",li:"ul",option:"select",optgroup:"select"};return{scan:function(a,c,f){function i(c,d){for(h=c;h>d;h--){var e=k[h];k[h-1].appendChild(e);b(e,f)}a=k[d];k.length=d}function e(a){var b=0,c;if(c=l[a.tagName]){for(var d=k.length-1,f=k[d];f&&f.tagName!=c;){if(f.tagName==a.tagName){b=1;break}d--;f=k[d]}b&&i(k.length-1,d-1)}return b}var d,h,k;k=f.stack=f.stack||[];do{if(d=c.nextNode())if(1===
d.nodeType)if(d.isEndTag()&&d.tagName==a.tagName)d=null;else if(d.isEndTag()){if(d.isEndTag()){var p=-1;for(h=k.length-1;0<=h;h--)if(k[h].tagName===d.tagName){p=h;break}-1!=p&&(k[k.length-1].appendChild(a),b(a,f),i(k.length-1,p),d=null)}}else m[d.tagName]?(m[d.tagName].scan(d,c,f),a.appendChild(d)):d.isSelfClosed?a.appendChild(d):(k.push(a),e(d)&&k.push(a),a=d);else a.appendChild(d);null==d&&0<k.length&&(d=k[k.length-1],m[d.tagName]?d=null:(k.length-=1,d.appendChild(a),b(a,f),a=d))}while(d);b(a,f)}}},
{requires:["../dtd","../nodes/Tag","./SpecialScanners"]});KISSY.add("htmlparser/scanners/TextareaScanner",function(a,c,h){return h.textarea={scan:function(a,b,i){i=i||{};c.scan(a,b,i)}}},{requires:["./CdataScanner","./SpecialScanners"]});
KISSY.add("htmlparser/writer/basic",function(){function a(){this.output=[]}a.prototype={append:function(){for(var a=this.output,h=arguments,m,b=0;b<h.length;b++)if(m=h[b],1<m.length)for(var i=0;i<m.length;i++)a.push(m.charAt(i));else a.push(m);return this},openTag:function(a){this.append("<",a.tagName)},openTagClose:function(a){a.isSelfClosed&&this.append(" ","/");this.append(">")},closeTag:function(a){this.append("</",a.tagName,">")},attribute:function(a){this.append(" ",a.name,'="',(a.value||a.name).replace(/"/g,
"&quote;"),'"')},text:function(a){this.append(a)},cdata:function(a){this.append(a)},comment:function(a){this.append(a)},getHtml:function(){return this.output.join("")}};return a});
KISSY.add("htmlparser/writer/beautify",function(a,c,h,m){function b(){b.superclass.constructor.apply(this,arguments);this.inPre=0;this.indentChar="\t";this.allowIndent=this.indentLevel=0;this.rules={};for(var c in a.merge(h.$nonBodyContent,h.$block,h.$listItem,h.$tableContent,{select:1,script:1,style:1}))this.setRules(c,{allowIndent:1,breakBeforeOpen:1,breakAfterOpen:1,breakBeforeClose:1,breakAfterClose:1});this.setRules("option",{breakBeforeOpen:1});this.setRules("optiongroup",{breakBeforeOpen:1});
this.setRules("br",{breakAfterOpen:1});this.setRules("title",{allowIndent:0,breakBeforeClose:0,breakAfterOpen:0});this.setRules("pre",{allowIndent:0})}a.extend(b,c,{indentation:function(){this.inPre||this.append(Array(this.indentLevel+1).join(this.indentChar));this.allowIndent=0},lineBreak:function(){var a=this.output;if(!this.inPre&&a.length){for(var b=a.length-1;0<=b&&/[\r\n\t ]/.test(a[b]);b--);a.length=b+1;this.append("\n")}this.allowIndent=1},setRules:function(b,c){this.rules[b]||(this.rules[b]=
{});a.mix(this.rules[b],c)},openTag:function(a){var c=this.rules[a.tagName]||{};this.allowIndent?this.indentation():c.breakBeforeOpen&&(this.lineBreak(),this.indentation());b.superclass.openTag.apply(this,arguments)},openTagClose:function(a){var b=a.tagName,c=this.rules[b]||{};a.isSelfClosed?this.append(" />"):(this.append(">"),c.allowIndent&&this.indentLevel++);c.breakAfterOpen&&this.lineBreak();"pre"===b&&(this.inPre=1)},closeTag:function(a){var c=a.tagName,h=this.rules[c]||{};h.allowIndent&&this.indentLevel--;
this.allowIndent?this.indentation():h.breakBeforeClose&&(this.lineBreak(),this.indentation());b.superclass.closeTag.apply(this,arguments);"pre"===c&&(this.inPre=0);h.breakAfterClose&&this.lineBreak()},text:function(a){this.allowIndent&&this.indentation();this.inPre||(a=m.collapseWhitespace(a));this.append(a)},comment:function(a){this.allowIndent&&this.indentation();this.append(a)},cdata:function(a){this.allowIndent&&this.indentation();this.append(a)}});return b},{requires:["./basic","../dtd","../Utils"]});
KISSY.add("htmlparser/writer/filter",function(a){function c(){this.tagNames=[];this.attributeNames=[];this.tags=[];this.comment=[];this.text=[];this.cdata=[];this.attributes=[];this.root=[]}function h(b,c){for(var h=0;b&&h<b.length;h++)a.each(b[h].value,function(a){c=c.replace(a[0],a[1])});return c}function m(a,c,h){for(var l=0;a&&l<a.length;l++)if(!1===a[l].value.apply(null,c))return!1;return h}c.prototype={addRules:function(a,c){var c=c||10,h;for(h in a)if(a.hasOwnProperty(h)){var l=this[h];if(l){var g;
a:{for(g=0;l&&g<l.length;g++)if(l[g].priority>c)break a;g=l.length}l.splice(g,0,{value:a[h],priority:c})}}},onTagName:function(a){return h(this.tagNames,a)},onAttributeName:function(a){return h(this.attributeNames,a)},onText:function(a){return m(this.text,[a.toHtml(),a],a)},onCData:function(a){return m(this.cdata,[a.toHtml(),a],a)},onAttribute:function(a,c){var h;a:{h=this.attributes;for(var l=0;h&&l<h.length;l++){var g=h[l].value,j=a.name;if(g[j]&&!1===g[j].call(null,a.value,c)){h=!1;break a}}h=
a}return h},onComment:function(a){return m(this.comment,[a.toHtml(),a],a)},onNode:function(a){var c=a.nodeType;if(1===c)return this.onTag(a);if(3===c)return this.onText(a);if(8===c)return this.onComment(a)},onFragment:function(a){return m(this.root,[a],a)},onTag:function(a){for(var c=["^",a.tagName,"$"],h=this.tags,l,g=0;g<c.length;g++)for(var j=c[g],f=0;f<h.length;f++)if(l=h[f].value,l[j]){if(!1===(l=l[j](a)))return!1;if(l&&l!=a)return this.onNode(l);if(!a.tagName)return a}return a}};return c});
KISSY.add("htmlparser/writer/minify",function(a,c,h){function m(a){return a.replace(/"/g,"&quote;")}function b(a,c){var b=a.nodeName,e=c.name,d=c.value||"";/^on[a-z]+/.test(e)?d=k(d).replace(/^javascript:[\s\xa0]*/i,"").replace(/[\s\xa0]*;$/,""):"class"===e?d=l(k(d)):/^(?:a|area|link|base)$/.test(b)&&"href"===e||"img"===b&&/^(?:src|longdesc|usemap)$/.test(e)||"object"===b&&/^(?:classid|codebase|data|usemap)$/.test(e)||"q"===b&&"cite"===e||"blockquote"===b&&"cite"===e||("ins"===b||"del"===b)&&"cite"===
e||"form"===b&&"action"===e||"input"===b&&("src"===e||"usemap"===e)||"head"===b&&"profile"===e||"script"===b&&("src"===e||"for"===e)||/^(?:a|area|object|button)$/.test(b)&&"tabindex"===e||"input"===b&&("maxlength"===e||"tabindex"===e)||"select"===b&&("size"===e||"tabindex"===e)||"textarea"===b&&/^(?:rows|cols|tabindex)$/.test(e)||"colgroup"===b&&"span"===e||"col"===b&&"span"===e||("th"===b||"td"==b)&&("rowspan"===e||"colspan"===e)?d=k(d):"style"===e&&(d=k(d).replace(/[\s\xa0]*;[\s\xa0]*$/,""));return d}
function i(){i.superclass.constructor.apply(this,arguments);this.inPre=0}var k=a.trim,l=h.collapseWhitespace,g=RegExp("^(?:class|id|style|title|lang|dir|on(?:focus|blur|change|click|dblclick|mouse(?:down|up|over|move|out)|key(?:press|down|up)))$");a.extend(i,c,{comment:function(a){/\[if[^\]]+\]/.test(a)&&(a=a.replace(/^(\[[^\]]+\]>)[\s\xa0]*/,"$1").replace(/[\s\xa0]*(<!\[endif\])$/,"$1"),i.superclass.comment.call(this,a))},openTag:function(a){"pre"==a.tagName&&(this.inPre=1);i.superclass.openTag.apply(this,
arguments)},closeTag:function(a){"pre"==a.tagName&&(this.inPre=0);i.superclass.closeTag.apply(this,arguments)},cdata:function(a){a=k(a).replace(/^(?:[\s\xa0]*\/\*[\s\xa0]*<!\[CDATA\[[\s\xa0]*\*\/|[\s\xa0]*\/\/[\s\xa0]*<!\[CDATA\[.*)/,"").replace(/(?:\/\*[\s\xa0]*\]\]>[\s\xa0]*\*\/|\/\/[\s\xa0]*\]\]>)[\s\xa0]*$/,"");i.superclass.cdata.call(this,a)},attribute:function(a,c){var h=a.name,e=a.value||"",d;d=a.name;if(d=!(!k(a.value||"")&&("input"===c&&"value"===d||g.test(d)))){d=c.nodeName;var i=a.name,
l=a.value||"",l=k(l.toLowerCase());d=!("script"===d&&"language"===i&&"javascript"===l||"form"===d&&"method"===i&&"get"===l||"input"===d&&"type"===i&&"text"===l||"script"===d&&"type"===i&&"text/javascript"===l||"style"===d&&"type"===i&&"text/css"===l||"area"===d&&"shape"===i&&"rect"===l)}d&&(/^(?:checked|disabled|selected|readonly|defer|multiple|nohref|noshape|nowrap|noresize|compact|ismap)$/i.test(h)?this.append(" ",h):!/[ "'=<>`]/.test(e)?this.append(" ",h,"=",m(b(c,a))):this.append(" ",h,'="',m(b(c,
a)),'"'))},text:function(a){this.inPre||this.append(l(a))}});return i},{requires:["./basic","../Utils"]});
