modulex.add("event-dom/gesture/pan",["event-dom/gesture/util","event-dom/base","modulex-util"],function(e,t,a){var r,s=e("event-dom/gesture/util"),i=e("event-dom/base"),n=e("modulex-util");r=function(e){function t(e,t){var a=e.pageX-t.pageX,r=e.pageY-t.pageY;return Math.sqrt(a*a+r*r)}function a(e,a){var s=e.lastTouches[0],i=e.startPos;if(!e.direction){var n=a.pageX-e.startPos.pageX,g=a.pageY-e.startPos.pageY,p=Math.abs(n),u=Math.abs(g);e.direction=p>u?0>n?"left":"right":0>g?"up":"down"}t(s,i)>h&&(e.isStarted?r(e,a):(X.body.setCapture&&X.body.setCapture(),e.isStarted=!0),l.fire(e.dragTarget,c,o(e,a)))}function r(e,t){var a=e.lastTouches[0],r=t.timeStamp;r-e.lastTime>T&&(e.lastPos={pageX:a.pageX,pageY:a.pageY},e.lastTime=r)}function o(e,t,a){var r=e.startPos;a=a||{};var s=e.lastTouches[0];return a.which=1,a.pageX=s.pageX,a.pageY=s.pageY,a.originalEvent=t.originalEvent,a.deltaX=s.pageX-r.pageX,a.deltaY=s.pageY-r.pageY,a.startTime=e.startTime,a.startPos=e.startPos,a.gestureType=t.gestureType,a.direction=e.direction,a}function g(){}e={};var p=s,u=p.addEvent,l=i,d=p.SingleTouch,c="panStart",m="panEnd",v="pan",T=300,h=3,X=document,Y=n;return Y.extend(g,d,{start:function(){var e=this;g.superclass.start.apply(e,arguments);var t=e.lastTouches[0];e.lastTime=e.startTime,e.dragTarget=t.target,e.startPos=e.lastPos={pageX:t.pageX,pageY:t.pageY},e.direction=null},move:function(e){var t=this;g.superclass.move.apply(t,arguments),t.isStarted?(r(t,e),l.fire(t.dragTarget,v,o(t,e))):a(t,e)},end:function(e){var t=this,a=t.lastTouches[0],r=e.timeStamp,s=(a.pageX-t.lastPos.pageX)/(r-t.lastTime),i=(a.pageY-t.lastPos.pageY)/(r-t.lastTime);l.fire(t.dragTarget,m,o(t,e,{velocityX:s||0,velocityY:i||0})),X.body.releaseCapture&&X.body.releaseCapture()}}),u([c,v,m],{handle:new g}),e={PAN_START:c,PAN:v,PAN_END:m}}(),a.exports=r});