/*
Copyright 2012, KISSY UI Library v1.30rc
MIT Licensed
build time: Jul 30 19:14
*/
KISSY.add("switchable/accordion/aria",function(c,b,k,j,m,g){function n(a){var d=null;c.each(this.triggers,function(h){if(h==a||b.contains(h,a))d=h});return d}function q(a){var d=null;c.each(this.panels,function(h){if(h==a||b.contains(h,a))d=h});return d}function l(a){var d=n.call(this,a);d||(a=q.call(this,a),d=this.triggers[c.indexOf(a,this.panels)]);return d}function i(a){switch(a.keyCode){case r:case p:a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.halt();break;case s:a.ctrlKey&&!a.altKey&&a.halt()}}function e(h){var b=
h.target,e=this.triggers,i=!h.ctrlKey&&!h.shiftKey&&!h.altKey,q=h.ctrlKey&&!h.shiftKey&&!h.altKey;switch(h.keyCode){case z:case A:if((b=n.call(this,b))&&i)this.switchTo(c.indexOf(b,this.triggers)),h.halt();break;case o:case x:if(b=n.call(this,b))a.call(this,b),h.halt();break;case w:case v:if(b=n.call(this,b))d.call(this,b),h.halt();break;case p:q&&(h.halt(),b=l.call(this,b),d.call(this,b));break;case r:q&&(h.halt(),b=l.call(this,b),a.call(this,b));break;case t:i&&(l.call(this,b),f.call(this,0,!0),
h.halt());break;case u:i&&(l.call(this,b),f.call(this,e.length-1,!0),h.halt());break;case s:h.ctrlKey&&!h.altKey&&(h.halt(),b=l.call(this,b),h.shiftKey?a.call(this,b):d.call(this,b))}}function f(a,d){var h=this.triggers,s=h[a];c.each(h,function(a){a!==s&&(y(a,"-1"),b.removeClass(a,"ks-switchable-select"),a.setAttribute("aria-selected","false"))});d&&s.focus();y(s,"0");b.addClass(s,"ks-switchable-select");s.setAttribute("aria-selected","true")}function a(a){var d=this.triggers,a=c.indexOf(a,d);f.call(this,
0==a?d.length-1:a-1,!0)}function d(a){var d=this.triggers,a=c.indexOf(a,d);f.call(this,a==d.length-1?0:a+1,!0)}function h(a){var d=!(!a.originalEvent.target&&!a.originalEvent.srcElement),a=a.currentIndex,h=this.panels,b=this.triggers,s=b[a],r=h[a];this.config.multiple||(c.each(h,function(a){a!==r&&a.setAttribute("aria-hidden","true")}),c.each(b,function(a){a!==s&&a.setAttribute("aria-hidden","true")}));h=r.getAttribute("aria-hidden");r.setAttribute("aria-hidden","false"==h?"true":"false");s.setAttribute("aria-expanded",
"false"==h?"false":"true");f.call(this,a,d)}var r=33,p=34,u=35,t=36,o=37,x=38,w=39,v=40,s=9,A=32,z=13;c.mix(m.Config,{aria:!0});g.addPlugin({name:"aria",init:function(a){if(a.config.aria){var d=a.container,s=a.activeIndex;b.attr(d,"aria-multiselectable",a.config.multiple?"true":"false");a.nav&&b.attr(a.nav,"role","tablist");var r=a.triggers,o=a.panels,p=0;c.each(o,function(a){a.id||(a.id=c.guid("ks-accordion-tab-panel"))});c.each(r,function(a){a.id||(a.id=c.guid("ks-accordion-tab"))});c.each(r,function(a){a.setAttribute("role",
"tab");a.setAttribute("aria-expanded",s==p?"true":"false");a.setAttribute("aria-selected",s==p?"true":"false");a.setAttribute("aria-controls",o[p].id);y(a,s==p?"0":"-1");p++});p=0;c.each(o,function(a){var d=r[p];a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden",s==p?"false":"true");a.setAttribute("aria-labelledby",d.id);p++});a.on("switch",h,a);k.on(d,"keydown",e,a);k.on(d,"keypress",i,a)}}},m);var y=j.setTabIndex},{requires:["dom","event","../aria","./base","../base"]});
KISSY.add("switchable/accordion/base",function(c,b,k){function j(b,c){if(!(this instanceof j))return new j(b,c);j.superclass.constructor.apply(this,arguments)}c.extend(j,k,{_switchTrigger:function(c,g){var k=this.config;k.multiple?b.toggleClass(g,k.activeTriggerCls):j.superclass._switchTrigger.apply(this,arguments)},_triggerIsValid:function(b){return this.config.multiple||j.superclass._triggerIsValid.call(this,b)},_switchView:function(c,g,k){var q=this.config,l=this._getFromToPanels().toPanels;q.multiple?
(b.toggle(l),this._fireOnSwitch(g),k&&k.call(this)):j.superclass._switchView.apply(this,arguments)}});j.Config={markupType:1,triggerType:"click",multiple:!1};return j},{requires:["dom","../base"]});
KISSY.add("switchable/aria",function(c,b,k,j){function m(){this.stop&&this.stop()}function g(){this.start&&this.start()}j.addPlugin({name:"aria",init:function(b){if(b.config.aria){var c=b.container;k.on(c,"focusin",m,b);k.on(c,"focusout",g,b)}}});var n=["a","input","button","object"];return{setTabIndex:function(q,l){q.tabIndex=l;c.each(b.query("*",q),function(i){var e=i.nodeName.toLowerCase();c.inArray(e,n)&&(b.hasAttr(i,"oriTabIndex")||b.attr(i,"oriTabIndex",i.tabIndex),i.tabIndex=-1!=l?b.attr(i,
"oriTabIndex"):l)})}}},{requires:["dom","event","./base"]});
KISSY.add("switchable/autoplay",function(c,b,k,j,m){var g=c.Env.host,n=function(c){var l=b.scrollTop(),i=b.viewportHeight(),e=b.offset(c),c=b.height(c);return e.top>l&&e.top+c<l+i};c.mix(j.Config,{pauseOnScroll:!1,autoplay:!1,interval:5,pauseOnHover:!0});j.addPlugin({name:"autoplay",init:function(b){function l(){f=c.later(function(){b.paused||b.next()},e,!0)}var i=b.config,e=1E3*i.interval,f;if(i.autoplay&&(i.pauseOnScroll&&(b.__scrollDetect=c.buffer(function(){b[n(b.container)?"start":"stop"]()},
200),k.on(g,"scroll",b.__scrollDetect)),l(),b.stop=function(){if(f){f.cancel();f=m}b.paused=true},b.start=function(){if(f){f.cancel();f=m}b.paused=false;l()},i.pauseOnHover))k.on(b.container,"mouseenter",b.stop,b),k.on(b.container,"mouseleave",b.start,b)},destroy:function(b){b.__scrollDetect&&k.remove(g,"scroll",b.__scrollDetect)}});return j},{requires:["dom","event","./base"]});
KISSY.add("switchable/base",function(c,b,k,j){function m(a,d){this._triggerInternalCls=c.guid(e);this._panelInternalCls=c.guid(f);d=d||{};"markupType"in d||(d.panelCls?d.markupType=1:d.panels&&(d.markupType=2));for(var h=this.constructor;h;)d=c.merge(h.Config,d),h=h.superclass?h.superclass.constructor:null;this.container=b.get(a);this.config=d;this.activeIndex=d.activeIndex;var r;-1<this.activeIndex||("number"==typeof d.switchTo?r=d.switchTo:this.activeIndex=0);this._init();this._initPlugins();this.fire(l);
r!==j&&this.switchTo(r)}function g(a){var d={};d.type=a.type;d.target=a.target;return{originalEvent:d}}var n=c.makeArray,q=k.Target,l="init",i="remove",e="ks-switchable-trigger-internal",f="ks-switchable-panel-internal";m.getDomEvent=g;m.addPlugin=function(a,d){for(var d=d||m,b=a.priority=a.priority||0,r=0,p=d.Plugins=d.Plugins||[];r<p.length&&!(p[r].priority<b);r++);p.splice(r,0,a)};m.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",
panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:!0,triggerType:"mouse",delay:0.1,activeIndex:-1,activeTriggerCls:"ks-active",switchTo:j,steps:1,viewSize:[]};c.augment(m,q,{_initPlugins:function(){for(var a=this,d=[],b=a.constructor;b;)b.Plugins&&d.push.apply(d,[].concat(b.Plugins).reverse()),b=b.superclass?b.superclass.constructor:null;d.reverse();c.each(d,function(d){d.init&&d.init(a)})},_init:function(){var a=this.config;this._parseMarkup();a.hasTriggers&&this._bindTriggers();this._bindPanels()},
_parseMarkup:function(){var a=this.container,d=this.config,h,r,p=[],c=[];switch(d.markupType){case 0:(h=b.get("."+d.navCls,a))&&(p=b.children(h));r=b.get("."+d.contentCls,a);c=b.children(r);break;case 1:p=b.query("."+d.triggerCls,a);c=b.query("."+d.panelCls,a);break;case 2:p=d.triggers,c=d.panels}this.length=Math.ceil(c.length/d.steps);this.nav=h||d.hasTriggers&&p[0]&&p[0].parentNode;if(d.hasTriggers&&(!this.nav||0==p.length))p=this._generateTriggersMarkup(this.length);this.triggers=n(p);this.panels=
n(c);this.content=r||c[0].parentNode},_generateTriggersMarkup:function(a){var d=this.config,h=this.nav||b.create("<ul>"),c,p;h.className=d.navCls;for(p=0;p<a;p++)c=b.create("<li>"),p===this.activeIndex&&(c.className=d.activeTriggerCls),c.innerHTML=p+1,h.appendChild(c);this.container.appendChild(h);this.nav=h;return b.children(h)},_bindTriggers:function(){var a=this,d=a.config,b=a._triggerInternalCls,r=c.one(a.nav);c.each(a.triggers,function(d){a._initTrigger(d)});r.delegate("click","."+b,function(d){var b=
a._getTriggerIndex(d.currentTarget);a._onFocusTrigger(b,d)});"mouse"===d.triggerType&&r.delegate("mouseenter","."+b,function(d){var b=a._getTriggerIndex(d.currentTarget);a._onMouseEnterTrigger(b,d)}).delegate("mouseleave","."+b,function(){a._onMouseLeaveTrigger()})},_initTrigger:function(a){b.addClass(a,this._triggerInternalCls)},_bindPanels:function(){var a=this;c.each(a.panels,function(d){a._initPanel(d)})},_initPanel:function(a){b.addClass(a,this._panelInternalCls)},_onFocusTrigger:function(a,
d){this._triggerIsValid(a)&&(this._cancelSwitchTimer(),this.switchTo(a,j,g(d)))},_onMouseEnterTrigger:function(a,d){var b=this;if(b._triggerIsValid(a)){var r=g(d);b.switchTimer=c.later(function(){b.switchTo(a,j,r)},1E3*b.config.delay)}},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_triggerIsValid:function(a){return this.activeIndex!==a},_cancelSwitchTimer:function(){this.switchTimer&&(this.switchTimer.cancel(),this.switchTimer=j)},_getTriggerIndex:function(a){return c.indexOf(a,this.triggers)},
_resetLength:function(){this.length=this._getLength()},_getLength:function(a){var d=this.config;a===j&&(a=this.panels.length);return Math.ceil(a/d.steps)},_afterAdd:function(a,d,b){this._resetLength();a=this._getLength(a+1)-1;1==this.config.steps&&this.activeIndex>=a&&(this.activeIndex+=1);var c=this.activeIndex;this.activeIndex=-1;this.switchTo(c);d?this.switchTo(a,j,j,b):b()},add:function(a){var d=a.callback||c.noop,h=this.nav,i=this.content,e=a.trigger,f=a.panel,l=a.active,o=this.panels.length,
a=null!=a.index?a.index:o,j=this.triggers,g=this.panels,v=this.length,s=null,s=null,a=Math.max(0,Math.min(a,o)),o=g[a]||null;g.splice(a,0,f);i.insertBefore(f,o);1==this.config.steps?(s=j[a],h.insertBefore(e,s),j.splice(a,0,e)):(s=this._getLength(),s!=v&&(b.append(e,h),j.push(e)));this._initPanel(f);this._initTrigger(e);this._afterAdd(a,l,d);this.fire("add",{index:a,trigger:e,panel:f})},remove:function(a){function d(){v&&(b.remove(v),o.splice(g,1));if(q){b.remove(q);for(var a=0;a<k.length;a++)if(k[a]==
q){e.triggers.splice(a,1);break}}e._resetLength();e.fire(i,{index:g,trigger:q,panel:v})}var h=a.callback||c.noop,e=this,f=e.config.steps,l=e.length,g,o=e.panels;g="index"in a?a.index:a.panel;var a=e._getLength(o.length-1),k=e.triggers,q=null,v=null;if(o.length&&(g=c.isNumber(g)?Math.max(0,Math.min(g,o.length-1)):c.indexOf(g,o),q=1==f?k[g]:a!==l?k[l-1]:null,v=o[g],!1!==e.fire("beforeRemove",{index:g,panel:v,trigger:q})))if(0==a)d(),h();else{var s=e.activeIndex;1<f?s==a?e.switchTo(s-1,j,j,function(){d();
h()}):(d(),e.activeIndex=-1,e.switchTo(s,j,j,function(){h()})):s==g?e.switchTo(0<s?s-1:s+1,j,j,function(){d();0==s&&(e.activeIndex=0);h()}):(s>g&&(s--,e.activeIndex=s),d(),h())}},switchTo:function(a,d,b,e){var c=this,i=c.config,f=c.activeIndex,o=c.triggers;if(!c._triggerIsValid(a)||!1===c.fire("beforeSwitch",{fromIndex:f,toIndex:a}))return c;c.fromIndex=f;i.hasTriggers&&c._switchTrigger(o[f]||null,o[a]);d===j&&(d=a>f?"forward":"backward");c.activeIndex=a;c._switchView(d,b,function(){e&&e.call(c)});
return c},_switchTrigger:function(a,d){var c=this.config.activeTriggerCls;a&&b.removeClass(a,c);b.addClass(d,c)},_getFromToPanels:function(){var a=this.fromIndex,b;b=this.config.steps;var c=this.panels,e=this.activeIndex,a=-1<a?c.slice(a*b,(a+1)*b):null;b=c.slice(e*b,(e+1)*b);return{fromPanels:a,toPanels:b}},_switchView:function(a,d,c){var e=this,i=e._getFromToPanels(),a=i.fromPanels,i=i.toPanels;a&&b.css(a,"display","none");b.css(i,"display","block");setTimeout(function(){e._fireOnSwitch(d)},0);
c&&c.call(this)},_fireOnSwitch:function(a){this.fire("switch",c.merge(a,{fromIndex:this.fromIndex,currentIndex:this.activeIndex}))},prev:function(a){this.switchTo((this.activeIndex-1+this.length)%this.length,"backward",a)},next:function(a){this.switchTo((this.activeIndex+1)%this.length,"forward",a)},destroy:function(a){for(var d=this,e=d.constructor;e;)c.each(e.Plugins,function(a){a.destroy&&a.destroy(d)}),e=e.superclass?e.superclass.constructor:null;a?k.remove(d.container):b.remove(d.container);
d.nav=null;d.content=null;d.container=null;d.triggers=[];d.panels=[];d.detach()}});return m},{requires:["dom","event"]});
KISSY.add("switchable/carousel/aria",function(c,b,k,j,m,g){function n(a){var b=a.currentIndex,d=this.activeIndex,e=this.panels,h=e[b*this.config.steps],i=this.triggers,b=i[b];if((a=!(!a.originalEvent.target&&!a.originalEvent.srcElement))||-1==d)c.each(i,function(a){t(a,-1)}),c.each(e,function(a){t(a,-1)}),b&&t(b,0),t(h,0),a&&h.focus()}function q(a){var d=null;c.each(this.triggers,function(e){if(e==a||b.contains(e,a))return d=e,!1});return d}function l(e){var i=e.target;switch(e.keyCode){case r:case h:if(i=
q.call(this,i)){var f=b.next(i),g=this.triggers;f||(f=g[0]);t(i,-1);f&&(t(f,0),f.focus());e.halt()}break;case d:case a:if(i=q.call(this,i))f=b.prev(i),g=this.triggers,f||(f=g[g.length-1]),t(i,-1),f&&(t(f,0),f.focus()),e.halt();break;case u:case p:if(i=q.call(this,i))this.switchTo(c.indexOf(i,this.triggers),void 0,o),e.halt()}}function i(a){var d=null;c.each(this.panels,function(e){if(e==a||b.contains(e,a))return d=e,!1});return d}function e(a,b){var d=c.indexOf(a,this.panels),e=this.config.steps,
i=Math.floor(d/e);return i==this.activeIndex?1:0==d%e||d%e==e-1?(this.switchTo(i,b,o),0):1}function f(c){var f=c.target;switch(c.keyCode){case r:case h:if(f=i.call(this,f)){var o=b.next(f),g=this.panels;o||(o=g[0]);t(f,-1);t(o,0);e.call(this,o,x)&&o.focus();c.halt()}break;case d:case a:if(f=i.call(this,f))o=b.prev(f),g=this.panels,o||(o=g[g.length-1]),t(f,-1),t(o,0),e.call(this,o,w)&&o.focus(),c.halt();break;case u:case p:if(f=i.call(this,f))this.fire("itemSelected",{item:f}),c.halt()}}var a=37,d=
38,h=39,r=40,p=32,u=13,t=j.setTabIndex,o={originalEvent:{target:1}},x="forward",w="backward";c.mix(m.Config,{aria:!1});g.addPlugin({name:"aria",init:function(a){if(a.config.aria){var b=a.triggers,d=a.panels,e=a.content,i=a.activeIndex;e.id||(e.id=c.guid("ks-switchbale-content"));e.setAttribute("role","listbox");var h=0;c.each(b,function(a){t(a,i==h?"0":"-1");a.setAttribute("role","button");a.setAttribute("aria-controls",e.id);h++});h=0;c.each(d,function(a){t(a,"-1");a.setAttribute("role","option");
h++});a.on("switch",n,a);if(b=a.nav)k.on(b,"keydown",l,a);k.on(e,"keydown",f,a);b=a.prevBtn;d=a.nextBtn;b&&(t(b,0),b.setAttribute("role","button"),k.on(b,"keydown",function(b){if(b.keyCode==u||b.keyCode==p){a.prev(o);b.preventDefault()}}));d&&(t(d,0),d.setAttribute("role","button"),k.on(d,"keydown",function(b){if(b.keyCode==u||b.keyCode==p){a.next(o);b.preventDefault()}}))}}},m)},{requires:["dom","event","../aria","./base","../base"]});
KISSY.add("switchable/carousel/base",function(c,b,k,j){function m(b,c){if(!(this instanceof m))return new m(b,c);m.superclass.constructor.apply(this,arguments)}var g="prevBtn",n="nextBtn",q={originalEvent:{target:1}};m.Config={circular:!0,prevBtnCls:"ks-switchable-prev-btn",nextBtnCls:"ks-switchable-next-btn",disableBtnCls:"ks-switchable-disable-btn"};c.extend(m,j,{_init:function(){function l(a){b.removeClass([i[g],i[n]],f);0==a&&b.addClass(i[g],f);a==i.length-1&&b.addClass(i[n],f)}var i=this;m.superclass._init.call(i);
var e=i.config,f=e.disableBtnCls;c.each(["prev","next"],function(a){var d=i[a+"Btn"]=b.get("."+e[a+"BtnCls"],i.container);k.on(d,"mousedown",function(b){b.preventDefault();b=i.activeIndex;if("prev"==a&&(0!=b||e.circular))i[a](q);if("next"==a&&(b!=i.length-1||e.circular))i[a](q)})});e.circular||(i.on("added removed",function(){l(i.activeIndex)}),i.on("switch",function(a){l(a.currentIndex)}));k.delegate(i.content,"click","."+i._panelInternalCls,function(a){i.fire("itemSelected",{item:a.currentTarget})})}});
return m},{requires:["dom","event","../base"]});
KISSY.add("switchable/circular",function(c,b,k,j){function m(c){var e=this,f=e.fromIndex,a=e.config,d=e.length,h="scrollx"===a.scrollType,g=h?"left":"top",j=e.activeIndex,h=e.viewSize[h?0:1],q=e.panels,m={},o={},n,w=e._realStep;n=h*d;m[g]=-h*j;-1==f?(b.css(e.content,m),c&&c()):(j+w>d?(o={position:"relative"},o[g]=n,n=j+w-d,b.css(q.slice(0,n),o),b.css(q.slice(n,w),l)):b.css(q.slice(0,w),l),q=b.css(q[f],"position"),(f+d-j)%d<(j-f+d)%d&&"relative"==q?b.css(e.content,g,-(h*(d+f))):f==d-1&&0==j?b.css(e.content,
g,h):b.css(e.content,g,-(h*f)),e.anim&&e.anim.stop(),e.anim=(new k(e.content,m,a.duration,a.easing,function(){e.anim=0;c&&c()})).run())}function g(c,e){var f=this,a=f.fromIndex,d=f.config,h=f.length,g="scrollx"===d.scrollType,j=g?"left":"top",l=f.activeIndex,m=f.viewSize[g?0:1],g=-m*l,o=f.panels,x=f.config.steps,w={},v,s="backward"===e;v=s&&0===a&&l===h-1||!s&&a===h-1&&0===l;f.anim&&(f.anim.stop(),"relative"==o[a*x].style.position&&q.call(f,o,a,j,m,1));v&&(g=n.call(f,o,l,j,m));w[j]=g+"px";-1<a?f.anim=
(new k(f.content,w,d.duration,d.easing,function(){v&&q.call(f,o,l,j,m,1);f.anim=void 0;c&&c()})).run():(b.css(f.content,w),c&&c())}function n(c,e,f,a){var d=this.config.steps,h=this.length,c=c.slice(e*d,(e+1)*d);b.css(c,"position","relative");b.css(c,f,(e?-1:1)*a*h);return e?a:-a*h}function q(c,e,f,a,d){var h=this.config.steps,g=this.length,c=c.slice(e*h,(e+1)*h);b.css(c,"position","");b.css(c,f,"");d&&b.css(this.content,f,e?-a*(g-1):"")}var l={position:"",left:"",top:""};c.mix(j.Config,{circular:!1});
j.adjustPosition=n;j.resetPosition=q;j.addPlugin({name:"circular",priority:5,init:function(c){var e=c.config,f,a,d,h,j=e.effect;if(e.circular&&("scrollx"===j||"scrolly"===j))if(e.scrollType=j,d=c.panels,h=c.container,1==e.steps&&d.length&&(f=1,a=d[0].parentNode.parentNode,a=[Math.min(b.width(h),b.width(a)),Math.min(b.height(h),b.height(a))],"scrollx"==j?f=Math.floor(a[0]/b.outerWidth(d[0],!0)):"scrolly"==j&&(f=Math.floor(a[1]/b.outerHeight(d[0],!0))),f>e.steps&&(c._realStep=f,e.effect=m)),!c._realStep)e.effect=
g}})},{requires:["dom","anim","./base","./effect"]});
KISSY.add("switchable/effect",function(c,b,k,j,m,g){var n;c.mix(m.Config,{effect:"none",duration:0.5,easing:"easeNone"});m.Effects={none:function(c){var g=this._getFromToPanels(),i=g.fromPanels,g=g.toPanels;i&&b.css(i,"display","none");b.css(g,"display","block");c&&c()},fade:function(c){var l=this,i=l._getFromToPanels(),e=i.fromPanels,f=l.config,a=e?e[0]:null,d=i.toPanels[0];l.anim&&(l.anim.stop(),b.css(l.anim.fromEl,{zIndex:1,opacity:0}),b.css(l.anim.toEl,"zIndex",9));b.css(d,"opacity",1);a?(l.anim=
(new j(a,{opacity:0},f.duration,f.easing,function(){l.anim=g;b.css(d,"z-index",9);b.css(a,"z-index",1);c&&c()})).run(),l.anim.toEl=d,l.anim.fromEl=a):(b.css(d,"z-index",9),c&&c())},scroll:function(c,l,i){var e=this,l=e.fromIndex,f=e.config,a="scrollx"===f.effect,d={};d[a?"left":"top"]=-(e.viewSize[a?0:1]*e.activeIndex)+"px";e.anim&&e.anim.stop();i||-1<l?e.anim=(new j(e.content,d,f.duration,f.easing,function(){e.anim=g;c&&c()})).run():(b.css(e.content,d),c&&c())}};n=m.Effects;n.scrollx=n.scrolly=n.scroll;
m.addPlugin({priority:10,name:"effect",init:function(g){var j=g.config,i=j.effect,e=g.panels,f=g.content,a=j.steps,d=e[0],h=g.activeIndex;if("none"!==i)switch(b.css(e,"display","block"),i){case "scrollx":case "scrolly":b.css(f,"position","absolute");"static"==b.css(f.parentNode,"position")&&b.css(f.parentNode,"position","relative");"scrollx"===i&&(b.css(e,"float","left"),b.width(f,"9999px"));g.viewSize=[j.viewSize[0]||d&&b.outerWidth(d,!0)*a,j.viewSize[1]||d&&b.outerHeight(d,!0)*a];break;case "fade":var k=
h*a,m=k+a-1,n;c.each(e,function(a,d){n=d>=k&&d<=m;b.css(a,{opacity:n?1:0,position:"absolute",zIndex:n?9:1})})}}});c.augment(m,{_switchView:function(b,g,i){var e=this,f=e.config.effect;(c.isFunction(f)?f:n[f]).call(e,function(){e._fireOnSwitch(g);i&&i.call(e)},b)}});return m},{requires:["dom","event","anim","./base"]});
KISSY.add("switchable/lazyload",function(c,b,k){var j="beforeSwitch",m="img",g="textarea",n={};n[m]="lazyImgAttribute";n[g]="lazyTextareaClass";c.mix(k.Config,{lazyImgAttribute:"data-ks-lazyload-custom",lazyTextareaClass:"ks-datalazyload-custom",lazyDataType:g});k.addPlugin({name:"lazyload",init:function(k){function l(d){var c=e.steps,d=d.toIndex*c;i.loadCustomLazyData(k.panels.slice(d,d+c),f,a);a:{var n,p,u;if(d=(c=f===m)?"img":f===g?"textarea":""){d=b.query(d,k.container);n=0;for(u=d.length;n<u;n++)if(p=
d[n],c?b.attr(p,a):b.hasClass(p,a)){c=!1;break a}}c=!0}c&&k.detach(j,l)}var i=c.require("datalazyload"),e=k.config,f,a;"img-src"===e.lazyDataType&&(e.lazyDataType=m);"area-data"===e.lazyDataType&&(e.lazyDataType=g);f=e.lazyDataType;a=e[n[f]];if(i&&f&&a)k.on(j,l)}});return k},{requires:["dom","./base"]});
KISSY.add("switchable/slide/base",function(c,b){function k(b,c){if(!(this instanceof k))return new k(b,c);k.superclass.constructor.apply(this,arguments)}k.Config={autoplay:!0,circular:!0};c.extend(k,b);return k},{requires:["../base"]});KISSY.add("switchable",function(c,b,k,j,m,g){c.mix(b,{Accordion:k,Carousel:j,Slide:m,Tabs:g});return c.Switchable=b},{requires:"switchable/base,switchable/accordion/base,switchable/carousel/base,switchable/slide/base,switchable/tabs/base,switchable/lazyload,switchable/effect,switchable/circular,switchable/carousel/aria,switchable/autoplay,switchable/aria,switchable/tabs/aria,switchable/accordion/aria".split(",")});
KISSY.add("switchable/tabs/aria",function(c,b,k,j,m,g){function n(a){var d=null;c.each(this.triggers,function(c){if(c==a||b.contains(c,a))d=c});return d}function q(a){switch(a.keyCode){case e:case f:a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.halt();break;case p:a.ctrlKey&&!a.altKey&&a.halt()}}function l(b){var c=b.target,g=b.ctrlKey&&!b.shiftKey&&!b.altKey;switch(b.keyCode){case a:case d:n.call(this,c)&&(this.prev(t(b)),b.halt());break;case h:case r:n.call(this,c)&&(this.next(t(b)),b.halt());break;case f:g&&
(b.halt(),this.next(t(b)));break;case e:g&&(b.halt(),this.prev(t(b)));break;case p:b.ctrlKey&&!b.altKey&&(b.halt(),b.shiftKey?this.prev(t(b)):this.next(t(b)))}}function i(a){var b=!(!a.originalEvent.target&&!a.originalEvent.srcElement),d=a.fromIndex,c=a.currentIndex;if(d!=c){var a=this.triggers[d],e=this.triggers[c],d=this.panels[d],c=this.panels[c];a&&u(a,"-1");u(e,"0");b&&e.focus();d&&d.setAttribute("aria-hidden","true");c.setAttribute("aria-hidden","false")}}var e=33,f=34,a=37,d=38,h=39,r=40,p=
9;c.mix(g.Config,{aria:!0});j.addPlugin({name:"aria",init:function(a){function d(a){a.setAttribute("role","tab");u(a,"-1");a.id||(a.id=c.guid("ks-switchable"))}function e(a,b){a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden","true");a.setAttribute("aria-labelledby",b.id)}if(a.config.aria){var f=a.triggers,g=a.activeIndex,h=a.panels,j=a.container;a.nav&&b.attr(a.nav,"role","tablist");var m=0;c.each(f,d);a.on("added",function(a){var b;d(b=a.trigger);e(a.panel,b)});m=0;c.each(h,function(a){e(a,
f[m]);m++});-1<g&&(u(f[g],"0"),h[g].setAttribute("aria-hidden","false"));a.on("switch",i,a);k.on(j,"keydown",l,a);k.on(j,"keypress",q,a)}}},g);var u=m.setTabIndex,t=j.getDomEvent},{requires:["dom","event","../base","../aria","./base"]});KISSY.add("switchable/tabs/base",function(c,b){function k(b,c){if(!(this instanceof k))return new k(b,c);k.superclass.constructor.call(this,b,c);return 0}c.extend(k,b);k.Config={};return k},{requires:["../base"]});
KISSY.add("switchable/touch",function(c,b,k,j,m){c.mix(j.Config,{mouseAsTouch:!1});j.addPlugin({name:"touch",init:function(g){if(!g._realStep){var n=g.config,q=n.scrollType||n.effect;if("scrolly"==q||"scrollx"==q){var l=g.content,i=g.container,e,f=n.mouseAsTouch,a,d=0,h=0,r={},p={},u="left",t,o;"scrolly"==q&&(u="top");var x=function(){if("relative"!=g.panels[g.activeIndex].style.position){g.stop&&g.stop();h=1;r=b.offset(l);var a=b.offset(i);a.bottom=a.top+i.offsetHeight;a.right=a.left+i.offsetWidth;
p=a}},w=function(c){if(h){var f=-1!=c.type.indexOf("touch")?c.originalEvent.changedTouches[0]:c,i={};"scrolly"==q?(o=g.viewSize[1],t=f.pageY-a,i.top=r.top+t,f=f.pageY>=p.top&&f.pageY<=p.bottom):(o=g.viewSize[0],t=f.pageX-e,i.left=r.left+t,f=f.pageX>=p.left&&f.pageX<=p.right);if(d||3<Math.abs(t))(-1!=c.type.indexOf("touch")&&c.preventDefault(),g.anim&&(g.anim.stop(),g.anim=m),f)?(d||(d=1,n.circular&&(c=g.activeIndex,f=g.length-1,c==f?j.adjustPosition.call(g,g.panels,0,u,o):0==c&&j.adjustPosition.call(g,
g.panels,f,u,o))),b.offset(l,i)):v()}},v=function(){if(d){h=d=0;var a=g.activeIndex,b=g.length-1;if(!n.circular&&(0>t&&a==b||0<t&&0==a))j.Effects[q].call(g,m,m,!0);else{if(!(0>t&&a==b)&&!(0<t&&0==a)&&(0==a||a==b))j.resetPosition.call(g,g.panels,0==a?b:0,u,o);g[0>t?"next":"prev"]();g.start&&g.start()}}};k.on(l,"touchstart",function(b){x();e=b.pageX;a=b.pageY});k.on(l,"touchmove",w);k.on(l,"touchend",v);f&&!("ontouchstart"in c.Env.host.document.documentElement)&&c.use("dd",function(b,d){var c=new d.Draggable({node:l});
c.on("dragstart",function(){x();e=c.startMousePos.left;a=c.startMousePos.top});c.on("drag",w);c.on("dragend",v);g.__touchDD=c})}}},destroy:function(b){var c;(c=b.__touchDD)&&c.destroy()}})},{requires:["dom","event","./base"]});
