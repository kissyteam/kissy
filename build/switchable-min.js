/*
Copyright 2012, KISSY UI Library v1.40dev
MIT Licensed
build time: Aug 14 14:55
*/
KISSY.add("switchable/accordion/aria",function(d,b,k,h,m,g){function n(a){var c=null;d.each(this.triggers,function(i){if(i==a||b.contains(i,a))c=i});return c}function q(a){var c=null;d.each(this.panels,function(i){if(i==a||b.contains(i,a))c=i});return c}function l(a){var c=n.call(this,a);c||(a=q.call(this,a),c=this.triggers[d.indexOf(a,this.panels)]);return c}function e(a){switch(a.keyCode){case t:case p:a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.halt();break;case r:a.ctrlKey&&!a.altKey&&a.halt()}}function f(i){var b=
i.target,f=this.triggers,e=!i.ctrlKey&&!i.shiftKey&&!i.altKey,q=i.ctrlKey&&!i.shiftKey&&!i.altKey;switch(i.keyCode){case z:case A:if((b=n.call(this,b))&&e)this.switchTo(d.indexOf(b,this.triggers)),i.halt();break;case o:case x:if(b=n.call(this,b))a.call(this,b),i.halt();break;case w:case v:if(b=n.call(this,b))c.call(this,b),i.halt();break;case p:q&&(i.halt(),b=l.call(this,b),c.call(this,b));break;case t:q&&(i.halt(),b=l.call(this,b),a.call(this,b));break;case s:e&&(l.call(this,b),j.call(this,0,!0),
i.halt());break;case u:e&&(l.call(this,b),j.call(this,f.length-1,!0),i.halt());break;case r:i.ctrlKey&&!i.altKey&&(i.halt(),b=l.call(this,b),i.shiftKey?a.call(this,b):c.call(this,b))}}function j(a,c){var i=this.triggers,r=i[a];d.each(i,function(a){a!==r&&(y(a,"-1"),b.removeClass(a,"ks-switchable-select"),a.setAttribute("aria-selected","false"))});c&&r.focus();y(r,"0");b.addClass(r,"ks-switchable-select");r.setAttribute("aria-selected","true")}function a(a){var c=this.triggers,a=d.indexOf(a,c);j.call(this,
0==a?c.length-1:a-1,!0)}function c(a){var c=this.triggers,a=d.indexOf(a,c);j.call(this,a==c.length-1?0:a+1,!0)}function i(a){var c=!(!a.originalEvent.target&&!a.originalEvent.srcElement),a=a.currentIndex,i=this.panels,b=this.triggers,r=b[a],t=i[a];this.config.multiple||(d.each(i,function(a){a!==t&&a.setAttribute("aria-hidden","true")}),d.each(b,function(a){a!==r&&a.setAttribute("aria-hidden","true")}));i=t.getAttribute("aria-hidden");t.setAttribute("aria-hidden","false"==i?"true":"false");r.setAttribute("aria-expanded",
"false"==i?"false":"true");j.call(this,a,c)}var t=33,p=34,u=35,s=36,o=37,x=38,w=39,v=40,r=9,A=32,z=13;d.mix(m.Config,{aria:!0});g.addPlugin({name:"aria",init:function(a){if(a.config.aria){var c=a.container,r=a.activeIndex;b.attr(c,"aria-multiselectable",a.config.multiple?"true":"false");a.nav&&b.attr(a.nav,"role","tablist");var t=a.triggers,o=a.panels,p=0;d.each(o,function(a){a.id||(a.id=d.guid("ks-accordion-tab-panel"))});d.each(t,function(a){a.id||(a.id=d.guid("ks-accordion-tab"))});d.each(t,function(a){a.setAttribute("role",
"tab");a.setAttribute("aria-expanded",r==p?"true":"false");a.setAttribute("aria-selected",r==p?"true":"false");a.setAttribute("aria-controls",o[p].id);y(a,r==p?"0":"-1");p++});p=0;d.each(o,function(a){var c=t[p];a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden",r==p?"false":"true");a.setAttribute("aria-labelledby",c.id);p++});a.on("switch",i,a);k.on(c,"keydown",f,a);k.on(c,"keypress",e,a)}}},m);var y=h.setTabIndex},{requires:["dom","event","../aria","./base","../base"]});
KISSY.add("switchable/accordion/base",function(d,b,k){function h(b,d){if(!(this instanceof h))return new h(b,d);h.superclass.constructor.apply(this,arguments)}d.extend(h,k,{_switchTrigger:function(d,g){var k=this.config;k.multiple?b.toggleClass(g,k.activeTriggerCls):h.superclass._switchTrigger.apply(this,arguments)},_triggerIsValid:function(b){return this.config.multiple||h.superclass._triggerIsValid.call(this,b)},_switchView:function(d,g,k){var q=this.config,l=this._getFromToPanels().toPanels;q.multiple?
(b.toggle(l),this._fireOnSwitch(g),k&&k.call(this)):h.superclass._switchView.apply(this,arguments)}});h.Config={markupType:1,triggerType:"click",multiple:!1};return h},{requires:["dom","../base"]});
KISSY.add("switchable/aria",function(d,b,k,h){function m(){this.stop&&this.stop()}function g(){this.start&&this.start()}h.addPlugin({name:"aria",init:function(b){if(b.config.aria){var d=b.container;k.on(d,"focusin",m,b);k.on(d,"focusout",g,b)}}});var n=["a","input","button","object"];return{setTabIndex:function(q,l){q.tabIndex=l;d.each(b.query("*",q),function(e){var f=e.nodeName.toLowerCase();d.inArray(f,n)&&(b.hasAttr(e,"oriTabIndex")||b.attr(e,"oriTabIndex",e.tabIndex),e.tabIndex=-1!=l?b.attr(e,
"oriTabIndex"):l)})}}},{requires:["dom","event","./base"]});
KISSY.add("switchable/autoplay",function(d,b,k,h,m){var g=d.Env.host,n=function(d){var l=b.scrollTop(),e=b.viewportHeight(),f=b.offset(d),d=b.height(d);return f.top>l&&f.top+d<l+e};d.mix(h.Config,{pauseOnScroll:!1,autoplay:!1,interval:5,pauseOnHover:!0});h.addPlugin({name:"autoplay",init:function(b){function l(){j=d.later(function(){b.paused||b.next()},f,!0)}var e=b.config,f=1E3*e.interval,j;if(e.autoplay&&(e.pauseOnScroll&&(b.__scrollDetect=d.buffer(function(){b[n(b.container)?"start":"stop"]()},
200),k.on(g,"scroll",b.__scrollDetect)),l(),b.stop=function(){if(j){j.cancel();j=m}b.paused=true},b.start=function(){if(j){j.cancel();j=m}b.paused=false;l()},e.pauseOnHover))k.on(b.container,"mouseenter",b.stop,b),k.on(b.container,"mouseleave",b.start,b)},destroy:function(b){b.__scrollDetect&&k.remove(g,"scroll",b.__scrollDetect)}});return h},{requires:["dom","event","./base"]});
KISSY.add("switchable/base",function(d,b,k,h){function m(a,c){this._triggerInternalCls=d.guid(f);this._panelInternalCls=d.guid(j);c=c||{};"markupType"in c||(c.panelCls?c.markupType=1:c.panels&&(c.markupType=2));for(var i=this.constructor;i;)c=d.merge(i.Config,c),i=i.superclass?i.superclass.constructor:null;this.container=b.get(a);this.config=c;this.activeIndex=c.activeIndex;var t;-1<this.activeIndex||("number"==typeof c.switchTo?t=c.switchTo:this.activeIndex=0);this._init();this._initPlugins();this.fire(l);
t!==h&&this.switchTo(t)}function g(a){var c={};c.type=a.type;c.target=a.target;return{originalEvent:c}}var n=d.makeArray,q=k.Target,l="init",e="remove",f="ks-switchable-trigger-internal",j="ks-switchable-panel-internal";m.getDomEvent=g;m.addPlugin=function(a,c){for(var c=c||m,b=a.priority=a.priority||0,t=0,p=c.Plugins=c.Plugins||[];t<p.length&&!(p[t].priority<b);t++);p.splice(t,0,a)};m.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",
panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:!0,triggerType:"mouse",delay:0.1,activeIndex:-1,activeTriggerCls:"ks-active",switchTo:h,steps:1,viewSize:[]};d.augment(m,q,{_initPlugins:function(){for(var a=this,c=[],b=a.constructor;b;)b.Plugins&&c.push.apply(c,[].concat(b.Plugins).reverse()),b=b.superclass?b.superclass.constructor:null;c.reverse();d.each(c,function(c){c.init&&c.init(a)})},_init:function(){var a=this.config;this._parseMarkup();a.hasTriggers&&this._bindTriggers();this._bindPanels()},
_parseMarkup:function(){var a=this.container,c=this.config,i,t,p=[],e=[];switch(c.markupType){case 0:(i=b.get("."+c.navCls,a))&&(p=b.children(i));t=b.get("."+c.contentCls,a);e=b.children(t);break;case 1:p=b.query("."+c.triggerCls,a);e=b.query("."+c.panelCls,a);break;case 2:p=c.triggers,e=c.panels}this.length=Math.ceil(e.length/c.steps);this.nav=i||c.hasTriggers&&p[0]&&p[0].parentNode;if(c.hasTriggers&&(!this.nav||0==p.length))p=this._generateTriggersMarkup(this.length);this.triggers=n(p);this.panels=
n(e);this.content=t||e[0].parentNode},_generateTriggersMarkup:function(a){var c=this.config,i=this.nav||b.create("<ul>"),e,p;i.className=c.navCls;for(p=0;p<a;p++)e=b.create("<li>"),p===this.activeIndex&&(e.className=c.activeTriggerCls),e.innerHTML=p+1,i.appendChild(e);this.container.appendChild(i);this.nav=i;return b.children(i)},_bindTriggers:function(){var a=this,c=a.config,b=a._triggerInternalCls,e=d.one(a.nav);d.each(a.triggers,function(c){a._initTrigger(c)});e.delegate("click","."+b,function(c){var b=
a._getTriggerIndex(c.currentTarget);a._onFocusTrigger(b,c)});"mouse"===c.triggerType&&e.delegate("mouseenter","."+b,function(c){var b=a._getTriggerIndex(c.currentTarget);a._onMouseEnterTrigger(b,c)}).delegate("mouseleave","."+b,function(){a._onMouseLeaveTrigger()})},_initTrigger:function(a){b.addClass(a,this._triggerInternalCls)},_bindPanels:function(){var a=this;d.each(a.panels,function(c){a._initPanel(c)})},_initPanel:function(a){b.addClass(a,this._panelInternalCls)},_onFocusTrigger:function(a,
c){this._triggerIsValid(a)&&(this._cancelSwitchTimer(),this.switchTo(a,h,g(c)))},_onMouseEnterTrigger:function(a,c){var b=this;if(b._triggerIsValid(a)){var e=g(c);b.switchTimer=d.later(function(){b.switchTo(a,h,e)},1E3*b.config.delay)}},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_triggerIsValid:function(a){return this.activeIndex!==a},_cancelSwitchTimer:function(){this.switchTimer&&(this.switchTimer.cancel(),this.switchTimer=h)},_getTriggerIndex:function(a){return d.indexOf(a,this.triggers)},
_resetLength:function(){this.length=this._getLength()},_getLength:function(a){var c=this.config;a===h&&(a=this.panels.length);return Math.ceil(a/c.steps)},_afterAdd:function(a,c,b){this._resetLength();a=this._getLength(a+1)-1;1==this.config.steps&&this.activeIndex>=a&&(this.activeIndex+=1);var e=this.activeIndex;this.activeIndex=-1;this.switchTo(e);c?this.switchTo(a,h,h,b):b()},add:function(a){var c=a.callback||d.noop,i=this.nav,e=this.content,f=a.trigger,j=a.panel,l=a.active,o=this.panels.length,
a=null!=a.index?a.index:o,h=this.triggers,g=this.panels,v=this.length,r=null,r=null,a=Math.max(0,Math.min(a,o)),o=g[a]||null;g.splice(a,0,j);e.insertBefore(j,o);1==this.config.steps?(r=h[a],i.insertBefore(f,r),h.splice(a,0,f)):(r=this._getLength(),r!=v&&(b.append(f,i),h.push(f)));this._initPanel(j);this._initTrigger(f);this._afterAdd(a,l,c);this.fire("add",{index:a,trigger:f,panel:j})},remove:function(a){function c(){v&&(b.remove(v),o.splice(g,1));if(q){b.remove(q);for(var a=0;a<k.length;a++)if(k[a]==
q){f.triggers.splice(a,1);break}}f._resetLength();f.fire(e,{index:g,trigger:q,panel:v})}var i=a.callback||d.noop,f=this,j=f.config.steps,l=f.length,g,o=f.panels;g="index"in a?a.index:a.panel;var a=f._getLength(o.length-1),k=f.triggers,q=null,v=null;if(o.length&&(g=d.isNumber(g)?Math.max(0,Math.min(g,o.length-1)):d.indexOf(g,o),q=1==j?k[g]:a!==l?k[l-1]:null,v=o[g],!1!==f.fire("beforeRemove",{index:g,panel:v,trigger:q})))if(0==a)c(),i();else{var r=f.activeIndex;1<j?r==a?f.switchTo(r-1,h,h,function(){c();
i()}):(c(),f.activeIndex=-1,f.switchTo(r,h,h,function(){i()})):r==g?f.switchTo(0<r?r-1:r+1,h,h,function(){c();0==r&&(f.activeIndex=0);i()}):(r>g&&(r--,f.activeIndex=r),c(),i())}},switchTo:function(a,c,b,f){var e=this,d=e.config,j=e.activeIndex,o=e.triggers;if(!e._triggerIsValid(a)||!1===e.fire("beforeSwitch",{fromIndex:j,toIndex:a}))return e;e.fromIndex=j;d.hasTriggers&&e._switchTrigger(o[j]||null,o[a]);c===h&&(c=a>j?"forward":"backward");e.activeIndex=a;e._switchView(c,b,function(){f&&f.call(e)});
return e},_switchTrigger:function(a,c){var e=this.config.activeTriggerCls;a&&b.removeClass(a,e);b.addClass(c,e)},_getFromToPanels:function(){var a=this.fromIndex,b;b=this.config.steps;var e=this.panels,f=this.activeIndex,a=-1<a?e.slice(a*b,(a+1)*b):null;b=e.slice(f*b,(f+1)*b);return{fromPanels:a,toPanels:b}},_switchView:function(a,c,e){var f=this,d=f._getFromToPanels(),a=d.fromPanels,d=d.toPanels;a&&b.css(a,"display","none");b.css(d,"display","block");setTimeout(function(){f._fireOnSwitch(c)},0);
e&&e.call(this)},_fireOnSwitch:function(a){this.fire("switch",d.merge(a,{fromIndex:this.fromIndex,currentIndex:this.activeIndex}))},prev:function(a){this.switchTo((this.activeIndex-1+this.length)%this.length,"backward",a)},next:function(a){this.switchTo((this.activeIndex+1)%this.length,"forward",a)},destroy:function(a){for(var c=this,e=c.constructor;e;)d.each(e.Plugins,function(a){a.destroy&&a.destroy(c)}),e=e.superclass?e.superclass.constructor:null;a?k.remove(c.container):b.remove(c.container);
c.nav=null;c.content=null;c.container=null;c.triggers=[];c.panels=[];c.detach()}});return m},{requires:["dom","event"]});
KISSY.add("switchable/carousel/aria",function(d,b,k,h,m,g){function n(a){var b=a.currentIndex,c=this.activeIndex,e=this.panels,f=e[b*this.config.steps],i=this.triggers,b=i[b];if((a=!(!a.originalEvent.target&&!a.originalEvent.srcElement))||-1==c)d.each(i,function(a){s(a,-1)}),d.each(e,function(a){s(a,-1)}),b&&s(b,0),s(f,0),a&&f.focus()}function q(a){var c=null;d.each(this.triggers,function(e){if(e==a||b.contains(e,a))return c=e,!1});return c}function l(e){var f=e.target;switch(e.keyCode){case t:case i:if(f=
q.call(this,f)){var j=b.next(f),g=this.triggers;j||(j=g[0]);s(f,-1);j&&(s(j,0),j.focus());e.halt()}break;case c:case a:if(f=q.call(this,f))j=b.prev(f),g=this.triggers,j||(j=g[g.length-1]),s(f,-1),j&&(s(j,0),j.focus()),e.halt();break;case u:case p:if(f=q.call(this,f))this.switchTo(d.indexOf(f,this.triggers),void 0,o),e.halt()}}function e(a){var c=null;d.each(this.panels,function(e){if(e==a||b.contains(e,a))return c=e,!1});return c}function f(a,b){var c=d.indexOf(a,this.panels),e=this.config.steps,
f=Math.floor(c/e);return f==this.activeIndex?1:0==c%e||c%e==e-1?(this.switchTo(f,b,o),0):1}function j(j){var d=j.target;switch(j.keyCode){case t:case i:if(d=e.call(this,d)){var o=b.next(d),g=this.panels;o||(o=g[0]);s(d,-1);s(o,0);f.call(this,o,x)&&o.focus();j.halt()}break;case c:case a:if(d=e.call(this,d))o=b.prev(d),g=this.panels,o||(o=g[g.length-1]),s(d,-1),s(o,0),f.call(this,o,w)&&o.focus(),j.halt();break;case u:case p:if(d=e.call(this,d))this.fire("itemSelected",{item:d}),j.halt()}}var a=37,c=
38,i=39,t=40,p=32,u=13,s=h.setTabIndex,o={originalEvent:{target:1}},x="forward",w="backward";d.mix(m.Config,{aria:!1});g.addPlugin({name:"aria",init:function(a){if(a.config.aria){var b=a.triggers,c=a.panels,e=a.content,f=a.activeIndex;e.id||(e.id=d.guid("ks-switchbale-content"));e.setAttribute("role","listbox");var i=0;d.each(b,function(a){s(a,f==i?"0":"-1");a.setAttribute("role","button");a.setAttribute("aria-controls",e.id);i++});i=0;d.each(c,function(a){s(a,"-1");a.setAttribute("role","option");
i++});a.on("switch",n,a);if(b=a.nav)k.on(b,"keydown",l,a);k.on(e,"keydown",j,a);b=a.prevBtn;c=a.nextBtn;b&&(s(b,0),b.setAttribute("role","button"),k.on(b,"keydown",function(b){if(b.keyCode==u||b.keyCode==p){a.prev(o);b.preventDefault()}}));c&&(s(c,0),c.setAttribute("role","button"),k.on(c,"keydown",function(b){if(b.keyCode==u||b.keyCode==p){a.next(o);b.preventDefault()}}))}}},m)},{requires:["dom","event","../aria","./base","../base"]});
KISSY.add("switchable/carousel/base",function(d,b,k,h){function m(b,e){if(!(this instanceof m))return new m(b,e);m.superclass.constructor.apply(this,arguments)}var g="prevBtn",n="nextBtn",q={originalEvent:{target:1}};m.Config={circular:!0,prevBtnCls:"ks-switchable-prev-btn",nextBtnCls:"ks-switchable-next-btn",disableBtnCls:"ks-switchable-disable-btn"};d.extend(m,h,{_init:function(){function l(a){b.removeClass([e[g],e[n]],j);0==a&&b.addClass(e[g],j);a==e.length-1&&b.addClass(e[n],j)}var e=this;m.superclass._init.call(e);
var f=e.config,j=f.disableBtnCls;d.each(["prev","next"],function(a){var c=e[a+"Btn"]=b.get("."+f[a+"BtnCls"],e.container);k.on(c,"mousedown",function(b){b.preventDefault();b=e.activeIndex;if("prev"==a&&(0!=b||f.circular))e[a](q);if("next"==a&&(b!=e.length-1||f.circular))e[a](q)})});f.circular||(e.on("added removed",function(){l(e.activeIndex)}),e.on("switch",function(a){l(a.currentIndex)}));k.delegate(e.content,"click","."+e._panelInternalCls,function(a){e.fire("itemSelected",{item:a.currentTarget})})}});
return m},{requires:["dom","event","../base"]});
KISSY.add("switchable/circular",function(d,b,k,h){function m(e){var f=this,j=f.fromIndex,a=f.config,c=f.length,d="scrollx"===a.scrollType,g=d?"left":"top",h=f.activeIndex,d=f.viewSize[d?0:1],q=f.panels,m={},o={},n,w=f._realStep;n=d*c;m[g]=-d*h;-1==j?(b.css(f.content,m),e&&e()):(h+w>c?(o={position:"relative"},o[g]=n,n=h+w-c,b.css(q.slice(0,n),o),b.css(q.slice(n,w),l)):b.css(q.slice(0,w),l),q=b.css(q[j],"position"),(j+c-h)%c<(h-j+c)%c&&"relative"==q?b.css(f.content,g,-(d*(c+j))):j==c-1&&0==h?b.css(f.content,
g,d):b.css(f.content,g,-(d*j)),f.anim&&f.anim.stop(),f.anim=(new k(f.content,m,a.duration,a.easing,function(){f.anim=0;e&&e()})).run())}function g(e,f){var d=this,a=d.fromIndex,c=d.config,i=d.length,g="scrollx"===c.scrollType,h=g?"left":"top",l=d.activeIndex,m=d.viewSize[g?0:1],g=-m*l,o=d.panels,x=d.config.steps,w={},v,r="backward"===f;v=r&&0===a&&l===i-1||!r&&a===i-1&&0===l;d.anim&&(d.anim.stop(),"relative"==o[a*x].style.position&&q.call(d,o,a,h,m,1));v&&(g=n.call(d,o,l,h,m));w[h]=g+"px";-1<a?d.anim=
(new k(d.content,w,c.duration,c.easing,function(){v&&q.call(d,o,l,h,m,1);d.anim=void 0;e&&e()})).run():(b.css(d.content,w),e&&e())}function n(e,f,d,a){var c=this.config.steps,g=this.length,e=e.slice(f*c,(f+1)*c);b.css(e,"position","relative");b.css(e,d,(f?-1:1)*a*g);return f?a:-a*g}function q(e,f,d,a,c){var g=this.config.steps,h=this.length,e=e.slice(f*g,(f+1)*g);b.css(e,"position","");b.css(e,d,"");c&&b.css(this.content,d,f?-a*(h-1):"")}var l={position:"",left:"",top:""};d.mix(h.Config,{circular:!1});
h.adjustPosition=n;h.resetPosition=q;h.addPlugin({name:"circular",priority:5,init:function(e){var f=e.config,d,a,c,i,h=f.effect;if(f.circular&&("scrollx"===h||"scrolly"===h))if(f.scrollType=h,c=e.panels,i=e.container,1==f.steps&&c.length&&(d=1,a=c[0].parentNode.parentNode,a=[Math.min(b.width(i),b.width(a)),Math.min(b.height(i),b.height(a))],"scrollx"==h?d=Math.floor(a[0]/b.outerWidth(c[0],!0)):"scrolly"==h&&(d=Math.floor(a[1]/b.outerHeight(c[0],!0))),d>f.steps&&(e._realStep=d,f.effect=m)),!e._realStep)f.effect=
g}})},{requires:["dom","anim","./base","./effect"]});
KISSY.add("switchable/effect",function(d,b,k,h,m,g){var n;d.mix(m.Config,{effect:"none",duration:0.5,easing:"easeNone"});m.Effects={none:function(d){var g=this._getFromToPanels(),e=g.fromPanels,g=g.toPanels;e&&b.css(e,"display","none");b.css(g,"display","block");d&&d()},fade:function(d){var l=this,e=l._getFromToPanels(),f=e.fromPanels,j=l.config,a=f?f[0]:null,c=e.toPanels[0];l.anim&&(l.anim.stop(),b.css(l.anim.fromEl,{zIndex:1,opacity:0}),b.css(l.anim.toEl,"zIndex",9));b.css(c,"opacity",1);a?(l.anim=
(new h(a,{opacity:0},j.duration,j.easing,function(){l.anim=g;b.css(c,"z-index",9);b.css(a,"z-index",1);d&&d()})).run(),l.anim.toEl=c,l.anim.fromEl=a):(b.css(c,"z-index",9),d&&d())},scroll:function(d,l,e){var f=this,l=f.fromIndex,j=f.config,a="scrollx"===j.effect,c={};c[a?"left":"top"]=-(f.viewSize[a?0:1]*f.activeIndex)+"px";f.anim&&f.anim.stop();e||-1<l?f.anim=(new h(f.content,c,j.duration,j.easing,function(){f.anim=g;d&&d()})).run():(b.css(f.content,c),d&&d())}};n=m.Effects;n.scrollx=n.scrolly=n.scroll;
m.addPlugin({priority:10,name:"effect",init:function(g){var h=g.config,e=h.effect,f=g.panels,j=g.content,a=h.steps,c=f[0],i=g.activeIndex;if("none"!==e)switch(b.css(f,"display","block"),e){case "scrollx":case "scrolly":b.css(j,"position","absolute");"static"==b.css(j.parentNode,"position")&&b.css(j.parentNode,"position","relative");"scrollx"===e&&(b.css(f,"float","left"),b.width(j,"9999px"));g.viewSize=[h.viewSize[0]||c&&b.outerWidth(c,!0)*a,h.viewSize[1]||c&&b.outerHeight(c,!0)*a];break;case "fade":var k=
i*a,m=k+a-1,n;d.each(f,function(a,c){n=c>=k&&c<=m;b.css(a,{opacity:n?1:0,position:"absolute",zIndex:n?9:1})})}}});d.augment(m,{_switchView:function(b,g,e){var f=this,h=f.config.effect;(d.isFunction(h)?h:n[h]).call(f,function(){f._fireOnSwitch(g);e&&e.call(f)},b)}});return m},{requires:["dom","event","anim","./base"]});
KISSY.add("switchable/lazyload",function(d,b,k){var h="beforeSwitch",m="img",g="textarea",n={};n[m]="lazyImgAttribute";n[g]="lazyTextareaClass";d.mix(k.Config,{lazyImgAttribute:"data-ks-lazyload-custom",lazyTextareaClass:"ks-datalazyload-custom",lazyDataType:g});k.addPlugin({name:"lazyload",init:function(k){function l(c){var d=f.steps,c=c.toIndex*d;e.loadCustomLazyData(k.panels.slice(c,c+d),j,a);a:{var n,p,u;if(c=(d=j===m)?"img":j===g?"textarea":""){c=b.query(c,k.container);n=0;for(u=c.length;n<u;n++)if(p=
c[n],d?b.attr(p,a):b.hasClass(p,a)){d=!1;break a}}d=!0}d&&k.detach(h,l)}var e=d.require("datalazyload"),f=k.config,j,a;"img-src"===f.lazyDataType&&(f.lazyDataType=m);"area-data"===f.lazyDataType&&(f.lazyDataType=g);j=f.lazyDataType;a=f[n[j]];if(e&&j&&a)k.on(h,l)}});return k},{requires:["dom","./base"]});
KISSY.add("switchable/slide/base",function(d,b){function k(b,d){if(!(this instanceof k))return new k(b,d);k.superclass.constructor.apply(this,arguments)}k.Config={autoplay:!0,circular:!0};d.extend(k,b);return k},{requires:["../base"]});KISSY.add("switchable",function(d,b,k,h,m,g){d.mix(b,{Accordion:k,Carousel:h,Slide:m,Tabs:g});return d.Switchable=b},{requires:"switchable/base,switchable/accordion/base,switchable/carousel/base,switchable/slide/base,switchable/tabs/base,switchable/lazyload,switchable/effect,switchable/circular,switchable/carousel/aria,switchable/autoplay,switchable/aria,switchable/tabs/aria,switchable/accordion/aria".split(",")});
KISSY.add("switchable/tabs/aria",function(d,b,k,h,m,g){function n(a){var c=null;d.each(this.triggers,function(d){if(d==a||b.contains(d,a))c=d});return c}function q(a){switch(a.keyCode){case f:case j:a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.halt();break;case p:a.ctrlKey&&!a.altKey&&a.halt()}}function l(b){var d=b.target,e=b.ctrlKey&&!b.shiftKey&&!b.altKey;switch(b.keyCode){case a:case c:n.call(this,d)&&(this.prev(s(b)),b.halt());break;case i:case t:n.call(this,d)&&(this.next(s(b)),b.halt());break;case j:e&&
(b.halt(),this.next(s(b)));break;case f:e&&(b.halt(),this.prev(s(b)));break;case p:b.ctrlKey&&!b.altKey&&(b.halt(),b.shiftKey?this.prev(s(b)):this.next(s(b)))}}function e(a){var b=!(!a.originalEvent.target&&!a.originalEvent.srcElement),c=a.fromIndex,d=a.currentIndex;if(c!=d){var a=this.triggers[c],e=this.triggers[d],c=this.panels[c],d=this.panels[d];a&&u(a,"-1");u(e,"0");b&&e.focus();c&&c.setAttribute("aria-hidden","true");d.setAttribute("aria-hidden","false")}}var f=33,j=34,a=37,c=38,i=39,t=40,p=
9;d.mix(g.Config,{aria:!0});h.addPlugin({name:"aria",init:function(a){function c(a){a.setAttribute("role","tab");u(a,"-1");a.id||(a.id=d.guid("ks-switchable"))}function f(a,b){a.setAttribute("role","tabpanel");a.setAttribute("aria-hidden","true");a.setAttribute("aria-labelledby",b.id)}if(a.config.aria){var g=a.triggers,h=a.activeIndex,i=a.panels,j=a.container;a.nav&&b.attr(a.nav,"role","tablist");var m=0;d.each(g,c);a.on("added",function(a){var b;c(b=a.trigger);f(a.panel,b)});m=0;d.each(i,function(a){f(a,
g[m]);m++});-1<h&&(u(g[h],"0"),i[h].setAttribute("aria-hidden","false"));a.on("switch",e,a);k.on(j,"keydown",l,a);k.on(j,"keypress",q,a)}}},g);var u=m.setTabIndex,s=h.getDomEvent},{requires:["dom","event","../base","../aria","./base"]});KISSY.add("switchable/tabs/base",function(d,b){function k(b,d){if(!(this instanceof k))return new k(b,d);k.superclass.constructor.call(this,b,d);return 0}d.extend(k,b);k.Config={};return k},{requires:["../base"]});
KISSY.add("switchable/touch",function(d,b,k,h,m){d.mix(h.Config,{mouseAsTouch:!1});h.addPlugin({name:"touch",init:function(g){if(!g._realStep){var n=g.config,q=n.scrollType||n.effect;if("scrolly"==q||"scrollx"==q){var l=g.content,e=g.container,f,j=n.mouseAsTouch,a,c=0,i=0,t={},p={},u="left",s,o;"scrolly"==q&&(u="top");var x=function(){if("relative"!=g.panels[g.activeIndex].style.position){g.stop&&g.stop();i=1;t=b.offset(l);var a=b.offset(e);a.bottom=a.top+e.offsetHeight;a.right=a.left+e.offsetWidth;
p=a}},w=function(d){if(i){var e=-1!=d.type.indexOf("touch")?d.originalEvent.changedTouches[0]:d,j={};"scrolly"==q?(o=g.viewSize[1],s=e.pageY-a,j.top=t.top+s,e=e.pageY>=p.top&&e.pageY<=p.bottom):(o=g.viewSize[0],s=e.pageX-f,j.left=t.left+s,e=e.pageX>=p.left&&e.pageX<=p.right);if(c||3<Math.abs(s))(-1!=d.type.indexOf("touch")&&d.preventDefault(),g.anim&&(g.anim.stop(),g.anim=m),e)?(c||(c=1,n.circular&&(d=g.activeIndex,e=g.length-1,d==e?h.adjustPosition.call(g,g.panels,0,u,o):0==d&&h.adjustPosition.call(g,
g.panels,e,u,o))),b.offset(l,j)):v()}},v=function(){if(c){i=c=0;var a=g.activeIndex,b=g.length-1;if(!n.circular&&(0>s&&a==b||0<s&&0==a))h.Effects[q].call(g,m,m,!0);else{if(!(0>s&&a==b)&&!(0<s&&0==a)&&(0==a||a==b))h.resetPosition.call(g,g.panels,0==a?b:0,u,o);g[0>s?"next":"prev"]();g.start&&g.start()}}};j?d.use("dd",function(b,c){var d=new c.Draggable({node:l});d.on("dragstart",function(){x();f=d.startMousePos.left;a=d.startMousePos.top});d.on("drag",w);d.on("dragend",v);g.__touchDD=d}):(k.on(l,"touchstart",
function(b){x();f=b.pageX;a=b.pageY}),k.on(l,"touchmove",w),k.on(l,"touchend",v))}}},destroy:function(b){var d;(d=b.__touchDD)&&d.destroy()}})},{requires:["dom","event","./base"]});
