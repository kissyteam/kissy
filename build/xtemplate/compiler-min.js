/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Jul 4 20:33
*/
KISSY.add("xtemplate/compiler/parser",function(){var h={},a=KISSY,i=function(b){this.rules=[];a.mix(this,b);this.resetInput(this.input)};i.prototype={constructor:function(b){this.rules=[];a.mix(this,b);this.resetInput(this.input)},resetInput:function(b){a.mix(this,{input:b,matched:"",stateStack:[i.STATIC.INITIAL],match:"",text:"",firstLine:1,lineNumber:1,lastLine:1,firstColumn:1,lastColumn:1})},getCurrentRules:function(){var b=this.stateStack[this.stateStack.length-1],d=[],b=this.mapState(b);a.each(this.rules,
function(f){var e=f.state||f[3];e?a.inArray(b,e)&&d.push(f):b==i.STATIC.INITIAL&&d.push(f)});return d},pushState:function(b){this.stateStack.push(b)},popState:function(){return this.stateStack.pop()},getStateStack:function(){return this.stateStack},showDebugInfo:function(){var b=i.STATIC.DEBUG_CONTEXT_LIMIT,d=this.matched,f=this.match,a=this.input,d=d.slice(0,d.length-f.length),d=(d.length>b?"...":"")+d.slice(-b).replace(/\n/," "),f=f+a,f=f.slice(0,b)+(f.length>b?"...":"");return d+f+"\n"+Array(d.length+
1).join("-")+"^"},mapSymbol:function(b){var d=this.symbolMap;return!d?b:d[b]||(d[b]=++this.symbolId)},mapReverseSymbol:function(b){var d=this.symbolMap,f,a=this.reverseSymbolMap;if(!a&&d)for(f in a=this.reverseSymbolMap={},d)a[d[f]]=f;return a?a[b]:b},mapState:function(b){var d=this.stateMap;return!d?b:d[b]||(d[b]=++this.stateId)},lex:function(){var b=this.input,d,f,e,q=this.getCurrentRules();this.match=this.text="";if(!b)return this.mapSymbol(i.STATIC.END_TAG);for(d=0;d<q.length;d++){f=q[d];var h=
f.token||f[0];e=f.action||f[2]||void 0;if(f=b.match(f.regexp||f[1])){if(d=f[0].match(/\n.*/g))this.lineNumber+=d.length;a.mix(this,{firstLine:this.lastLine,lastLine:this.lineNumber+1,firstColumn:this.lastColumn,lastColumn:d?d[d.length-1].length-1:this.lastColumn+f[0].length});d=this.match=f[0];this.matches=f;this.text=d;this.matched+=d;e=e&&e.call(this);e=void 0==e?h:this.mapSymbol(e);this.input=b=b.slice(d.length);return e?e:this.lex()}}}};i.STATIC={INITIAL:"I",DEBUG_CONTEXT_LIMIT:20,END_TAG:"$EOF"};
var e=new i({rules:[[0,/^(\\[\s\S]|[\s\S])*?(?={{)/,function(){var b=this.text,d,f=0;if(d=b.match(/\\+$/))f=d[0].length;f%2?(b=b.slice(0,-1),this.pushState("et")):this.pushState("t");this.text=b;return"CONTENT"}],[2,/^[\s\S]+/,0],[2,/^[\s\S]{2,}?(?:(?={{)|$)/,function(){this.popState()},["et"]],[3,/^{{(?:#|@|\^)/,0,["t"]],[4,/^{{\//,0,["t"]],[5,/^{{\s*else\s*}}/,function(){this.popState()},["t"]],[0,/^{{![\s\S]*?}}/,function(){this.popState()},["t"]],[2,/^{{%([\s\S]*?)%}}/,function(){this.text=this.matches[1]||
"";this.popState()},["t"]],[6,/^{{{?/,0,["t"]],[0,/^\s+/,0,["t"]],[7,/^}}}?/,function(){this.popState()},["t"]],[8,/^\(/,0,["t"]],[9,/^\)/,0,["t"]],[10,/^\|\|/,0,["t"]],[11,/^&&/,0,["t"]],[12,/^===/,0,["t"]],[13,/^!==/,0,["t"]],[15,/^>=/,0,["t"]],[17,/^<=/,0,["t"]],[14,/^>/,0,["t"]],[16,/^</,0,["t"]],[18,/^\+/,0,["t"]],[19,/^-/,0,["t"]],[20,/^\*/,0,["t"]],[21,/^\//,0,["t"]],[22,/^%/,0,["t"]],[23,/^!/,0,["t"]],[24,/^"(\\"|[^"])*"/,function(){this.text=this.text.slice(1,-1).replace(/\\"/g,'"')},["t"]],
[24,/^'(\\'|[^'])*'/,function(){this.text=this.text.slice(1,-1).replace(/\\'/g,"'")},["t"]],[25,/^true/,0,["t"]],[25,/^false/,0,["t"]],[26,/^\d+(?:\.\d+)?(?:e-?\d+)?/i,0,["t"]],[27,/^=/,0,["t"]],[28,/^\.(?=})/,0,["t"]],[28,/^\.\./,function(){this.pushState("ws")},["t"]],[29,/^\//,function(){this.popState()},["ws"]],[29,/^\./,0,["t"]],[30,/^\[/,0,["t"]],[31,/^\]/,0,["t"]],[28,/^[a-zA-Z0-9_$]+/,0,["t"]],[32,/^./,0,["t"]]]});h.lexer=e;e.symbolMap={$EOF:1,CONTENT:2,OPEN_BLOCK:3,OPEN_CLOSE_BLOCK:4,INVERSE:5,
OPEN_TPL:6,CLOSE:7,LPAREN:8,RPAREN:9,OR:10,AND:11,LOGIC_EQUALS:12,LOGIC_NOT_EQUALS:13,GT:14,GE:15,LT:16,LE:17,PLUS:18,MINUS:19,MULTIPLY:20,DIVIDE:21,MODULUS:22,NOT:23,STRING:24,BOOLEAN:25,NUMBER:26,EQUALS:27,ID:28,SEP:29,REF_START:30,REF_END:31,INVALID:32,$START:33,program:34,statements:35,statement:36,openBlock:37,closeBlock:38,tpl:39,inBlockTpl:40,path:41,inTpl:42,Expression:43,params:44,hash:45,param:46,ConditionalOrExpression:47,ConditionalAndExpression:48,EqualityExpression:49,RelationalExpression:50,
AdditiveExpression:51,MultiplicativeExpression:52,UnaryExpression:53,PrimaryExpression:54,hashSegments:55,hashSegment:56,pathSegments:57};h.productions=[[33,[34]],[34,[35,5,35],function(){return new this.yy.ProgramNode(this.lexer.lineNumber,this.$1,this.$3)}],[34,[35],function(){return new this.yy.ProgramNode(this.lexer.lineNumber,this.$1)}],[35,[36],function(){return[this.$1]}],[35,[35,36],function(){this.$1.push(this.$2)}],[36,[37,34,38],function(){return new this.yy.BlockNode(this.lexer.lineNumber,
this.$1,this.$2,this.$3)}],[36,[39]],[36,[2],function(){return new this.yy.ContentNode(this.lexer.lineNumber,this.$1)}],[40,[41],function(){return new this.yy.TplNode(this.lexer.lineNumber,this.$1)}],[40,[42]],[37,[3,40,7],function(){"^"==this.$1.charAt(this.$1.length-1)&&(this.$2.isInverted=1);return this.$2}],[38,[4,41,7],function(){return this.$2}],[39,[6,42,7],function(){3===this.$1.length&&(this.$2.escaped=!1);return this.$2}],[39,[6,43,7],function(){var b=new this.yy.TplExpressionNode(this.lexer.lineNumber,
this.$2);3===this.$1.length&&(b.escaped=!1);return b}],[42,[41,44,45],function(){return new this.yy.TplNode(this.lexer.lineNumber,this.$1,this.$2,this.$3)}],[42,[41,44],function(){return new this.yy.TplNode(this.lexer.lineNumber,this.$1,this.$2)}],[42,[41,45],function(){return new this.yy.TplNode(this.lexer.lineNumber,this.$1,null,this.$2)}],[44,[44,46],function(){this.$1.push(this.$2)}],[44,[46],function(){return[this.$1]}],[46,[43]],[43,[47]],[47,[48]],[47,[47,10,48],function(){return new this.yy.ConditionalOrExpression(this.$1,
this.$3)}],[48,[49]],[48,[48,11,49],function(){return new this.yy.ConditionalAndExpression(this.$1,this.$3)}],[49,[50]],[49,[49,12,50],function(){return new this.yy.EqualityExpression(this.$1,"===",this.$3)}],[49,[49,13,50],function(){return new this.yy.EqualityExpression(this.$1,"!==",this.$3)}],[50,[51]],[50,[50,16,51],function(){return new this.yy.RelationalExpression(this.$1,"<",this.$3)}],[50,[50,14,51],function(){return new this.yy.RelationalExpression(this.$1,">",this.$3)}],[50,[50,17,51],
function(){return new this.yy.RelationalExpression(this.$1,"<=",this.$3)}],[50,[50,15,51],function(){return new this.yy.RelationalExpression(this.$1,">=",this.$3)}],[51,[52]],[51,[51,18,52],function(){return new this.yy.AdditiveExpression(this.$1,"+",this.$3)}],[51,[51,19,52],function(){return new this.yy.AdditiveExpression(this.$1,"-",this.$3)}],[52,[53]],[52,[52,20,53],function(){return new this.yy.MultiplicativeExpression(this.$1,"*",this.$3)}],[52,[52,21,53],function(){return new this.yy.MultiplicativeExpression(this.$1,
"/",this.$3)}],[52,[52,22,53],function(){return new this.yy.MultiplicativeExpression(this.$1,"%",this.$3)}],[53,[23,53],function(){return new this.yy.UnaryExpression(this.$1)}],[53,[54]],[54,[24],function(){return new this.yy.StringNode(this.lexer.lineNumber,this.$1)}],[54,[26],function(){return new this.yy.NumberNode(this.lexer.lineNumber,this.$1)}],[54,[25],function(){return new this.yy.BooleanNode(this.lexer.lineNumber,this.$1)}],[54,[41]],[54,[8,43,9],function(){return this.$2}],[45,[55],function(){return new this.yy.HashNode(this.lexer.lineNumber,
this.$1)}],[55,[55,56],function(){this.$1.push(this.$2)}],[55,[56],function(){return[this.$1]}],[56,[28,27,43],function(){return[this.$1,this.$3]}],[41,[57],function(){return new this.yy.IdNode(this.lexer.lineNumber,this.$1)}],[57,[57,29,28],function(){this.$1.push(this.$3)}],[57,[57,30,43,31],function(){this.$1.push(this.$3)}],[57,[57,29,26],function(){this.$1.push(this.$3)}],[57,[28],function(){return[this.$1]}]];h.table={gotos:{"0":{34:4,35:5,36:6,37:7,39:8},2:{40:10,41:11,42:12,57:13},3:{41:19,
42:20,43:21,47:22,48:23,49:24,50:25,51:26,52:27,53:28,54:29,57:13},5:{36:31,37:7,39:8},7:{34:32,35:5,36:6,37:7,39:8},11:{41:35,43:36,44:37,45:38,46:39,47:22,48:23,49:24,50:25,51:26,52:27,53:28,54:29,55:40,56:41,57:13},14:{41:35,43:44,47:22,48:23,49:24,50:25,51:26,52:27,53:28,54:29,57:13},15:{41:35,53:45,54:29,57:13},19:{41:35,43:36,44:37,45:38,46:39,47:22,48:23,49:24,50:25,51:26,52:27,53:28,54:29,55:40,56:41,57:13},30:{35:61,36:6,37:7,39:8},32:{38:63},37:{41:35,43:36,45:65,46:66,47:22,48:23,49:24,
50:25,51:26,52:27,53:28,54:29,55:40,56:41,57:13},40:{56:68},43:{41:35,43:71,47:22,48:23,49:24,50:25,51:26,52:27,53:28,54:29,57:13},48:{41:35,48:73,49:24,50:25,51:26,52:27,53:28,54:29,57:13},49:{41:35,49:74,50:25,51:26,52:27,53:28,54:29,57:13},50:{41:35,50:75,51:26,52:27,53:28,54:29,57:13},51:{41:35,50:76,51:26,52:27,53:28,54:29,57:13},52:{41:35,51:77,52:27,53:28,54:29,57:13},53:{41:35,51:78,52:27,53:28,54:29,57:13},54:{41:35,51:79,52:27,53:28,54:29,57:13},55:{41:35,51:80,52:27,53:28,54:29,57:13},
56:{41:35,52:81,53:28,54:29,57:13},57:{41:35,52:82,53:28,54:29,57:13},58:{41:35,53:83,54:29,57:13},59:{41:35,53:84,54:29,57:13},60:{41:35,53:85,54:29,57:13},61:{36:31,37:7,39:8},62:{41:86,57:13},64:{41:35,43:87,47:22,48:23,49:24,50:25,51:26,52:27,53:28,54:29,57:13}},action:{"0":{2:[1,void 0,1],3:[1,void 0,2],6:[1,void 0,3]},1:{1:[2,7],2:[2,7],3:[2,7],4:[2,7],5:[2,7],6:[2,7]},2:{28:[1,void 0,9]},3:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},
4:{1:[0]},5:{1:[2,2],2:[1,void 0,1],3:[1,void 0,2],4:[2,2],5:[1,void 0,30],6:[1,void 0,3]},6:{1:[2,3],2:[2,3],3:[2,3],4:[2,3],5:[2,3],6:[2,3]},7:{2:[1,void 0,1],3:[1,void 0,2],6:[1,void 0,3]},8:{1:[2,6],2:[2,6],3:[2,6],4:[2,6],5:[2,6],6:[2,6]},9:{7:[2,55],8:[2,55],9:[2,55],10:[2,55],11:[2,55],12:[2,55],13:[2,55],14:[2,55],15:[2,55],16:[2,55],17:[2,55],18:[2,55],19:[2,55],20:[2,55],21:[2,55],22:[2,55],23:[2,55],24:[2,55],25:[2,55],26:[2,55],28:[2,55],29:[2,55],30:[2,55],31:[2,55]},10:{7:[1,void 0,
33]},11:{7:[2,8],8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,34]},12:{7:[2,9]},13:{7:[2,51],8:[2,51],9:[2,51],10:[2,51],11:[2,51],12:[2,51],13:[2,51],14:[2,51],15:[2,51],16:[2,51],17:[2,51],18:[2,51],19:[2,51],20:[2,51],21:[2,51],22:[2,51],23:[2,51],24:[2,51],25:[2,51],26:[2,51],28:[2,51],29:[1,void 0,42],30:[1,void 0,43],31:[2,51]},14:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},15:{8:[1,
void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},16:{7:[2,42],8:[2,42],9:[2,42],10:[2,42],11:[2,42],12:[2,42],13:[2,42],14:[2,42],15:[2,42],16:[2,42],17:[2,42],18:[2,42],19:[2,42],20:[2,42],21:[2,42],22:[2,42],23:[2,42],24:[2,42],25:[2,42],26:[2,42],28:[2,42],31:[2,42]},17:{7:[2,44],8:[2,44],9:[2,44],10:[2,44],11:[2,44],12:[2,44],13:[2,44],14:[2,44],15:[2,44],16:[2,44],17:[2,44],18:[2,44],19:[2,44],20:[2,44],21:[2,44],22:[2,44],23:[2,44],24:[2,44],25:[2,
44],26:[2,44],28:[2,44],31:[2,44]},18:{7:[2,43],8:[2,43],9:[2,43],10:[2,43],11:[2,43],12:[2,43],13:[2,43],14:[2,43],15:[2,43],16:[2,43],17:[2,43],18:[2,43],19:[2,43],20:[2,43],21:[2,43],22:[2,43],23:[2,43],24:[2,43],25:[2,43],26:[2,43],28:[2,43],31:[2,43]},19:{7:[2,45],8:[1,void 0,14],10:[2,45],11:[2,45],12:[2,45],13:[2,45],14:[2,45],15:[2,45],16:[2,45],17:[2,45],18:[2,45],19:[2,45],20:[2,45],21:[2,45],22:[2,45],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,34]},
20:{7:[1,void 0,46]},21:{7:[1,void 0,47]},22:{7:[2,20],8:[2,20],9:[2,20],10:[1,void 0,48],23:[2,20],24:[2,20],25:[2,20],26:[2,20],28:[2,20],31:[2,20]},23:{7:[2,21],8:[2,21],9:[2,21],10:[2,21],11:[1,void 0,49],23:[2,21],24:[2,21],25:[2,21],26:[2,21],28:[2,21],31:[2,21]},24:{7:[2,23],8:[2,23],9:[2,23],10:[2,23],11:[2,23],12:[1,void 0,50],13:[1,void 0,51],23:[2,23],24:[2,23],25:[2,23],26:[2,23],28:[2,23],31:[2,23]},25:{7:[2,25],8:[2,25],9:[2,25],10:[2,25],11:[2,25],12:[2,25],13:[2,25],14:[1,void 0,52],
15:[1,void 0,53],16:[1,void 0,54],17:[1,void 0,55],23:[2,25],24:[2,25],25:[2,25],26:[2,25],28:[2,25],31:[2,25]},26:{7:[2,28],8:[2,28],9:[2,28],10:[2,28],11:[2,28],12:[2,28],13:[2,28],14:[2,28],15:[2,28],16:[2,28],17:[2,28],18:[1,void 0,56],19:[1,void 0,57],23:[2,28],24:[2,28],25:[2,28],26:[2,28],28:[2,28],31:[2,28]},27:{7:[2,33],8:[2,33],9:[2,33],10:[2,33],11:[2,33],12:[2,33],13:[2,33],14:[2,33],15:[2,33],16:[2,33],17:[2,33],18:[2,33],19:[2,33],20:[1,void 0,58],21:[1,void 0,59],22:[1,void 0,60],23:[2,
33],24:[2,33],25:[2,33],26:[2,33],28:[2,33],31:[2,33]},28:{7:[2,36],8:[2,36],9:[2,36],10:[2,36],11:[2,36],12:[2,36],13:[2,36],14:[2,36],15:[2,36],16:[2,36],17:[2,36],18:[2,36],19:[2,36],20:[2,36],21:[2,36],22:[2,36],23:[2,36],24:[2,36],25:[2,36],26:[2,36],28:[2,36],31:[2,36]},29:{7:[2,41],8:[2,41],9:[2,41],10:[2,41],11:[2,41],12:[2,41],13:[2,41],14:[2,41],15:[2,41],16:[2,41],17:[2,41],18:[2,41],19:[2,41],20:[2,41],21:[2,41],22:[2,41],23:[2,41],24:[2,41],25:[2,41],26:[2,41],28:[2,41],31:[2,41]},30:{2:[1,
void 0,1],3:[1,void 0,2],6:[1,void 0,3]},31:{1:[2,4],2:[2,4],3:[2,4],4:[2,4],5:[2,4],6:[2,4]},32:{4:[1,void 0,62]},33:{2:[2,10],3:[2,10],6:[2,10]},34:{7:[2,55],8:[2,55],10:[2,55],11:[2,55],12:[2,55],13:[2,55],14:[2,55],15:[2,55],16:[2,55],17:[2,55],18:[2,55],19:[2,55],20:[2,55],21:[2,55],22:[2,55],23:[2,55],24:[2,55],25:[2,55],26:[2,55],27:[1,void 0,64],28:[2,55],29:[2,55],30:[2,55]},35:{7:[2,45],8:[2,45],9:[2,45],10:[2,45],11:[2,45],12:[2,45],13:[2,45],14:[2,45],15:[2,45],16:[2,45],17:[2,45],18:[2,
45],19:[2,45],20:[2,45],21:[2,45],22:[2,45],23:[2,45],24:[2,45],25:[2,45],26:[2,45],28:[2,45],31:[2,45]},36:{7:[2,19],8:[2,19],23:[2,19],24:[2,19],25:[2,19],26:[2,19],28:[2,19]},37:{7:[2,15],8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,34]},38:{7:[2,16]},39:{7:[2,18],8:[2,18],23:[2,18],24:[2,18],25:[2,18],26:[2,18],28:[2,18]},40:{7:[2,47],28:[1,void 0,67]},41:{7:[2,49],28:[2,49]},42:{26:[1,void 0,69],28:[1,void 0,70]},43:{8:[1,void 0,14],23:[1,void 0,
15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},44:{9:[1,void 0,72]},45:{7:[2,40],8:[2,40],9:[2,40],10:[2,40],11:[2,40],12:[2,40],13:[2,40],14:[2,40],15:[2,40],16:[2,40],17:[2,40],18:[2,40],19:[2,40],20:[2,40],21:[2,40],22:[2,40],23:[2,40],24:[2,40],25:[2,40],26:[2,40],28:[2,40],31:[2,40]},46:{1:[2,12],2:[2,12],3:[2,12],4:[2,12],5:[2,12],6:[2,12]},47:{1:[2,13],2:[2,13],3:[2,13],4:[2,13],5:[2,13],6:[2,13]},48:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],
26:[1,void 0,18],28:[1,void 0,9]},49:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},50:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},51:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},52:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},53:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,
16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},54:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},55:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},56:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},57:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},58:{8:[1,void 0,14],23:[1,
void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},59:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},60:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,void 0,18],28:[1,void 0,9]},61:{1:[2,1],2:[1,void 0,1],3:[1,void 0,2],4:[2,1],6:[1,void 0,3]},62:{28:[1,void 0,9]},63:{1:[2,5],2:[2,5],3:[2,5],4:[2,5],5:[2,5],6:[2,5]},64:{8:[1,void 0,14],23:[1,void 0,15],24:[1,void 0,16],25:[1,void 0,17],26:[1,
void 0,18],28:[1,void 0,9]},65:{7:[2,14]},66:{7:[2,17],8:[2,17],23:[2,17],24:[2,17],25:[2,17],26:[2,17],28:[2,17]},67:{27:[1,void 0,64]},68:{7:[2,48],28:[2,48]},69:{7:[2,54],8:[2,54],9:[2,54],10:[2,54],11:[2,54],12:[2,54],13:[2,54],14:[2,54],15:[2,54],16:[2,54],17:[2,54],18:[2,54],19:[2,54],20:[2,54],21:[2,54],22:[2,54],23:[2,54],24:[2,54],25:[2,54],26:[2,54],28:[2,54],29:[2,54],30:[2,54],31:[2,54]},70:{7:[2,52],8:[2,52],9:[2,52],10:[2,52],11:[2,52],12:[2,52],13:[2,52],14:[2,52],15:[2,52],16:[2,52],
17:[2,52],18:[2,52],19:[2,52],20:[2,52],21:[2,52],22:[2,52],23:[2,52],24:[2,52],25:[2,52],26:[2,52],28:[2,52],29:[2,52],30:[2,52],31:[2,52]},71:{31:[1,void 0,88]},72:{7:[2,46],8:[2,46],9:[2,46],10:[2,46],11:[2,46],12:[2,46],13:[2,46],14:[2,46],15:[2,46],16:[2,46],17:[2,46],18:[2,46],19:[2,46],20:[2,46],21:[2,46],22:[2,46],23:[2,46],24:[2,46],25:[2,46],26:[2,46],28:[2,46],31:[2,46]},73:{7:[2,22],8:[2,22],9:[2,22],10:[2,22],11:[1,void 0,49],23:[2,22],24:[2,22],25:[2,22],26:[2,22],28:[2,22],31:[2,22]},
74:{7:[2,24],8:[2,24],9:[2,24],10:[2,24],11:[2,24],12:[1,void 0,50],13:[1,void 0,51],23:[2,24],24:[2,24],25:[2,24],26:[2,24],28:[2,24],31:[2,24]},75:{7:[2,26],8:[2,26],9:[2,26],10:[2,26],11:[2,26],12:[2,26],13:[2,26],14:[1,void 0,52],15:[1,void 0,53],16:[1,void 0,54],17:[1,void 0,55],23:[2,26],24:[2,26],25:[2,26],26:[2,26],28:[2,26],31:[2,26]},76:{7:[2,27],8:[2,27],9:[2,27],10:[2,27],11:[2,27],12:[2,27],13:[2,27],14:[1,void 0,52],15:[1,void 0,53],16:[1,void 0,54],17:[1,void 0,55],23:[2,27],24:[2,
27],25:[2,27],26:[2,27],28:[2,27],31:[2,27]},77:{7:[2,30],8:[2,30],9:[2,30],10:[2,30],11:[2,30],12:[2,30],13:[2,30],14:[2,30],15:[2,30],16:[2,30],17:[2,30],18:[1,void 0,56],19:[1,void 0,57],23:[2,30],24:[2,30],25:[2,30],26:[2,30],28:[2,30],31:[2,30]},78:{7:[2,32],8:[2,32],9:[2,32],10:[2,32],11:[2,32],12:[2,32],13:[2,32],14:[2,32],15:[2,32],16:[2,32],17:[2,32],18:[1,void 0,56],19:[1,void 0,57],23:[2,32],24:[2,32],25:[2,32],26:[2,32],28:[2,32],31:[2,32]},79:{7:[2,29],8:[2,29],9:[2,29],10:[2,29],11:[2,
29],12:[2,29],13:[2,29],14:[2,29],15:[2,29],16:[2,29],17:[2,29],18:[1,void 0,56],19:[1,void 0,57],23:[2,29],24:[2,29],25:[2,29],26:[2,29],28:[2,29],31:[2,29]},80:{7:[2,31],8:[2,31],9:[2,31],10:[2,31],11:[2,31],12:[2,31],13:[2,31],14:[2,31],15:[2,31],16:[2,31],17:[2,31],18:[1,void 0,56],19:[1,void 0,57],23:[2,31],24:[2,31],25:[2,31],26:[2,31],28:[2,31],31:[2,31]},81:{7:[2,34],8:[2,34],9:[2,34],10:[2,34],11:[2,34],12:[2,34],13:[2,34],14:[2,34],15:[2,34],16:[2,34],17:[2,34],18:[2,34],19:[2,34],20:[1,
void 0,58],21:[1,void 0,59],22:[1,void 0,60],23:[2,34],24:[2,34],25:[2,34],26:[2,34],28:[2,34],31:[2,34]},82:{7:[2,35],8:[2,35],9:[2,35],10:[2,35],11:[2,35],12:[2,35],13:[2,35],14:[2,35],15:[2,35],16:[2,35],17:[2,35],18:[2,35],19:[2,35],20:[1,void 0,58],21:[1,void 0,59],22:[1,void 0,60],23:[2,35],24:[2,35],25:[2,35],26:[2,35],28:[2,35],31:[2,35]},83:{7:[2,37],8:[2,37],9:[2,37],10:[2,37],11:[2,37],12:[2,37],13:[2,37],14:[2,37],15:[2,37],16:[2,37],17:[2,37],18:[2,37],19:[2,37],20:[2,37],21:[2,37],22:[2,
37],23:[2,37],24:[2,37],25:[2,37],26:[2,37],28:[2,37],31:[2,37]},84:{7:[2,38],8:[2,38],9:[2,38],10:[2,38],11:[2,38],12:[2,38],13:[2,38],14:[2,38],15:[2,38],16:[2,38],17:[2,38],18:[2,38],19:[2,38],20:[2,38],21:[2,38],22:[2,38],23:[2,38],24:[2,38],25:[2,38],26:[2,38],28:[2,38],31:[2,38]},85:{7:[2,39],8:[2,39],9:[2,39],10:[2,39],11:[2,39],12:[2,39],13:[2,39],14:[2,39],15:[2,39],16:[2,39],17:[2,39],18:[2,39],19:[2,39],20:[2,39],21:[2,39],22:[2,39],23:[2,39],24:[2,39],25:[2,39],26:[2,39],28:[2,39],31:[2,
39]},86:{7:[1,void 0,89]},87:{7:[2,50],28:[2,50]},88:{7:[2,53],8:[2,53],9:[2,53],10:[2,53],11:[2,53],12:[2,53],13:[2,53],14:[2,53],15:[2,53],16:[2,53],17:[2,53],18:[2,53],19:[2,53],20:[2,53],21:[2,53],22:[2,53],23:[2,53],24:[2,53],25:[2,53],26:[2,53],28:[2,53],29:[2,53],30:[2,53],31:[2,53]},89:{1:[2,11],2:[2,11],3:[2,11],4:[2,11],5:[2,11],6:[2,11]}}};h.parse=function(b){var d=this,f=d.lexer,e,i,h=d.table,u=h.gotos,h=h.action,r=d.productions,j=[null],k=[0];for(f.resetInput(b);;){b=k[k.length-1];e||
(e=f.lex());if(!e)return!1;i=h[b]&&h[b][e];if(!i){var s=[];h[b]&&a.each(h[b],function(c,g){s.push(d.lexer.mapReverseSymbol(g))});f.showDebugInfo();s.join(", ");return!1}switch(i[0]){case 1:k.push(e);j.push(f.text);k.push(i[2]);e=null;break;case 2:var m=r[i[1]],b=m.symbol||m[0];i=m.action||m[2];var g=(m.rhs||m[1]).length,t=0,c=void 0,m=j[j.length-g];for(d.$$=m;t<g;t++)d["$"+(g-t)]=j[j.length-1-t];i&&(c=i.call(d));m=void 0!==c?c:d.$$;g&&(k=k.slice(0,-2*g),j=j.slice(0,-1*g));k.push(b);j.push(m);k.push(u[k[k.length-
2]][k[k.length-1]]);break;case 0:return m}}};return h});
KISSY.add("xtemplate/compiler/ast",function(h){var a={ProgramNode:function(a,e,b){this.lineNumber=a;this.statements=e;this.inverse=b}};a.ProgramNode.prototype.type="program";a.BlockNode=function(a,e,b,d){h.equals(e.path.parts,d.parts);this.lineNumber=a;this.tpl=e;this.program=b};a.BlockNode.prototype.type="block";a.TplNode=function(a,e,b,d){this.lineNumber=a;this.path=e;this.params=b;this.hash=d;this.escaped=!0;this.isInverted=!1};a.TplNode.prototype.type="tpl";a.TplExpressionNode=function(a,e){this.lineNumber=
a;this.expression=e;this.escaped=!0};a.TplExpressionNode.prototype.type="tplExpression";a.ContentNode=function(a,e){this.lineNumber=a;this.value=e};a.ContentNode.prototype.type="content";a.UnaryExpression=function(a){this.value=a};a.UnaryExpression.prototype.type="unaryExpression";a.MultiplicativeExpression=function(a,e,b){this.op1=a;this.opType=e;this.op2=b};a.MultiplicativeExpression.prototype.type="multiplicativeExpression";a.AdditiveExpression=function(a,e,b){this.op1=a;this.opType=e;this.op2=
b};a.AdditiveExpression.prototype.type="additiveExpression";a.RelationalExpression=function(a,e,b){this.op1=a;this.opType=e;this.op2=b};a.RelationalExpression.prototype.type="relationalExpression";a.EqualityExpression=function(a,e,b){this.op1=a;this.opType=e;this.op2=b};a.EqualityExpression.prototype.type="equalityExpression";a.ConditionalAndExpression=function(a,e){this.op1=a;this.op2=e};a.ConditionalAndExpression.prototype.type="conditionalAndExpression";a.ConditionalOrExpression=function(a,e){this.op1=
a;this.op2=e};a.ConditionalOrExpression.prototype.type="conditionalOrExpression";a.StringNode=function(a,e){this.lineNumber=a;this.value=e};a.StringNode.prototype.type="string";a.NumberNode=function(a,e){this.lineNumber=a;this.value=e};a.NumberNode.prototype.type="number";a.BooleanNode=function(a,e){this.lineNumber=a;this.value=e};a.BooleanNode.prototype.type="boolean";a.HashNode=function(a,e){var b={};this.lineNumber=a;h.each(e,function(a){b[a[0]]=a[1]});this.value=b};a.HashNode.prototype.type="hash";
a.IdNode=function(a,e){var b=[],d=0;this.lineNumber=a;h.each(e,function(a){".."==a?d++:b.push(a)});this.parts=b;this.string=b.join(".");this.depth=d};a.IdNode.prototype.type="id";return a});
KISSY.add("xtemplate/compiler",function(h,a,i,e){function b(g,a){return d(g.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t"),a)}function d(g,a){return g.replace(a?v:u,function(c){c.length%2&&(c="\\"+c);return c})}function f(g,a){r.apply(g,a)}function o(g){return g[g.length-1]}function q(g,a,c){var b="tmp"+j++;c.push("var "+b+" = "+g+";");c.push(b+" = ("+b+' === undefined ? "" : '+b+') + "";');c.push("buffer += "+(a?"escapeHtml ? escapeHtml("+b+") : "+b:b)+";")}a.yy=i;var v=/\\*"/g,u=
/\\*'/g,r=[].push,j=0,k=0,s={genFunction:function(g,a){var c=[];a||c.push("function(scopes) {");c.push('var buffer = ""'+(a?",":";"));if(a){c.push("S = KISSY,config=this.config,escapeHtml = config.escapeHtml && S.escapeHtml,isArray = S.isArray,isObject = S.isObject,log = S.log,engine = this, commands = config.commands,utils = config.utils,error = S.error;");var b="",d,l=e.utils,n=e.commands;for(d in n)b+=d+'Command = commands["'+d+'"],';for(d in l)b+=d+'Util = utils["'+d+'"],';b&&c.push("var "+b.slice(0,
b.length-1))}if(g){b=0;for(d=g.length;b<d;b++)f(c,this[g[b].type](g[b]))}c.push("return buffer;");return!a?(c.push("}"),c):{params:["scopes","undefined"],source:c}},genId:function(g,a){var c=[],b=g.depth,d=g.string,l=g.parts,n="id"+j++,p=0,h;h=e.commands;c.push("var "+n+";");if(a&&0==b){var p=this.genConfig(a),i=p[0];f(c,p[1]);(p=h[d])?h=d+"Command":(h="command"+j++,c.push("var "+h+";"),c.push(h+' = commands["'+d+'"];'),c.push("if( "+h+" ){"));c.push("try{");c.push(n+" = "+h+".call(engine, scopes, "+
(i||"{}")+");");c.push("}catch(e){");c.push("error(e.message+\": '"+d+"' at line "+g.lineNumber+'");');c.push("}");!p&&!i&&(c.push("}"),c.push("else {"));!p&&i&&(c.push("}"),c.push("else {"),c.push("error(\"can not find command: '"+d+"' at line "+g.lineNumber+'", "warn");'),c.push("}"))}!p&&!i&&(i="tmp"+j++,d=this.getIdStringFromIdParts(c,l),c.push("var "+i+' = getPropertyUtil("'+d+'",scopes,'+b+");"),c.push("if("+i+"===false){"),c.push('S[config.silent?"log":"error"]("can not find property: \''+
d+"' at line "+g.lineNumber+'", "warn");'),c.push("} else {"),c.push(n+" = "+i+"[0];"),c.push("}"),a&&0==b&&c.push("}"));return[n,c]},genOpExpression:function(g,a){var c=[],b,d,e=this[g.op1.type](g.op1),h=this[g.op2.type](g.op2);b=e[0];d=h[0];if(b&&d)return f(c,e[1]),f(c,h[1]),c.push(b+a+d),["",c];if(!b&&!d)return f(c,e[1].slice(0,-1)),f(c,h[1].slice(0,-1)),c.push("("+o(e[1])+")"+a+"("+o(h[1])+")"),["",c];if(b&&!d)return f(c,e[1]),f(c,h[1].slice(0,-1)),c.push(b+a+"("+o(h[1])+")"),["",c];if(!b&&d)return f(c,
e[1].slice(0,-1)),f(c,h[1]),c.push("("+o(e[1])+")"+a+d),["",c]},genConfig:function(g){var a=[],c,b,d=this;if(g){b=g.params;g=g.hash;if(b||g)c="config"+j++,a.push("var "+c+" = {};");if(b){var e="params"+j++;a.push("var "+e+" = [];");h.each(b,function(c){c=d[c.type](c);c[0]?(f(a,c[1]),a.push(e+".push("+c[0]+");")):(f(a,c[1].slice(0,-1)),a.push(e+".push("+o(c[1])+");"))});a.push(c+".params="+e+";")}if(g){var i="hash"+j++;a.push("var "+i+" = {};");h.each(g.value,function(c,g){var b=d[c.type](c);b[0]?
(f(a,b[1]),a.push(i+'["'+g+'"] = '+b[0]+";")):(f(a,b[1].slice(0,-1)),a.push(i+'["'+g+'"] = '+o(b[1])+";"))});a.push(c+".hash="+i+";")}}return[c,a]},conditionalOrExpression:function(a){return this.genOpExpression(a,"||")},conditionalAndExpression:function(a){return this.genOpExpression(a,"&&")},relationalExpression:function(a){return this.genOpExpression(a,a.opType)},equalityExpression:function(a){return this.genOpExpression(a,a.opType)},additiveExpression:function(a){return this.genOpExpression(a,
a.opType)},multiplicativeExpression:function(a){return this.genOpExpression(a,a.opType)},unaryExpression:function(a){var b=[],c,a=this[a.value.type](a.value);r.apply(b,a[1]);(c=a[0])?b.push(c+"=!"+c+";"):b[b.length-1]="!"+o(b);return[c,b]},string:function(a){return["",["'"+b(a.value)+"'"]]},number:function(a){return["",[a.value]]},"boolean":function(a){return["",[a.value]]},id:function(a){return this.genId(a)},block:function(a){var b=a.program,c=[],d,a=a.tpl,i=this.genConfig(a),l=i[0];d=e.commands;
var n=a.path.string;f(c,i[1]);l||(l=h.guid("config"),c.push("var "+l+" = {};"));c.push(l+".fn="+this.genFunction(b.statements).join("\n")+";");b.inverse&&(b=this.genFunction(b.inverse).join("\n"),c.push(l+".inverse="+b+";"));a.isInverted&&(b="inverse"+j++,c.push("var "+b+"="+l+".fn;"),c.push(l+".fn = "+l+".inverse;"),c.push(l+".inverse = "+b+";"));if(b=d[n])d=n+"Command";else{d="command"+j++;c.push("var "+d+' = commands["'+n+'"];');if(!a.hash&&!a.params){c.push("if(!"+d+"){");var n=this.getIdStringFromIdParts(c,
a.path.parts),k="propertyValueHolder"+j++;c.push("var "+k+' = getPropertyUtil("'+n+'",scopes);');i="variableName"+j++;c.push("var "+i+"="+k+"&&"+k+"[0];");c.push(l+".params=["+i+"];");c.push("if(isArray("+i+")){");c.push(d+'=commands["each"];');c.push("}");c.push("else if(isObject("+i+")){");c.push(d+'=commands["with"];');c.push("}");c.push("else {");c.push(d+'=commands["if"];');c.push("}");c.push("}")}c.push("if( "+d+" ){")}c.push("try{");c.push("buffer += "+d+".call(engine, scopes, "+l+");");c.push("}catch(e){");
c.push("error(e.message+\": '"+n+"' at line "+a.path.lineNumber+'");');c.push("}");b||(c.push("}"),c.push("if("+k+"===false) {"),c.push('S[config.silent?"log":"error"]("can not find command: \''+n+"' at line "+a.path.lineNumber+'","warn");'),c.push("}"));return c},content:function(a){return["buffer += '"+b(a.value)+"';"]},tpl:function(a){var b=[],c=a.escaped,a=this.genId(a.path,a);f(b,a[1]);q(a[0],c,b);return b},tplExpression:function(a){var b=[],c=a.escaped,a=this[a.expression.type](a.expression);
a[0]?(f(b,a[1]),a=a[0]):(f(b,a[1].slice(0,-1)),a=o(a[1]));q(a,c,b);return b},getIdStringFromIdParts:function(a,b){var c="",d,e,h,i=!0;for(d=0;d<b.length;d++)e=b[d],h=e.type,i||(c+="."),h?(e=this[h](e),e[0]&&(f(a,e[1]),c+='"+'+e[0]+'+"',i=!0)):(c+=e,i=!1);return c}},m;return m={parse:function(b){return a.parse(b)},compileToStr:function(a){a=this.compile(a);return"function("+a.params.join(",")+"){\n"+a.source.join("\n")+"}"},compile:function(a){a=this.parse(a);j=0;return s.genFunction(a.statements,
!0)},compileToFn:function(a,b){var c=m.compile(a),b=b||{},d="sourceURL="+(b.name?b.name:"xtemplate"+k++)+".js";return Function.apply(null,[].concat(c.params).concat(c.source.join("\n")+"\n//@ "+d+"\n//# "+d))}}},{requires:["./compiler/parser","./compiler/ast","xtemplate/runtime"]});
