/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: May 30 01:44
*/
KISSY.add("xtemplate/runtime/base",function(e){function c(b,a){this.tpl=b;a=e.merge(g,a);a.subTpls=e.merge(a.subTpls,c.subTpls);a.commands=e.merge(a.commands,c.commands);this.option=a}var g={silent:!0,name:"",utils:{getProperty:function(b,a,d){if("this"==b||"."==b)return a.length?[a[0]]:!1;for(var b=b.split("."),g=b.length,c=d||0,f,e,j,k=a.length;c<k;c++){f=a[c];j=1;for(d=0;d<g;d++){e=b[d];if("object"!=typeof f||!(e in f)){j=0;break}f=f[e]}if(j)return"function"==typeof f&&(f=f.call(a[k-1])),[f]}return!1}}};
c.prototype={constructor:c,removeSubTpl:function(b){delete this.option.subTpls[b]},removeCommand:function(b){delete this.option.commands[b]},addSubTpl:function(b,a){this.option.subTpls[b]=a},addCommand:function(b,a){this.option.commands[b]=a},render:function(b,a){a||(b=[b]);return this.tpl(b,this.option)}};return c});
KISSY.add("xtemplate/runtime/include-command",function(e,c){var g={invokeEngine:function(b,a,d){return(new c(b,e.merge(d))).render(a,!0)},include:function(b,a){var d=a.params;if(!d||1!=d.length)return e[a.silent?"log":"error"]("include must has one param"),"";var d=d[0],c;if(!(c=a.subTpls[d]))return e[a.silent?"log":"error"]('does not include sub template "'+d+'"'),"";a.name=d;return g.invokeEngine(c,b,a)}};return g},{requires:["./base"]});
KISSY.add("xtemplate/runtime/commands",function(e,c){return{each:function(c,b){var a=b.params[0],d="",h;if(a){var i=[0,0].concat(c);if(e.isArray(a)){h=a.length;for(var f=0;f<h;f++)i[0]=a[f],i[1]={xcount:h,xindex:f},d+=b.fn(i)}else for(h in a)i[0]=a[h],i[1]={xkey:h},d+=b.fn(i)}else b.inverse&&(d=b.inverse(c));return d},"with":function(c,b){var a=b.params[0],d=[0].concat(c),e="";a?(d[0]=a,e=b.fn(d)):b.inverse&&(e=b.inverse(c));return e},"if":function(c,b){var a="";b.params[0]?b.fn&&(a=b.fn(c)):b.inverse&&
(a=b.inverse(c));return a},set:function(c,b){for(var a=c.length-1;0<=a;a--)if("object"==typeof c[a]){e.mix(c[a],b.hash);break}return""},include:c.include}},{requires:["./include-command"]});
KISSY.add("xtemplate/runtime",function(e,c,g,b){c.addCommand=function(a,b){g[a]=b};c.removeCommand=function(a){delete g[a]};c.commands=g;c.includeCommand=b;var a={};c.subTpls=a;c.addSubTpl=function(b,c){a[b]=c};c.removeSubTpl=function(b){delete a[b]};return c.IncludeEngine=c},{requires:["./runtime/base","./runtime/commands","./runtime/include-command"]});
