/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Aug 6 21:57
*/
KISSY.add("xtemplate/runtime/commands",function(f){var g;return g={each:function(d,a){var c=a.params[0],b="",e;if(c){var h=[0,0].concat(d);if(f.isArray(c)){e=c.length;for(var k=0;k<e;k++)h[0]=c[k],h[1]={xcount:e,xindex:k},b+=a.fn(h)}else for(e in c)h[0]=c[e],h[1]={xkey:e},b+=a.fn(h)}else a.inverse&&(b=a.inverse(d));return b},"with":function(d,a){var c=a.params[0],b=[0].concat(d),e="";c?(b[0]=c,e=a.fn(b)):a.inverse&&(e=a.inverse(d));return e},"if":function(d,a){var c="";a.params[0]?a.fn&&(c=a.fn(d)):
a.inverse&&(c=a.inverse(d));return c},set:function(d,a){for(var c=d.length-1;0<=c;c--)if("object"==typeof d[c]){f.mix(d[c],a.hash);break}return""},include:function(d,a){var c=a.params,d=(a.hash?[a.hash]:[]).concat(d);if(!c||1!=c.length)return f[a.silent?"log":"error"]("include must has one param"),"";var b=this.config.name,c=c[0];if("."==c.charAt(0)){if("unspecified"==b)return"";c=f.Path.resolve(b,"../",c)}b=this.config.loader.call(this,c);a=f.merge(this.config);a.name=c;return this.invokeEngine(b,
d,a)},parse:function(d,a){return g.include.call(this,[],a)}}});
KISSY.add("xtemplate/runtime",function(f,g){function d(b,e){this.tpl=b;e=f.merge(c,e);e.commands=f.merge(e.commands,d.commands);e.utils=a;this.config=e}var a={getPropertyOrCommand:function(b,e,c,d,g,m){var l,i=b.config,j=i.commands[d];if(j)try{l=j.call(b,e,c)}catch(n){f.error(n.message+": '"+d+"' at line "+m)}else if(b=a.getProperty(d,e,g),!1===b)f[i.silent?"log":"error"]("can not find property: '"+d+"' at line "+m,"warn");else l=b[0];return l},getProperty:function(b,e,a){"."===b&&(b="this");var b=
b.split("."),c=b.length,d=a||0,f,g,i,j=e.length;"root"==b[0]&&(d=j-1,b.shift(),c--);for(;d<j;d++){f=e[d];i=1;for(a=0;a<c;a++)if(g=b[a],"this"!==g){if("object"!=typeof f||!(g in f)){i=0;break}f=f[g]}if(i)return"function"==typeof f&&(f=f.call(e[0])),[f]}return!1}},c={silent:!0,name:"unspecified",escapeHtml:!0,loader:function(b){var a="";f.use(b,{success:function(b,c){a=c},sync:1});if(!a)f[this.config.silent?"log":"error"]('template "'+b+'" does not exist, need to be required or used first!');return a}};
d.prototype={constructor:d,invokeEngine:function(b,a,c){return(new this.constructor(b,c)).render(a,!0)},removeCommand:function(b){delete this.config.commands[b]},addCommand:function(b,a){this.config.commands[b]=a},render:function(b,a){a||(b=[b]);return this.tpl(b)}};f.mix(d,{commands:g,utils:a,addCommand:function(b,a){g[b]=a},removeCommand:function(a){delete g[a]}});return d},{requires:["./runtime/commands"]});
