modulex.add("event-custom",["modulex-event-base","modulex-util"],function(t,e,r){var n,s,i,a,u,o=t("modulex-event-base"),c=t("modulex-util");n=function(t){function e(){e.superclass.constructor.apply(this,arguments)}t={};var r=o,n=c;return n.extend(e,r.Observer,{keys:["fn","context","groups"]}),t=e}(),s=function(t){function e(t){e.superclass.constructor.call(this),n.mix(this,t)}t={};var r=o,n=c;return n.extend(e,r.Object),t=e}(),i=function(t){function e(){var t=this;e.superclass.constructor.apply(t,arguments),t.defaultFn=null,t.defaultTargetOnly=!1,t.bubbles=!0}t={};var r=o,i=n,a=s,u=r.Utils,f=c;return f.extend(e,r.Observable,{on:function(t){var e=new i(t);-1===this.findObserver(e)&&this.observers.push(e)},fire:function(t){t=t||{};var e,r,n,s,i,u=this,o=u.bubbles,c=u.currentTarget,f=u.type,v=u.defaultFn,l=t;if(t.type=f,l.isEventObject||(l=new a(l)),l.target=l.target||c,l.currentTarget=c,i=u.notify(l),s!==!1&&void 0!==i&&(s=i),o&&!l.isPropagationStopped())for(e=c.getTargets(),r=e&&e.length||0,n=0;r>n&&!l.isPropagationStopped();n++)i=e[n].fire(f,l),s!==!1&&void 0!==i&&(s=i);if(v&&!l.isDefaultPrevented()){var g=l.target,p=g.getEventListeners(l.type);(u.defaultTargetOnly||p&&p.defaultTargetOnly)&&c!==g||(s=v.call(c,l))}return s},notify:function(t){var e,r,n,s=[].concat(this.observers),i=s.length;for(n=0;i>n&&!t.isImmediatePropagationStopped();n++)e=s[n].notify(t,this),r!==!1&&void 0!==e&&(r=e);return r},detach:function(t){var e,r=this,n=t.fn,s=t.context,i=r.currentTarget,a=r.observers,o=t.groups;if(a.length){o&&(e=u.getGroupsRe(o));var c,f,v,l,g,p=a.length;if(n||e){for(s=s||i,c=0,f=0,v=[];p>c;++c){l=a[c];var h=l.config;g=h.context||i,(s!==g||n&&n!==h.fn||e&&!h.groups.match(e))&&(v[f++]=l)}r.observers=v}else r.reset()}}}),t=e}(),a=function(t){function e(t,e){var r=t.getEventListeners(e);return r||(r=t.getEventListeners()[e]=new n({currentTarget:t,type:e})),r}t={};var r=o,n=i,s=c,a=r.Utils,u=a.splitAndRun,f="__~ks_bubble_targets",v="__~ks_custom_events";return t={isTarget:1,fire:function(t,e){var r,s=this,i=s.getTargets(),o=i&&i.length;return t.isEventObject&&(e=t,t=t.type),e=e||{},u(t,function(t){var i,u;if(a.fillGroupsForEvent(t,e),t=e.type,u=s.getEventListeners(t),u||o){if(u){if(!u.hasObserver()&&!u.defaultFn&&(u.bubbles&&!o||!u.bubbles))return}else u=new n({currentTarget:s,type:t});i=u.fire(e),r!==!1&&void 0!==i&&(r=i)}}),r},publish:function(t,r){var n,i=this;return u(t,function(t){n=e(i,t),s.mix(n,r)}),i},addTarget:function(t){var e=this,r=e.getTargets();return s.inArray(t,r)||r.push(t),e},removeTarget:function(t){var e=this,r=e.getTargets(),n=s.indexOf(t,r);return-1!==n&&r.splice(n,1),e},getTargets:function(){return this[f]||(this[f]=[])},getEventListeners:function(t){var e=this[v]||(this[v]={});return t?e[t]:e},on:function(t,r,n){var s=this;return a.batchForType(function(t,r,n){var i=a.normalizeParam(t,r,n);t=i.type;var u=e(s,t);u.on(i)},0,t,r,n),s},detach:function(t,e,r){var n=this;return a.batchForType(function(t,e,r){var i=a.normalizeParam(t,e,r);if(t=i.type){var u=n.getEventListeners(t);u&&u.detach(i)}else s.each(n.getEventListeners(),function(t){t.detach(i)})},0,t,e,r),n}}}(),u=function(t){t={};var e=a,r=c;return t={version:"1.0.0",Target:e,Object:s,global:r.mix({},e)}}(),r.exports=u});