/*
Copyright 2013, KISSY v1.40dev
MIT Licensed
build time: Aug 27 21:51
*/
KISSY.add("date/gregorian/const",function(){return{SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,JANUARY:0,FEBRUARY:1,MARCH:2,APRIL:3,MAY:4,JUNE:5,JULY:6,AUGUST:7,SEPTEMBER:8,OCTOBER:9,NOVEMBER:10,DECEMBER:11}});
KISSY.add("date/gregorian/utils",function(p,D){var q=[0,31,59,90,120,151,181,212,243,273,304,334],C=[0,31,60,91,121,152,182,213,244,274,305,335],d={};p.mix(d,{isLeapYear:function(e){return 0!=(e&3)?!1:0!=e%100||0==e%400},mod:function(d,i){return d-i*e(d/i)},getFixedDate:function(d,i,g){var h=d-1;return 365*h+e(h/4)-e(h/100)+e(h/400)+(g+(w(d)?C[i]:q[i]))},getGregorianDateFromFixedDate:function(k){var i,g,h,j;g=k-1;i=e(g/146097);h=l(g,146097);g=e(h/36524);j=l(h,36524);h=e(j/1461);j=l(j,1461);j=e(j/
365);i=400*i+100*g+4*h+j;4==g||4==j||++i;h=d.getFixedDate(i,D.JANUARY,1);j=(g=w(i))?C:q;var p=k-h,t,m;for(m=0;m<j.length;m++)if(j[m]<=p)t=m;else break;h=k-h-j[t]+1;k=0<=k?k%7:l(k,7);return{year:i,month:t,dayOfMonth:h,dayOfWeek:k,isLeap:g}}});var e=Math.floor,w=d.isLeapYear,l=d.mod;return d},{requires:["./const"]});
KISSY.add("date/gregorian",function(p,D,q,C,d){function e(a,b){var c=p.makeArray(arguments);p.isObject(a)?(b=a,a=b.timezoneOffset):3<=c.length&&(a=b=null);this.locale=b=b||D;this.fields=[];this.time=d;this.timezoneOffset=a||b.timezoneOffset;this.firstDayOfWeek=b.firstDayOfWeek;this.minimalDaysInFirstWeek=b.minimalDaysInFirstWeek;this.fieldsComputed=!1;3<=arguments.length&&this.set.apply(this,c)}function w(a){var b=a.fields,c=l(b[g],b[h]);b[j]>c&&a.set(j,c)}function l(a,b){return y(a)?H[b]:I[b]}function k(a,
b,c){var f=b+6-r(b+6-a.firstDayOfWeek,7);f-b>=a.minimalDaysInFirstWeek&&(f-=7);return E((c-f)/7)+1}var i=parseInt;p.mix(e,C);p.mix(e,{isLeapYear:q.isLeapYear,YEAR:1,MONTH:2,DAY_OF_MONTH:3,HOUR_OF_DAY:4,MINUTES:5,SECONDS:6,MILLISECONDS:7,WEEK_OF_YEAR:8,WEEK_OF_MONTH:9,DAY_OF_YEAR:10,DAY_OF_WEEK:11,DAY_OF_WEEK_IN_MONTH:12,AM:0,PM:1});var g=e.YEAR,h=e.MONTH,j=e.DAY_OF_MONTH,x=e.HOUR_OF_DAY,t=e.MINUTES,m=e.SECONDS,z=e.MILLISECONDS,A=e.DAY_OF_WEEK_IN_MONTH,u=e.DAY_OF_YEAR,v=e.DAY_OF_WEEK,s=e.WEEK_OF_MONTH,
n=e.WEEK_OF_YEAR,I=[31,28,31,30,31,30,31,31,30,31,30,31],H=[31,29,31,30,31,30,31,31,30,31,30,31],r=q.mod,y=q.isLeapYear,E=Math.floor,F=[d,1,e.JANUARY,1,0,0,0,0,1,d,1,e.SUNDAY,1],G=[d,292278994,e.DECEMBER,d,23,59,59,999,d,d,d,e.SATURDAY,d];e.prototype={constructor:e,isLeapYear:function(){return y(this.getYear())},getLocale:function(){return this.locale},getActualMinimum:function(a){if(F[a]!==d)return F[a];var b=this.fields;if(a===s)return(new e(b[g],b[h],1)).get(s);throw Error("minimum value not defined!");
},getActualMaximum:function(a){if(G[a]!==d)return G[a];var b,c=this.fields;switch(a){case j:b=l(c[g],c[h]);break;case n:b=(new e(c[g],e.DECEMBER,31)).get(n);1==b&&(b=52);break;case s:b=(new e(c[g],c[h],l(c[g],c[h]))).get(s);break;case u:b=y(c[g])?366:365;break;case A:b=i((l(c[g],c[h])-1)/7)+1}if(b===d)throw Error("maximum value not defined!");return b},isSet:function(a){return this.fields[a]!==d},computeFields:function(){var a=this.time,b=6E4*this.timezoneOffset,c=i(b/864E5),b=b%864E5,c=c+i(a/864E5),
b=b+a%864E5;if(864E5<=b)b-=864E5,c++;else for(;0>b;)b+=864E5,c--;var c=c+719163,f=q.getGregorianDateFromFixedDate(c),o=f.year,a=this.fields;a[g]=o;a[h]=f.month;a[j]=f.dayOfMonth;a[v]=f.dayOfWeek;0!=b?(a[x]=i(b/36E5),b%=36E5,a[t]=i(b/6E4),b%=6E4,a[m]=i(b/1E3),a[z]=b%1E3):a[x]=a[t]=a[m]=a[z]=0;var d=q.getFixedDate(o,e.JANUARY,1),b=c-f.dayOfMonth+1;a[u]=c-d+1;a[A]=i((f.dayOfMonth-1)/7)+1;f=k(this,d,c);0==f?(f=d-1,o=d-(y(o-1)?366:365),f=k(this,o,f)):52<=f&&(o=d+(y(o)?366:365),d=o+6-r(o+6-this.firstDayOfWeek,
7),d-o>=this.minimalDaysInFirstWeek&&c>=d-7&&(f=1));a[n]=f;a[s]=k(this,b,c);this.fieldsComputed=!0},computeTime:function(){if(!this.isSet(g))throw Error("year must be set for KISSY GregorianCalendar");var a=this.fields,b=a[g],c=0;this.isSet(x)&&(c+=a[x]);c=60*c+(a[t]||0);c=60*c+(a[m]||0);c=1E3*c+(a[z]||0);a[g]=b;a=0+this.getFixedDate();this.time=c=864E5*(a-719163)+c-6E4*this.timezoneOffset;this.computeFields()},complete:function(){this.time===d&&this.computeTime();this.fieldsComputed||this.computeFields()},
getFixedDate:function(){var a=this.fields,b=this.firstDayOfWeek,c=a[g],f=e.JANUARY;this.isSet(h)&&(f=a[h],f>e.DECEMBER?(c+=i(f/12),f%=12):f<e.JANUARY&&(c+=E(f/12),f=r(f,12)));var d=q.getFixedDate(c,f,1),k=this.firstDayOfWeek;this.isSet(v)&&(k=a[v]);this.isSet(h)?this.isSet(j)?d+=a[j]-1:this.isSet(s)?(c=d+6-r(d+6-b,7),c-d>=this.minimalDaysInFirstWeek&&(c-=7),k!=b&&(c=c+6-r(c+6-k,7)),d=c+7*(a[s]-1)):(a=this.isSet(A)?a[A]:1,b=7*a,0>a&&(b=l(c,f)+7*(a+1)),d=d+b-1-r(d+b-1-k,7)):this.isSet(u)?d+=a[u]-1:
(c=d+6-r(d+6-b,7),c-d>=this.minimalDaysInFirstWeek&&(c-=7),k!=b&&(c=c+6-r(c+6-k,7)),d=c+7*(a[n]-1));return d},getTime:function(){this.time===d&&this.computeTime();return this.time},setTime:function(a){this.time=a;this.fieldsComputed=!1;this.complete()},get:function(a){this.complete();return this.fields[a]},set:function(a,b){var c=arguments.length;if(2==c)this.fields[a]=b;else if(c<z+1)for(var f=0;f<c;f++)this.fields[g+f]=arguments[f];else throw Error("illegal arguments for KISSY GregorianCalendar set");
this.time=d},add:function(a,b){if(b){var c=this.fields,d=this.get(a);if(a===g)this.set(g,d+b),w(this);else if(a===h){var d=d+b,e=E(d/12),d=r(d,12);e&&this.set(g,c[g]+e);this.set(h,d);w(this)}else{switch(a){case x:b*=36E5;break;case t:b*=6E4;break;case m:b*=1E3;break;case z:break;case s:case n:case A:b*=6048E5;break;case v:case u:case j:b*=864E5;break;default:throw Error("illegal field for add");}this.setTime(this.time+b)}}},getRolledValue:function(a,b,c,d){d=d-c+1;return c+(a-c+b%d+d)%d},roll:function(a,
b){if(b){var c=this.get(a),d=this.getActualMinimum(a),e=this.getActualMaximum(a),c=this.getRolledValue(c,b,d,e);this.set(a,c);switch(a){case h:w(this);break;default:this.updateFieldsBySet(a)}}},updateFieldsBySet:function(a){var b=this.fields;switch(a){case s:b[j]=d;break;case u:b[h]=d;break;case v:b[j]=d;break;case n:b[u]=d,b[h]=d}},getTimezoneOffset:function(){return this.timezoneOffset},setTimezoneOffset:function(a){this.timezoneOffset!=a&&(this.fieldsComputed=d,this.timezoneOffset=a)},setFirstDayOfWeek:function(a){this.firstDayOfWeek!=
a&&(this.firstDayOfWeek=a,this.fieldsComputed=!1)},getFirstDayOfWeek:function(){return this.firstDayOfWeek},setMinimalDaysInFirstWeek:function(a){this.minimalDaysInFirstWeek!=a&&(this.minimalDaysInFirstWeek=a,this.fieldsComputed=!1)},getMinimalDaysInFirstWeek:function(){return this.minimalDaysInFirstWeek},getWeeksInWeekYear:function(){var a=this.getWeekYear();if(a==this.get(g))return this.getActualMaximum(n);var b=this.clone();b.setWeekDate(a,2,this.get(v));return b.getActualMaximum(n)},getWeekYear:function(){var a=
this.get(g),b=this.get(n),c=this.get(h);c==e.JANUARY?52<=b&&--a:c==e.DECEMBER&&1==b&&++a;return a},setWeekDate:function(a,b,c){if(c<e.SUNDAY||c>e.SATURDAY)throw Error("invalid dayOfWeek: "+c);var d=this.fields,i=this.clone();i.clear();i.setTimezoneOffset(0);i.set(g,a);i.set(n,1);i.set(v,this.getFirstDayOfWeek());a=c-this.getFirstDayOfWeek();0>a&&(a+=7);a+=7*(b-1);0!=a?i.add(u,a):i.complete();d[g]=i.get(g);d[h]=i.get(h);d[j]=i.get(j);this.complete()},clone:function(){this.time===d&&this.computeTime();
var a=new e(this.timezoneOffset,this.locale);a.setTime(this.time);return a},equals:function(a){return this.getTime()==a.getTime()&&this.firstDayOfWeek==a.firstDayOfWeek&&this.timezoneOffset==a.timezoneOffset&&this.minimalDaysInFirstWeek==a.minimalDaysInFirstWeek},clear:function(a){a===d?this.field=[]:this.fields[a]=d;this.time=d;this.fieldsComputed=!1}};var B=e.prototype;p.each(",Year,Month,DayOfMonth,HourOfDay,Minutes,Seconds,Milliseconds,WeekOfYear,WeekOfMonth,DayOfYear,DayOfWeek,DayOfWeekInMonth".split(","),
function(a,b){if(a){B["get"+a]=function(){return this.get(b)};B["isSet"+a]=function(){return this.isSet(b)};B["set"+a]=function(a){return this.set(b,a)};B["add"+a]=function(a){return this.add(b,a)};B["roll"+a]=function(a){return this.roll(b,a)}}});return e},{requires:["i18n!date","./gregorian/utils","./gregorian/const"]});
